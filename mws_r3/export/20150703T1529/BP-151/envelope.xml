<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<ns1:Envelope xmlns:ns1="http://servicemesh.com/agility/api" xmlns:ns2="http://servicemesh.com/core/messaging" ns1:version="3.0" ns1:productVersion="9.2.4">
    <ns1:pendingAsset xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="ns1:Script">
        <ns1:name>MWS2R3 - AD Global Repository</ns1:name>
        <ns1:id>264</ns1:id>
        <ns1:description></ns1:description>
        <ns1:uuid>6d29211d-bc72-4a86-bf40-6ab05e05073b</ns1:uuid>
        <ns1:assetType>
            <ns1:name>script</ns1:name>
            <ns1:href>assettype/2</ns1:href>
            <ns1:id>2</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.AssetType+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:assetType>
        <ns1:top>false</ns1:top>
        <ns1:assetPath>/Root/MWS2R3_SYD</ns1:assetPath>
        <ns1:detailedAssetPath>/Root:#ID#1:#TYPE#VMContainer/MWS2R3_SYD:#ID#8:#TYPE#VMProject</ns1:detailedAssetPath>
        <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
        <ns1:removable>true</ns1:removable>
        <ns1:domain>
            <ns1:name>domain1</ns1:name>
            <ns1:href>domain/1</ns1:href>
            <ns1:id>1</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Domain+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:domain>
        <ns1:creator>
            <ns1:name>admin</ns1:name>
            <ns1:href>user/1</ns1:href>
            <ns1:id>1</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.User+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:creator>
        <ns1:created>2015-05-28T10:01:28+10:00</ns1:created>
        <ns1:lockType>0</ns1:lockType>
        <ns1:lastModified>2015-05-28T10:02:43+10:00</ns1:lastModified>
        <ns1:parent>
            <ns1:name>MWS2R3_SYD</ns1:name>
            <ns1:href>project/8</ns1:href>
            <ns1:id>8</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Project+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:parent>
        <ns1:slot>d049eb4d-ce47-4986-aa40-f05ae322932b</ns1:slot>
        <ns1:version>6</ns1:version>
        <ns1:latest>false</ns1:latest>
        <ns1:publishComment></ns1:publishComment>
        <ns1:slotId>123</ns1:slotId>
        <ns1:publisher>
            <ns1:name>admin</ns1:name>
            <ns1:href>user/1</ns1:href>
            <ns1:id>1</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.User+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:publisher>
        <ns1:versionStatus>active</ns1:versionStatus>
        <ns1:checkoutAllowed>false</ns1:checkoutAllowed>
        <ns1:headAllowed>false</ns1:headAllowed>
        <ns1:operatingSystem>Windows|2012</ns1:operatingSystem>
        <ns1:enableExtensions>false</ns1:enableExtensions>
        <ns1:body>
# Support multiple deployment environments
$environment = $ENVIRONMENT

$script = @'
Add-Type -AssemblyName System.Web

function set-globalvariable($key,$val) {
	__ENVCODE__
	Invoke-WebRequest -Method PUT -Uri http://10.3.40.5:4001/v2/keys/$($key)?value=$([System.Web.HttpUtility]::UrlEncode($($val))) -UseBasicParsing
}

function get-globalvariable($key) {
	__ENVCODE__
	$resp = Invoke-RestMethod -Method GET -Uri http://10.3.40.5:4001/v2/keys/$key
	return $resp.node
}

function get-globalvariable_json($key) {
	__ENVCODE__
	$resp = Invoke-RestMethod -Method GET -Uri http://10.3.40.5:4001/v2/keys/$key
	return ConvertFrom-Json $resp.node.value
}


function connect-deploymentshare
{
    #$share = get-globalvariable 'Global/DeploymentShare'
    #$username = get-globalvariable 'Global/DeploymentUsername'
    #$password = get-globalvariable 'Global/DeploymentPassword'
    
    #$secure_pwd = convertto-securestring $password.value -asplaintext -force
    
    #$dcred = new-object -typename System.Management.Automation.PSCredential -argumentlist $username.value, $secure_pwd
    #$d = New-PSDrive -Name 'Y' -PSProvider FileSystem -Root $share.value -Credential $dcred -Scope Global -persist 

	# [DRidley] updated to utilise dynamic drive letter 'drv' &amp; NET USE instead, as New-PSDrive always fails when run a 2nd time
	$share = 	(get-globalvariable(&quot;Global\DeploymentShare&quot;)).value
    $username = (get-globalvariable(&quot;Global\DeploymentUsername&quot;)).value
    $password = (get-globalvariable(&quot;Global\DeploymentPassword&quot;)).value
    
	$global:drv = dir function:[m-z]: -Name | Where { -Not (test-path $_ )} | select -first 1
	$d = net use $drv $share /user:$username $password
    
    #If (Test-Path $drv) {Write-Host &quot;$drv = Yes&quot;} Else {Write-Host &quot;$drv = No&quot;; EXIT}
}


function disconnect-deploymentshare
{
    #$d = Remove-PSDrive -Name 'Y'
    $d = net use $drv /delete
}


# Stiven: cater for the introduction of deploy folder subfolders as a result of introducing SVN
#         assumption is computer related folders will always and only be in the deployScript folder
function get-files($computer){
    connect-deploymentshare
    
    # Copy Common Files
    Copy-Item &quot;$drv\DeployScript\Common\*&quot; .\ -Recurse -force -Verbose
    Copy-Item &quot;$drv\DeployInstall\Common\*&quot; .\ -Recurse -force -Verbose
        
    # Copy Computer Specific files
    $c = $computer
    if( Test-Path -Path (&quot;$drv\DeployScript\&quot; + $c)){
    	$p = &quot;$drv\DeployScript\&quot; + $c + &quot;\*&quot;
    	Copy-Item $p .\ -Recurse -force -Verbose
    }else{
    	write-output &quot;computername folder does not exist - $c&quot;
    }
    
    disconnect-deploymentshare
}


function Get-AppFiles($appname){
   connect-deploymentshare

   $rootFolder = &quot;$drv\DeployScript\&quot;
   Copy-Files $rootFolder $appname

   $rootFolder = &quot;$drv\DeployInstall\&quot;
   Copy-Files $rootFolder $appname

   disconnect-deploymentshare
}

# Stiven: cater for the introduction of deploy folder subfolders as a result of introducing SVN
function Copy-Files($rootfolder, $appname){
    $p = $rootFolder + $appname + &quot;\*&quot;
    if(Test-Path -Path ($rootFolder + $appname)){
        Write-Output &quot;Copying Application files from $rootFolder$($appname)&quot;
        Copy-Item $p .\ -Recurse -force
    } Else {
        Write-Error &quot;Application folder $appname does not exist&quot; -ErrorAction SilentlyContinue
    }  
}

'@


# Perform a replace on __ENVCODE__ to support multiple AD environments
if($environment -eq $null){
	write-output &quot;Generating script for default environment&quot;
	$script = $script -replace &quot;__ENVCODE__&quot;,&quot;&quot;
}else{
	write-output &quot;Generating script for [$environment] environment&quot;
	$newstring = $('$key= &quot;[' + $environment + ']/$key&quot;')
    	$script = $script -replace &quot;__ENVCODE__&quot;,$newstring
}

$script | out-file &quot;GlobalRepository.ps1&quot;

# Load Common functions
#. .\GlobalRepository.ps1
# download common files and computer specific files
#get-files</ns1:body>
        <ns1:type>Guest</ns1:type>
        <ns1:language>
            <ns1:name>powershell</ns1:name>
            <ns1:href>scriptlanguage/5</ns1:href>
            <ns1:id>5</ns1:id>
            <ns1:rel>down</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.ScriptLanguage+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:language>
        <ns1:runAsAdmin>false</ns1:runAsAdmin>
        <ns1:timeout>3600</ns1:timeout>
        <ns1:retries>0</ns1:retries>
        <ns1:delay>0</ns1:delay>
        <ns1:errorAction>Continue</ns1:errorAction>
        <ns1:rebootRequired>false</ns1:rebootRequired>
        <ns1:variable>
            <ns1:name>ENVIRONMENT</ns1:name>
            <ns1:id>515</ns1:id>
            <ns1:description></ns1:description>
            <ns1:uuid>f91b5269-a802-4199-9abc-037cdc92f737</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath></ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:displayName>ENVIRONMENT</ns1:displayName>
            <ns1:readable>true</ns1:readable>
            <ns1:writable>true</ns1:writable>
            <ns1:minRequired>0</ns1:minRequired>
            <ns1:maxAllowed>1</ns1:maxAllowed>
            <ns1:validator/>
            <ns1:propertyType>
                <ns1:name>string-any</ns1:name>
                <ns1:href>propertytype/4</ns1:href>
                <ns1:id>4</ns1:id>
                <ns1:type>application/com.servicemesh.agility.api.PropertyType+xml</ns1:type>
            </ns1:propertyType>
            <ns1:assetPropertyLinkId>d368f55d-868c-4731-9ec3-21dd29bf3625</ns1:assetPropertyLinkId>
        </ns1:variable>
        <ns1:runOnProvisionOnly>false</ns1:runOnProvisionOnly>
    </ns1:pendingAsset>
    <ns1:pendingAsset xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="ns1:Script">
        <ns1:name>MWS2R3 - AD Rename Computer</ns1:name>
        <ns1:id>263</ns1:id>
        <ns1:description></ns1:description>
        <ns1:uuid>0a9f62ed-9e20-4237-80af-86c649d98c04</ns1:uuid>
        <ns1:assetType>
            <ns1:name>script</ns1:name>
            <ns1:href>assettype/2</ns1:href>
            <ns1:id>2</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.AssetType+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:assetType>
        <ns1:top>false</ns1:top>
        <ns1:assetPath>/Root/MWS2R3_SYD</ns1:assetPath>
        <ns1:detailedAssetPath>/Root:#ID#1:#TYPE#VMContainer/MWS2R3_SYD:#ID#8:#TYPE#VMProject</ns1:detailedAssetPath>
        <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
        <ns1:removable>true</ns1:removable>
        <ns1:domain>
            <ns1:name>domain1</ns1:name>
            <ns1:href>domain/1</ns1:href>
            <ns1:id>1</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Domain+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:domain>
        <ns1:creator>
            <ns1:name>admin</ns1:name>
            <ns1:href>user/1</ns1:href>
            <ns1:id>1</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.User+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:creator>
        <ns1:created>2015-05-27T17:23:30+10:00</ns1:created>
        <ns1:lockType>0</ns1:lockType>
        <ns1:lastModified>2015-05-27T17:25:29+10:00</ns1:lastModified>
        <ns1:parent>
            <ns1:name>MWS2R3_SYD</ns1:name>
            <ns1:href>project/8</ns1:href>
            <ns1:id>8</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Project+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:parent>
        <ns1:slot>be49d25b-3405-4f3f-8509-8bd2448968f4</ns1:slot>
        <ns1:version>4</ns1:version>
        <ns1:latest>false</ns1:latest>
        <ns1:publishComment></ns1:publishComment>
        <ns1:slotId>124</ns1:slotId>
        <ns1:publisher>
            <ns1:name>admin</ns1:name>
            <ns1:href>user/1</ns1:href>
            <ns1:id>1</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.User+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:publisher>
        <ns1:versionStatus>active</ns1:versionStatus>
        <ns1:checkoutAllowed>false</ns1:checkoutAllowed>
        <ns1:headAllowed>false</ns1:headAllowed>
        <ns1:operatingSystem>Windows|2012</ns1:operatingSystem>
        <ns1:enableExtensions>false</ns1:enableExtensions>
        <ns1:body>#	ScriptName: 	AD Rename Computer
#	Author: 	Mark Freeman
#	Required Variables: COMPONENTID, INSTANCEID
#	Description:
#
#	Renames a computer based on MWS2 naming standard
#	Registers the computername and IP address in the key value store
#	Downloads common and computer specific files from the deployment file share
#	Resets the local administrator account password to a random value
#	Registers the password in the key value share
#	Updates the instance name in Cloud Provider
#
#	2015/05/21	DRidley		-Updated Rename Computer section to check if IstanceID has already been deployed


. .\GlobalRepository.ps1


$ComponentID = $COMPONENTID
$InstanceID =  $INSTANCEID
$DomainFQDN =  (get-globalvariable(&quot;Global\DomainFQDN&quot;)).value

$CustomerID = (get-globalvariable &quot;Global/CustomerID&quot;).value
$LocationID = (get-globalvariable &quot;Global/LocationID&quot;).value

# Set Primary &amp; Secondary DNS on active NIC. This is required to check if InstanceID has already been deployed
$PrimaryDNS =   (get-globalvariable(&quot;AD\PrimaryDNS&quot;)).value
$SecondaryDNS = (get-globalvariable(&quot;AD\SecondaryDNS&quot;)).value
$NICindex = Get-NetAdapter -physical | where status -eq 'up' | Select 'Name' -ExpandProperty ifIndex
Write-Output &quot;Setting $PrimaryDNS and $SecondaryDNS as DNS servers on active NIC&quot;
Set-DNSClientServerAddress -InterfaceIndex $NICindex -ServerAddresses ($PrimaryDNS,$SecondaryDNS)


# Rename Computer
$Computername = $($CustomerID + $ComponentID + $LocationID + $InstanceID + &quot;W&quot;)
Write-Output &quot;Checking if $Computername has been previously deployed...&quot;
If (Test-Connection -Computername &quot;$Computername.$DomainFQDN&quot; -Count 2 -Quiet)
{
	Write-Output &quot;ERROR: $Computername is already deployed! Exiting...&quot;
	EXIT 1
}
Else
{
	Write-Output &quot;$ComponentID-$InstanceID does not appear to have been previously deployed. Continuing...&quot;
	Write-Output &quot;Setting computername to $Computername&quot;
	Rename-Computer -NewName $Computername -force
}


write-output &quot;Storing IP Address in key value store&quot;
$key = 'Network/{0}' -f $Computername
$ip = Get-NetIPAddress | Where-Object -FilterScript {$_.AddressFamily -eq &quot;IPv4&quot; } | Where-Object -FilterScript {$_.IPAddress -ne &quot;127.0.0.1&quot;}
$ipa = $ip.IPAddress
Set-globalvariable $key $ipa

write-output &quot;Downloading common files and computer files from repository&quot;

get-files &quot;$ComponentID$InstanceID&quot;

write-output &quot;Resetting local administrator password&quot;
. .\New-RandomPassword.ps1
$password = new-randompassword -PasswordLength 10
$adminUser = [ADSI] &quot;WinNT://./SOE-LOAD,User&quot;
$adminUser.SetPassword($password)
Set-globalvariable &quot;Administrator/$Computername&quot; $password

#register name tag
#write-output &quot;Registering AWS name tag&quot;
#$aid  = Invoke-RestMethod -Uri http://169.254.169.254/latest/meta-data/instance-id
#$uri = &quot;http://10.0.0.23:5000/p1/&quot; + $aid + &quot;?tagname=&quot; + $Computername 
#Invoke-RestMethod -Uri $uri -Method Put


write-output &quot;Restarting computer&quot;</ns1:body>
        <ns1:type>Guest</ns1:type>
        <ns1:language>
            <ns1:name>powershell</ns1:name>
            <ns1:href>scriptlanguage/5</ns1:href>
            <ns1:id>5</ns1:id>
            <ns1:rel>down</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.ScriptLanguage+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:language>
        <ns1:runAsAdmin>false</ns1:runAsAdmin>
        <ns1:timeout>3600</ns1:timeout>
        <ns1:retries>0</ns1:retries>
        <ns1:delay>0</ns1:delay>
        <ns1:errorAction>Continue</ns1:errorAction>
        <ns1:rebootRequired>true</ns1:rebootRequired>
        <ns1:variable>
            <ns1:name>INSTANCEID</ns1:name>
            <ns1:id>513</ns1:id>
            <ns1:description></ns1:description>
            <ns1:uuid>a03c9761-2ddf-4b07-84c3-03155365b7c7</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath></ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:displayName>INSTANCEID</ns1:displayName>
            <ns1:readable>true</ns1:readable>
            <ns1:writable>true</ns1:writable>
            <ns1:minRequired>0</ns1:minRequired>
            <ns1:maxAllowed>1</ns1:maxAllowed>
            <ns1:validator/>
            <ns1:propertyType>
                <ns1:name>string-any</ns1:name>
                <ns1:href>propertytype/4</ns1:href>
                <ns1:id>4</ns1:id>
                <ns1:type>application/com.servicemesh.agility.api.PropertyType+xml</ns1:type>
            </ns1:propertyType>
            <ns1:assetPropertyLinkId>a6456190-233d-4da2-b2db-0176dc2fc1af</ns1:assetPropertyLinkId>
        </ns1:variable>
        <ns1:variable>
            <ns1:name>COMPONENTID</ns1:name>
            <ns1:id>514</ns1:id>
            <ns1:description></ns1:description>
            <ns1:uuid>0ee97a5e-2783-4261-9f35-c14735ba78e8</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath></ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:displayName>COMPONENTID</ns1:displayName>
            <ns1:readable>true</ns1:readable>
            <ns1:writable>true</ns1:writable>
            <ns1:minRequired>0</ns1:minRequired>
            <ns1:maxAllowed>1</ns1:maxAllowed>
            <ns1:validator/>
            <ns1:propertyType>
                <ns1:name>string-any</ns1:name>
                <ns1:href>propertytype/4</ns1:href>
                <ns1:id>4</ns1:id>
                <ns1:type>application/com.servicemesh.agility.api.PropertyType+xml</ns1:type>
            </ns1:propertyType>
            <ns1:assetPropertyLinkId>23d25ec2-96bc-4153-975c-2bef711c6d58</ns1:assetPropertyLinkId>
        </ns1:variable>
        <ns1:runOnProvisionOnly>false</ns1:runOnProvisionOnly>
    </ns1:pendingAsset>
    <ns1:pendingAsset xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="ns1:Script">
        <ns1:name>MWS2R3 - AD Add to Domain</ns1:name>
        <ns1:id>164</ns1:id>
        <ns1:description></ns1:description>
        <ns1:uuid>242f4f65-8f5d-4fd3-92ae-0fb595f5a54a</ns1:uuid>
        <ns1:assetType>
            <ns1:name>script</ns1:name>
            <ns1:href>assettype/2</ns1:href>
            <ns1:id>2</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.AssetType+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:assetType>
        <ns1:top>false</ns1:top>
        <ns1:assetPath>/Root/MWS2R3_SYD</ns1:assetPath>
        <ns1:detailedAssetPath>/Root:#ID#1:#TYPE#VMContainer/MWS2R3_SYD:#ID#8:#TYPE#VMProject</ns1:detailedAssetPath>
        <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
        <ns1:removable>true</ns1:removable>
        <ns1:domain>
            <ns1:name>domain1</ns1:name>
            <ns1:href>domain/1</ns1:href>
            <ns1:id>1</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Domain+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:domain>
        <ns1:creator>
            <ns1:name>mfreema6</ns1:name>
            <ns1:href>user/7</ns1:href>
            <ns1:id>7</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.User+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:creator>
        <ns1:created>2015-05-14T15:07:00+10:00</ns1:created>
        <ns1:lockType>0</ns1:lockType>
        <ns1:lastModified>2015-05-14T15:09:06+10:00</ns1:lastModified>
        <ns1:parent>
            <ns1:name>MWS2R3_SYD</ns1:name>
            <ns1:href>project/8</ns1:href>
            <ns1:id>8</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Project+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:parent>
        <ns1:slot>f5b9dfd5-6d07-4c09-a003-9229d089d7f1</ns1:slot>
        <ns1:version>2</ns1:version>
        <ns1:latest>false</ns1:latest>
        <ns1:publishComment></ns1:publishComment>
        <ns1:slotId>125</ns1:slotId>
        <ns1:publisher>
            <ns1:name>mfreema6</ns1:name>
            <ns1:href>user/7</ns1:href>
            <ns1:id>7</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.User+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:publisher>
        <ns1:versionStatus>active</ns1:versionStatus>
        <ns1:checkoutAllowed>false</ns1:checkoutAllowed>
        <ns1:headAllowed>false</ns1:headAllowed>
        <ns1:operatingSystem>Windows|2012</ns1:operatingSystem>
        <ns1:enableExtensions>false</ns1:enableExtensions>
        <ns1:body>#	ScriptName: 	AD Add to Domain
#	Author: 	Mark Freeman
#	Required Variables: None
#	Description:
#
#	Adds a computer to the MWS2 Resource Domain


. .\GlobalRepository.ps1

$domainname = (get-globalvariable &quot;Global\DomainFQDN&quot;).value
$domainNB = (get-globalvariable &quot;Global\DomainNetBIOS&quot;).value
$short_username = (get-globalvariable &quot;Global\DeploymentUsername&quot;).value
$username = &quot;$domainNB\$short_username&quot;
$password = (get-globalvariable &quot;Global\DeploymentPassword&quot;).value
$dn = (get-globalvariable &quot;AD\DistinguishedName&quot;).value

$pdns = (get-globalvariable &quot;AD\PrimaryDNS&quot;).value
$sdns = (get-globalvariable &quot;AD\SecondaryDNS&quot;).value

$computername = $env:COMPUTERNAME
$ouPath = &quot;OU=servers,OU=customer,$dn&quot;

if ($computername.ToLower().Contains(&quot;dbs&quot;)){
    $ouPath=&quot;OU=Database,$ouPath&quot;
}

if ($computername.ToLower().Contains(&quot;mas&quot;)){
    $ouPath=&quot;OU=Exchange,$ouPath&quot;
}

$na=Get-NetAdapter -Physical | where status -eq 'up'
Set-DnsClientServerAddress -InterfaceIndex $na.ifIndex -ServerAddresses ($pdns,$sdns)

$secure_pwd = convertto-securestring $password -asplaintext -force
$djcred = new-object -typename System.Management.Automation.PSCredential `
         -argumentlist $username, $secure_pwd

Add-Computer -DomainName $domainname -Credential $djcred -OUPath $ouPath -Force
write-output &quot;Joined domain.&quot;


</ns1:body>
        <ns1:type>Guest</ns1:type>
        <ns1:language>
            <ns1:name>powershell</ns1:name>
            <ns1:href>scriptlanguage/5</ns1:href>
            <ns1:id>5</ns1:id>
            <ns1:rel>down</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.ScriptLanguage+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:language>
        <ns1:runAsAdmin>false</ns1:runAsAdmin>
        <ns1:timeout>3600</ns1:timeout>
        <ns1:retries>0</ns1:retries>
        <ns1:delay>0</ns1:delay>
        <ns1:errorAction>Continue</ns1:errorAction>
        <ns1:rebootRequired>true</ns1:rebootRequired>
        <ns1:runOnProvisionOnly>false</ns1:runOnProvisionOnly>
    </ns1:pendingAsset>
    <ns1:pendingAsset xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="ns1:Package">
        <ns1:name>MWS2R3 - AD Rename and Add to Domain</ns1:name>
        <ns1:id>36</ns1:id>
        <ns1:description></ns1:description>
        <ns1:uuid>3f8ca186-fbe3-4edb-8239-8cc2225b1c98</ns1:uuid>
        <ns1:assetType>
            <ns1:name>package</ns1:name>
            <ns1:href>assettype/3</ns1:href>
            <ns1:id>3</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.AssetType+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:assetType>
        <ns1:top>false</ns1:top>
        <ns1:assetPath>/Root/MWS2R3_SYD</ns1:assetPath>
        <ns1:detailedAssetPath>/Root:#ID#1:#TYPE#VMContainer/MWS2R3_SYD:#ID#8:#TYPE#VMProject</ns1:detailedAssetPath>
        <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
        <ns1:removable>true</ns1:removable>
        <ns1:domain>
            <ns1:name>domain1</ns1:name>
            <ns1:href>domain/1</ns1:href>
            <ns1:id>1</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Domain+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:domain>
        <ns1:creator>
            <ns1:name>mfreema6</ns1:name>
            <ns1:href>user/7</ns1:href>
            <ns1:id>7</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.User+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:creator>
        <ns1:created>2015-05-14T15:13:50+10:00</ns1:created>
        <ns1:lockType>0</ns1:lockType>
        <ns1:lastModified>2015-05-14T15:15:46+10:00</ns1:lastModified>
        <ns1:parent>
            <ns1:name>MWS2R3_SYD</ns1:name>
            <ns1:href>project/8</ns1:href>
            <ns1:id>8</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Project+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:parent>
        <ns1:slot>ca672b7b-d7d2-4e55-9cf0-c1d824ad2b2b</ns1:slot>
        <ns1:version>2</ns1:version>
        <ns1:latest>true</ns1:latest>
        <ns1:publishComment></ns1:publishComment>
        <ns1:slotId>126</ns1:slotId>
        <ns1:publisher>
            <ns1:name>mfreema6</ns1:name>
            <ns1:href>user/7</ns1:href>
            <ns1:id>7</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.User+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:publisher>
        <ns1:versionStatus>active</ns1:versionStatus>
        <ns1:checkoutAllowed>true</ns1:checkoutAllowed>
        <ns1:headAllowed>false</ns1:headAllowed>
        <ns1:operatingSystem>Windows|2012</ns1:operatingSystem>
        <ns1:install>
            <ns1:name>MWS2R3 - AD Global Repository</ns1:name>
            <ns1:href>script/132</ns1:href>
            <ns1:id>264</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Script+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:install>
        <ns1:install>
            <ns1:name>MWS2R3 - AD Rename Computer</ns1:name>
            <ns1:href>script/133</ns1:href>
            <ns1:id>263</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Script+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:install>
        <ns1:install>
            <ns1:name>MWS2R3 - AD Add to Domain</ns1:name>
            <ns1:href>script/134</ns1:href>
            <ns1:id>164</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Script+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:install>
    </ns1:pendingAsset>
    <ns1:pendingAsset xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="ns1:Script">
        <ns1:name>MWS2R3 - Avecto - Common Prereqs</ns1:name>
        <ns1:id>386</ns1:id>
        <ns1:description></ns1:description>
        <ns1:uuid>dfd06412-ebf9-4c0a-abf6-355409b6ff8e</ns1:uuid>
        <ns1:assetType>
            <ns1:name>script</ns1:name>
            <ns1:href>assettype/2</ns1:href>
            <ns1:id>2</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.AssetType+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:assetType>
        <ns1:top>false</ns1:top>
        <ns1:assetPath>/Root/MWS2R3_SYD</ns1:assetPath>
        <ns1:detailedAssetPath>/Root:#ID#1:#TYPE#VMContainer/MWS2R3_SYD:#ID#8:#TYPE#VMProject</ns1:detailedAssetPath>
        <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
        <ns1:removable>true</ns1:removable>
        <ns1:domain>
            <ns1:name>domain1</ns1:name>
            <ns1:href>domain/1</ns1:href>
            <ns1:id>1</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Domain+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:domain>
        <ns1:creator>
            <ns1:name>dridley</ns1:name>
            <ns1:href>user/12</ns1:href>
            <ns1:id>12</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.User+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:creator>
        <ns1:created>2015-07-02T09:43:46+10:00</ns1:created>
        <ns1:lockType>0</ns1:lockType>
        <ns1:lastModified>2015-07-02T09:46:54+10:00</ns1:lastModified>
        <ns1:parent>
            <ns1:name>MWS2R3_SYD</ns1:name>
            <ns1:href>project/8</ns1:href>
            <ns1:id>8</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Project+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:parent>
        <ns1:slot>8be72861-4d15-4693-94c1-14d8be290f22</ns1:slot>
        <ns1:version>3</ns1:version>
        <ns1:latest>false</ns1:latest>
        <ns1:publishComment></ns1:publishComment>
        <ns1:slotId>192</ns1:slotId>
        <ns1:publisher>
            <ns1:name>dridley</ns1:name>
            <ns1:href>user/12</ns1:href>
            <ns1:id>12</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.User+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:publisher>
        <ns1:versionStatus>active</ns1:versionStatus>
        <ns1:checkoutAllowed>false</ns1:checkoutAllowed>
        <ns1:headAllowed>false</ns1:headAllowed>
        <ns1:operatingSystem>Windows</ns1:operatingSystem>
        <ns1:enableExtensions>false</ns1:enableExtensions>
        <ns1:body># Load Common functions
. .\Logging.ps1
. .\GlobalRepository.ps1
. .\LaunchProcess.ps1
. .\FilesUtility.ps1
. .\PlatformUtils.ps1
. .\UsersUtility.ps1


# get current script location
$scriptPath = split-path -parent $MyInvocation.MyCommand.Definition
$scriptName = $MyInvocation.MyCommand.Name
 
ConfigureLogging $scriptPath $scriptName
 
#########################################################################
# Main
#########################################################################
 
$DomainFQDN =				(get-globalvariable(&quot;Global\DomainFQDN&quot;)).value
$DomainNetBIOS = 			(get-globalvariable(&quot;Global\DomainNetBIOS&quot;)).value
$DomainDN = 				(get-globalvariable(&quot;AD\DistinguishedName&quot;)).value
$DomAdminName = 			(get-globalvariable(&quot;Global/DeploymentUsername&quot;)).value
$DomAdminPwd = 				get-serviceAccountPassword -username $DomAdminName.ToLower()			# Covert to lowercase as get-serviceAccountPassword function is case sensitive
$ServiceAccountName = 		&quot;$DomainNetBIOS\$ADP_SERVICEACCOUNT&quot;									# Svc account not set as a local env variable yet so need to reference BluePrint variable
$ServiceAccountPwd = 		get-serviceAccountPassword -username $ADP_SERVICEACCOUNT				# Bug in get-serviceAccountPassword function where it is case sensitive and not all values are stored in lowercase
$ADCustomerAppDN =			&quot;OU=Avecto,OU=Application Groups,OU=Customer,$DomainDN&quot;
$GPODomainController = 		Get-Computername -ComponentID DC12 -InstanceID 001
$PShEXE = 					&quot;$PSHome\Powershell.exe&quot;

 

Log &quot;**** Starting: Common Pre-Reqs Config... ****&quot;
Log &quot;`n&quot;


Log &quot;Copy required content locally&quot;		# Will be copied to C:\Users\&lt;profile&gt;
Get-AppFiles &quot;PC Devices\Avecto&quot;
Get-AppFiles &quot;PC Devices\Misc\WindowsFeatures_Prereq&quot;
Log &quot;`n&quot;

Log &quot;Set Timezone...&quot;
tzutil /s &quot;$OS_TIMEZONE&quot;
If ($LastExitCode -ne 0) {Log &quot;ERROR: Timezone could not be set. Possibly due to inability to enumerate variables.&quot;; EXIT 1}
Log &quot;`n&quot;


Log &quot;Installing Windows 2012 Roles (.NET 3.5 - includes .NET 2.0 and 3.0)...&quot;			# .NET 4.0 is already included in the Server SOE
Log &quot;    **KB2966828  |  .NET 3.5 prereq on Win2012 as per KB3005628&quot;
CMD /c Start /WAIT WUSA.exe &quot;$ScriptPath\WindowsFeatures_Prereq\Windows8.1-KB2966828-x64.msu&quot; /quiet /norestart /log:&quot;$env:windir\Debug\Avecto\$env:computername-KB3005628.log&quot;
Log &quot;    **.NET 3.5&quot;
$Feature = Install-WindowsFeature -Name NET-Framework-Core -Source &quot;$ScriptPath\WindowsFeatures_Prereq\sxs&quot; -LogPath &quot;$env:windir\Debug\Avecto\$env:computername-Roles_.NET3.5.log&quot;		# Source switch used for .NET 3.5 only
If (!($Feature.Success)) {Log &quot;ERROR: Failed to install Windows Roles and Features. Exiting...&quot;; EXIT 1}
Log &quot;`n&quot;

Log &quot;Installing Windows 2012 Features (BITS, GPMC, AD Tools)...&quot;
$Feature = Install-WindowsFeature -Name BITS-IIS-Ext,RSAT-Bits-Server,GPMC,RSAT-ADDS-Tools,RSAT-AD-PowerShell,RSAT-ADLDS -LogPath &quot;$env:windir\Debug\Avecto\$env:computername-Features.log&quot;
If (!($Feature.Success)) {Log &quot;ERROR: Failed to install Windows Roles and Features. Exiting...&quot;; EXIT 1}
Log &quot;`n&quot;
Start-Sleep -Seconds 30


Log &quot;Define local admins...&quot;		# Does not require domain credentials to run
# Note: svc account needs to be local admin prior to calling any LaunchProcessAsUser function, as it needs logon as a batch job rights
AddUserToLocalAdministrators -ServerName &quot;$env:Computername&quot; -UserName &quot;$ServiceAccountName&quot;
If (!(net LocalGroup Administrators | Select-String -Pattern $ADP_SERVICEACCOUNT)) {&quot;ERROR: $ServiceAccountName could not be added to local admins&quot;; EXIT 1}			# Validate local admin

net user /add PCDevices_Admin PCdevices@dmin											# Create local account
AddUserToLocalAdministrators -ServerName &quot;$env:Computername&quot; -UserName &quot;$env:Computername\PCDevices_Admin&quot;
Log &quot;`n&quot;

   
Log &quot;    ** Creating AD Objects&quot;
# Modify PS1 file
$PS1File = &quot;$ScriptPath\Defendpoint\Scripts\Avecto-AD Object-Creation.ps1&quot;
(Get-Content $PS1File) | ForEach-Object { $_ -replace &quot;DomainFQDN =.*&quot; ,			&quot;DomainFQDN = `&quot;$DomainFQDN`&quot;&quot; }					| Set-Content $PS1File
(Get-Content $PS1File) | ForEach-Object { $_ -replace &quot;DomainNetBIOS =.*&quot; ,			&quot;DomainNetBIOS = `&quot;$DomainNetBIOS`&quot;&quot; }				| Set-Content $PS1File
(Get-Content $PS1File) | ForEach-Object { $_ -replace &quot;DomainDN =.*&quot; ,				&quot;DomainDN = `&quot;$DomainDN`&quot;&quot; }						| Set-Content $PS1File
(Get-Content $PS1File) | ForEach-Object { $_ -replace &quot;ADCustomerAppDN =.*&quot; ,		&quot;ADCustomerAppDN = `&quot;$ADCustomerAppDN`&quot;&quot; }			| Set-Content $PS1File
(Get-Content $PS1File) | ForEach-Object { $_ -replace &quot;GPODomainController =.*&quot; ,	&quot;GPODomainController = `&quot;$GPODomainController`&quot;&quot; }	| Set-Content $PS1File

# Run PS1 file using svc account credentials
$ArgList = &quot;-file `&quot;$PS1File`&quot;&quot;
$ret = LaunchProcessAsUser &quot;$PShEXE&quot; $ArgList $DomAdminName $DomAdminPwd
If ($ret -ne 0 -And $ret -ne 3010) {Log &quot;ERROR: Exitcode = $ret. Failed to create AD objects. Exiting...&quot;; EXIT 1}
Log &quot;`n&quot;


Log &quot;Creating User Profile Cleanup Task...&quot;
$SchTasks_Date = (Get-Date).AddDays(5).ToString(&quot;MM/dd/yyyy&quot;)
$ProfPath = $env:UserProfile
# Create Agility User cleanup script
echo &quot;Get-CimInstance win32_userprofile -Verbose | Where {`$_.LocalPath -eq '$ProfPath'} | Remove-CimInstance -Verbose&quot; &gt; $env:windir\Debug\Avecto\Agility-DelProf-$env:USERNAME.ps1
SchTasks /Create /SC &quot;Once&quot; /SD $SchTasks_Date /ST 01:00 /F /RU &quot;SYSTEM&quot; /TN &quot;Agility-DelProf-$env:USERNAME&quot; /TR &quot;Powershell.exe -File '$env:windir\Debug\Avecto\Agility-DelProf-$env:USERNAME.ps1'&quot;
Log &quot;`n&quot;


Log &quot;**** Finished: Common Pre-Reqs Config... ****&quot;</ns1:body>
        <ns1:type>Guest</ns1:type>
        <ns1:language>
            <ns1:name>powershell</ns1:name>
            <ns1:href>scriptlanguage/5</ns1:href>
            <ns1:id>5</ns1:id>
            <ns1:rel>down</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.ScriptLanguage+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:language>
        <ns1:runAsAdmin>false</ns1:runAsAdmin>
        <ns1:timeout>1800</ns1:timeout>
        <ns1:retries>0</ns1:retries>
        <ns1:delay>0</ns1:delay>
        <ns1:errorAction>Abort</ns1:errorAction>
        <ns1:rebootRequired>true</ns1:rebootRequired>
        <ns1:variable>
            <ns1:name>OS_TIMEZONE</ns1:name>
            <ns1:id>1160</ns1:id>
            <ns1:description>Timezone as per &quot;TZUTIL /L&quot;</ns1:description>
            <ns1:uuid>d5cd3cc6-eb47-4ba0-ab5e-376722df8896</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath></ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:displayName>OS_TIMEZONE</ns1:displayName>
            <ns1:readable>true</ns1:readable>
            <ns1:writable>true</ns1:writable>
            <ns1:minRequired>1</ns1:minRequired>
            <ns1:maxAllowed>1</ns1:maxAllowed>
            <ns1:validator/>
            <ns1:defaultValue>
                <ns1:id>54414</ns1:id>
                <ns1:name>OS_TIMEZONE</ns1:name>
                <ns1:encrypted>false</ns1:encrypted>
                <ns1:overridable>true</ns1:overridable>
                <ns1:propertyType>
                    <ns1:name>string-any</ns1:name>
                    <ns1:href>/propertytype/4</ns1:href>
                    <ns1:id>4</ns1:id>
                    <ns1:rel>up</ns1:rel>
                    <ns1:type>application/com.servicemesh.agility.api.PropertyType+xml</ns1:type>
                    <ns1:position>0</ns1:position>
                </ns1:propertyType>
                <ns1:propertyDefinition xsi:type="ns1:Link">
                    <ns1:name>OS_TIMEZONE</ns1:name>
                    <ns1:href>/propertydefinition/1160</ns1:href>
                    <ns1:id>1160</ns1:id>
                    <ns1:rel>up</ns1:rel>
                    <ns1:type>application/com.servicemesh.agility.api.PropertyDefinition+xml</ns1:type>
                    <ns1:position>0</ns1:position>
                </ns1:propertyDefinition>
                <ns1:stringValue>AUS Eastern Standard Time</ns1:stringValue>
            </ns1:defaultValue>
            <ns1:propertyType>
                <ns1:name>string-any</ns1:name>
                <ns1:href>propertytype/4</ns1:href>
                <ns1:id>4</ns1:id>
                <ns1:type>application/com.servicemesh.agility.api.PropertyType+xml</ns1:type>
            </ns1:propertyType>
            <ns1:assetPropertyLinkId>1262eba0-6933-489b-9c94-29fafca60ea2</ns1:assetPropertyLinkId>
        </ns1:variable>
        <ns1:variable>
            <ns1:name>ADP_SERVICEACCOUNT</ns1:name>
            <ns1:id>1161</ns1:id>
            <ns1:description></ns1:description>
            <ns1:uuid>7c1c136c-87bd-4a5c-9a6f-5b4fcdaef591</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath></ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:displayName>ADP_SERVICEACCOUNT</ns1:displayName>
            <ns1:readable>true</ns1:readable>
            <ns1:writable>true</ns1:writable>
            <ns1:minRequired>1</ns1:minRequired>
            <ns1:maxAllowed>1</ns1:maxAllowed>
            <ns1:validator/>
            <ns1:defaultValue>
                <ns1:id>54415</ns1:id>
                <ns1:name></ns1:name>
                <ns1:encrypted>false</ns1:encrypted>
                <ns1:overridable>true</ns1:overridable>
                <ns1:propertyType>
                    <ns1:name>string-any</ns1:name>
                    <ns1:href>/propertytype/4</ns1:href>
                    <ns1:id>4</ns1:id>
                    <ns1:rel>up</ns1:rel>
                    <ns1:type>application/com.servicemesh.agility.api.PropertyType+xml</ns1:type>
                    <ns1:position>0</ns1:position>
                </ns1:propertyType>
                <ns1:stringValue>svc_Avecto_Install</ns1:stringValue>
            </ns1:defaultValue>
            <ns1:propertyType>
                <ns1:name>string-any</ns1:name>
                <ns1:href>propertytype/4</ns1:href>
                <ns1:id>4</ns1:id>
                <ns1:type>application/com.servicemesh.agility.api.PropertyType+xml</ns1:type>
            </ns1:propertyType>
            <ns1:assetPropertyLinkId>fd86ec6d-b2d8-4509-9e91-e7195800e723</ns1:assetPropertyLinkId>
        </ns1:variable>
        <ns1:runOnProvisionOnly>false</ns1:runOnProvisionOnly>
    </ns1:pendingAsset>
    <ns1:pendingAsset xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="ns1:Script">
        <ns1:name>MWS2R3 - Avecto - Defendpoint Install</ns1:name>
        <ns1:id>389</ns1:id>
        <ns1:description></ns1:description>
        <ns1:uuid>7e01f041-8ffb-43e2-b215-b2840b1ea451</ns1:uuid>
        <ns1:assetType>
            <ns1:name>script</ns1:name>
            <ns1:href>assettype/2</ns1:href>
            <ns1:id>2</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.AssetType+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:assetType>
        <ns1:top>false</ns1:top>
        <ns1:assetPath>/Root/MWS2R3_SYD</ns1:assetPath>
        <ns1:detailedAssetPath>/Root:#ID#1:#TYPE#VMContainer/MWS2R3_SYD:#ID#8:#TYPE#VMProject</ns1:detailedAssetPath>
        <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
        <ns1:removable>true</ns1:removable>
        <ns1:domain>
            <ns1:name>domain1</ns1:name>
            <ns1:href>domain/1</ns1:href>
            <ns1:id>1</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Domain+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:domain>
        <ns1:creator>
            <ns1:name>dridley</ns1:name>
            <ns1:href>user/12</ns1:href>
            <ns1:id>12</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.User+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:creator>
        <ns1:created>2015-07-02T15:23:29+10:00</ns1:created>
        <ns1:lockType>0</ns1:lockType>
        <ns1:lastModified>2015-07-02T15:28:46+10:00</ns1:lastModified>
        <ns1:parent>
            <ns1:name>MWS2R3_SYD</ns1:name>
            <ns1:href>project/8</ns1:href>
            <ns1:id>8</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Project+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:parent>
        <ns1:slot>7942968e-09bd-4542-8c4f-8908e8b2d36f</ns1:slot>
        <ns1:version>4</ns1:version>
        <ns1:latest>false</ns1:latest>
        <ns1:publishComment></ns1:publishComment>
        <ns1:slotId>193</ns1:slotId>
        <ns1:publisher>
            <ns1:name>dridley</ns1:name>
            <ns1:href>user/12</ns1:href>
            <ns1:id>12</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.User+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:publisher>
        <ns1:versionStatus>active</ns1:versionStatus>
        <ns1:checkoutAllowed>false</ns1:checkoutAllowed>
        <ns1:headAllowed>false</ns1:headAllowed>
        <ns1:operatingSystem>Windows</ns1:operatingSystem>
        <ns1:enableExtensions>false</ns1:enableExtensions>
        <ns1:body># Load Common functions
. .\Logging.ps1
. .\GlobalRepository.ps1
. .\LaunchProcess.ps1
. .\FilesUtility.ps1
. .\PlatformUtils.ps1


# get current script location
$scriptPath = split-path -parent $MyInvocation.MyCommand.Definition
$scriptName = $MyInvocation.MyCommand.Name
 
ConfigureLogging $scriptPath $scriptName


#########################################################################
# Main
#########################################################################

#Use ArgList variable in Start-Process commands so embedded variables and env variables resolve

$DomainNetBIOS = 			(get-globalvariable(&quot;Global\DomainNetBIOS&quot;)).value
$EventSubscriptionGroup =	&quot;Avecto-GPO-Event Subscription Computers&quot;		# Security Group for Computer Accounts for the evevnt collector subscription
$SubscriptionXML =			&quot;$env:windir\Debug\Avecto\$env:computername-Avecto-EventCentralisationSubscription.xml&quot;


Log &quot;**** Starting: Avecto Defendpoint Install ****&quot;
Log &quot;`n&quot;


Log &quot;Install Avecto Defendpoint GPMC Snapin...&quot;
If ( Get-ItemProperty HKLM:\Software\Microsoft\Windows\CurrentVersion\Uninstall\* | Select-Object 'DisplayName' | Where-object {$_.DisplayName -Match 'Avecto Defendpoint Consoles'} )
{
	Log &quot;GPMC Snapin already installed&quot;
}
Else
{
	$arglist = &quot;/S /v/qn&quot;
	Start-Process -NoNewWindow -Wait -PassThru -FilePath &quot;$ScriptPath\Defendpoint\Binaries\DefendpointManagementConsoles_x64.exe&quot; -ArgumentList $arglist
	Log &quot;`n&quot;
}


Log &quot;Configuring Event Forwarding pre-requisites WinRM...&quot;
winrm quickconfig /q:true
wecutil qc /q:true
Log &quot;`n&quot;

Function StartSvc ($ServiceName)
{
	$svc = Get-Service | Where-Object {$_.name -eq &quot;$ServiceName&quot;}
    If ($svc.Status -ne &quot;Running&quot;)
	{
		Log &quot; - Staring the $ServiceName service&quot;
		Start-Service $ServiceName
		$svc = Get-Service | Where-Object {$_.name -eq &quot;$ServiceName&quot;}
	}
	Else
	{
		Log &quot; - The $ServiceName service is running&quot;
	}
	Log &quot;`n&quot;
}


Log &quot;Ensure WinRM is running...&quot;
StartSvc -ServiceName &quot;WinRM&quot;
Log &quot;Ensure Event Forwarding is running...&quot;
StartSvc -ServiceName &quot;Wecsvc&quot;
Log &quot;`n&quot;


# Installing Defendpoint Agent...&quot;
$DefendpointService = Get-Service | Where-Object {$_.name -eq &quot;Avecto Defendpoint Service&quot;}
If ($DefendpointService -ne $null)
{
	Log &quot; - The Defendpoint Client is already installed&quot;
    Log &quot;`n&quot;
}
Else
{
	Log &quot; - Defendpoint Client is not installed. Installing...&quot;
	# Deteremine which version of the client to install
	$OSArchitecture = Get-WmiObject Win32_OperatingSystem | Select-Object OSArchitecture
	If ($OSArchitecture.OSArchitecture -eq &quot;64-bit&quot;)
	{
		CMD /c Start /WAIT MSIEXEC.exe /i &quot;$ScriptPath\Defendpoint\Binaries\DefendpointClient_x64.msi&quot; /qn /norestart /log $env:windir\Debug\Avecto\$env:computername-DefendpointClient_x64.msi.log
		If ($LastExitCode -ne 0 -And $LastExitCode -ne 3010) {Log &quot;ERROR: $LastExitCode Failed to install Defendpoint Client. Exiting...&quot;; EXIT 1}
	}
	Else
	{
		CMD /c Start /WAIT MSIEXEC.exe /i &quot;$ScriptPath\Defendpoint\Binaries\DefendpointClient_x86.msi&quot; /qn /norestart /log $env:windir\Debug\Avecto\$env:computername-DefendpointClient_x86.msi.log
		If ($LastExitCode -ne 0 -And $LastExitCode -ne 3010) {Log &quot;ERROR: $LastExitCode Failed to install Defendpoint Client. Exiting...&quot;; EXIT 1}
	}
    Start-Sleep -Seconds 60
}

Log &quot;Stopping and disabling the Avecto Defendpoint Client service&quot;
If ($DefendpointService.Status -ne &quot;Stopped&quot;) {Stop-Service &quot;Avecto Defendpoint Service&quot;}
Set-Service &quot;Avecto Defendpoint Service&quot; -StartupType Disabled
Log &quot;`n&quot;


Log &quot;Auto configure the Event Viewer Subscription...&quot;						# Prereq is Defendpoing Client install and then a reboot
&amp; &quot;$ScriptPath\Defendpoint\Scripts\Avecto-EventFwd_Subscription.ps1&quot; -DomainName $DomainNetBIOS -EventForwardingComputerGroupName &quot;$EventSubscriptionGroup&quot; -XMLfile &quot;$SubscriptionXML&quot;
If (!(Test-Path -Path &quot;$SubscriptionXML&quot;)) {Log &quot;ERROR: Failed to create XML file. Exiting...&quot;; EXIT 1}
Log &quot;`n&quot;

Log &quot;Creating the Subscription...&quot;
wecutil cs &quot;$SubscriptionXML&quot;
If ($LastExitCode -eq 80)
{
	Log &quot;Subscription already exists&quot;
    Log &quot;`n&quot;
}
Else
{
	If ($LastExitCode -ne 0) {Log &quot;ERROR: $LastExitCode. Failed to create Subscription. Exiting...&quot;; EXIT 1}
}

Log &quot;Setting the subscription latency&quot;
wecutil ss &quot;Avecto Defendpoint Events&quot; /cm:MinLatency
If ($LastExitCode -ne 0) {Log &quot;ERROR: $LastExitCode. Failed to set subscription latency. Exiting...&quot;; EXIT 1}
Log &quot;`n&quot;


Log &quot;**** Finished: Avecto Defendpoint Install ****&quot;</ns1:body>
        <ns1:type>Guest</ns1:type>
        <ns1:language>
            <ns1:name>powershell</ns1:name>
            <ns1:href>scriptlanguage/5</ns1:href>
            <ns1:id>5</ns1:id>
            <ns1:rel>down</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.ScriptLanguage+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:language>
        <ns1:runAsAdmin>false</ns1:runAsAdmin>
        <ns1:timeout>1800</ns1:timeout>
        <ns1:retries>0</ns1:retries>
        <ns1:delay>300</ns1:delay>
        <ns1:errorAction>Abort</ns1:errorAction>
        <ns1:rebootRequired>true</ns1:rebootRequired>
        <ns1:runOnProvisionOnly>false</ns1:runOnProvisionOnly>
    </ns1:pendingAsset>
    <ns1:pendingAsset xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="ns1:Script">
        <ns1:name>MWS2R3 - Avecto - Prereqs</ns1:name>
        <ns1:id>357</ns1:id>
        <ns1:description></ns1:description>
        <ns1:uuid>52ded344-36af-44e1-9503-f7e9308ece2c</ns1:uuid>
        <ns1:assetType>
            <ns1:name>script</ns1:name>
            <ns1:href>assettype/2</ns1:href>
            <ns1:id>2</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.AssetType+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:assetType>
        <ns1:top>false</ns1:top>
        <ns1:assetPath>/Root/MWS2R3_SYD</ns1:assetPath>
        <ns1:detailedAssetPath>/Root:#ID#1:#TYPE#VMContainer/MWS2R3_SYD:#ID#8:#TYPE#VMProject</ns1:detailedAssetPath>
        <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
        <ns1:removable>true</ns1:removable>
        <ns1:domain>
            <ns1:name>domain1</ns1:name>
            <ns1:href>domain/1</ns1:href>
            <ns1:id>1</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Domain+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:domain>
        <ns1:creator>
            <ns1:name>dridley</ns1:name>
            <ns1:href>user/12</ns1:href>
            <ns1:id>12</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.User+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:creator>
        <ns1:created>2015-06-05T15:58:07+10:00</ns1:created>
        <ns1:lockType>0</ns1:lockType>
        <ns1:lastModified>2015-06-12T20:43:03+10:00</ns1:lastModified>
        <ns1:parent>
            <ns1:name>MWS2R3_SYD</ns1:name>
            <ns1:href>project/8</ns1:href>
            <ns1:id>8</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Project+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:parent>
        <ns1:slot>8be72861-4d15-4693-94c1-14d8be290f22</ns1:slot>
        <ns1:version>1</ns1:version>
        <ns1:latest>false</ns1:latest>
        <ns1:publishComment></ns1:publishComment>
        <ns1:slotId>192</ns1:slotId>
        <ns1:publisher>
            <ns1:name>dridley</ns1:name>
            <ns1:href>user/12</ns1:href>
            <ns1:id>12</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.User+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:publisher>
        <ns1:versionStatus>versioned</ns1:versionStatus>
        <ns1:checkoutAllowed>true</ns1:checkoutAllowed>
        <ns1:headAllowed>true</ns1:headAllowed>
        <ns1:operatingSystem>Windows</ns1:operatingSystem>
        <ns1:enableExtensions>false</ns1:enableExtensions>
        <ns1:body># Load Common functions
. .\Logging.ps1
. .\GlobalRepository.ps1
. .\LaunchProcess.ps1
. .\FilesUtility.ps1
. .\PlatformUtils.ps1
. .\UsersUtility.ps1


# get current script location
$scriptPath = split-path -parent $MyInvocation.MyCommand.Definition
$scriptName = $MyInvocation.MyCommand.Name
 
ConfigureLogging $scriptPath $scriptName
 
#########################################################################
# Main
#########################################################################
 
$DomainNetBIOS = 		(get-globalvariable(&quot;Global\DomainNetBIOS&quot;)).value
 

Log &quot;**** Starting: Common Pre-Reqs Config... ****&quot;
Log &quot;`n&quot;


Log &quot;Copy required content locally&quot;		# Will be copied to C:\Users\&lt;profile&gt;
Get-AppFiles &quot;PC Devices\Avecto&quot;
Get-AppFiles &quot;PC Devices\Misc\WindowsFeatures_Prereq&quot;
Log &quot;`n&quot;

Log &quot;Set Timezone...&quot;
tzutil /s &quot;$OS_TIMEZONE&quot;
If ($LastExitCode -ne 0) {Log &quot;ERROR: Timezone could not be set. Possibly due to inability to enumerate variables.&quot;; EXIT 1}
Log &quot;`n&quot;


Log &quot;Installing Windows 2012 Roles (.NET 3.5 - includes .NET 2.0 and 3.0)...&quot;			# .NET 4.0 is already included in the Server SOE
Log &quot;    **KB2966828  |  .NET 3.5 prereq on Win2012 as per KB3005628&quot;
CMD /c Start /WAIT WUSA.exe &quot;$ScriptPath\WindowsFeatures_Prereq\Windows8.1-KB2966828-x64.msu&quot; /quiet /norestart /log:&quot;$env:windir\Debug\ConfigMgr2012\$env:Computername\$env:computername-KB3005628.log&quot;
Log &quot;    **.NET 3.5&quot;
$Feature = Install-WindowsFeature -Name NET-Framework-Core -Source &quot;$ScriptPath\WindowsFeatures_Prereq\sxs&quot; -LogPath &quot;$env:windir\Debug\ConfigMgr2012\$env:Computername\$env:computername-Roles_.NET3.5.log&quot;		# Source switch used for .NET 3.5 only
If (!($Feature.Success)) {Log &quot;ERROR: Failed to install Windows Roles and Features. Exiting...&quot;; EXIT 1}
Log &quot;`n&quot;

Log &quot;Installing Windows 2012 Features (BITS, GPMC, AD Tools)...&quot;
$Feature = Install-WindowsFeature -Name BITS-IIS-Ext,RSAT-Bits-Server,GPMC,RSAT-ADDS-Tools,RSAT-ADLDS -LogPath &quot;$env:windir\Debug\Avecto\$env:Computername\$env:computername-Features.log&quot;
If (!($Feature.Success)) {Log &quot;ERROR: Failed to install Windows Roles and Features. Exiting...&quot;; EXIT 1}
Log &quot;`n&quot;
Start-Sleep -Seconds 30


Log &quot;Define Local Admins...&quot;		# Does not require domain credentials to run
net user /add PCDevices_Admin PCdevices@dmin											# Create local account
AddUserToLocalAdministrators -ServerName &quot;$env:Computername&quot; -UserName &quot;$env:Computername\PCDevices_Admin&quot;
AddUserToLocalAdministrators -ServerName &quot;$env:Computername&quot; -UserName &quot;$DomainNetBIOS\DEL-G-CSC Infrastructure Services&quot;
Log &quot;`n&quot;


Log &quot;Creating User Profile Cleanup Task...&quot;
$SchTasks_Date = (Get-Date).AddDays(5).ToString(&quot;MM/dd/yyyy&quot;)
$ProfPath = $env:UserProfile
# Create Agility User cleanup script
echo &quot;Get-CimInstance win32_userprofile -Verbose | Where {`$_.LocalPath -eq '$ProfPath'} | Remove-CimInstance -Verbose&quot; &gt; $env:windir\Debug\Avecto\Agility-DelProf-$env:USERNAME.ps1
SchTasks /Create /SC &quot;Once&quot; /SD $SchTasks_Date /ST 01:00 /F /RU &quot;SYSTEM&quot; /TN &quot;Agility-DelProf-$env:USERNAME&quot; /TR &quot;Powershell.exe -File '$env:windir\Debug\Avecto\Agility-DelProf-$env:USERNAME.ps1'&quot;
Log &quot;`n&quot;


Log &quot;**** Finished: Common Pre-Reqs Config... ****&quot;</ns1:body>
        <ns1:type>Guest</ns1:type>
        <ns1:language>
            <ns1:name>powershell</ns1:name>
            <ns1:href>scriptlanguage/5</ns1:href>
            <ns1:id>5</ns1:id>
            <ns1:rel>down</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.ScriptLanguage+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:language>
        <ns1:runAsAdmin>false</ns1:runAsAdmin>
        <ns1:timeout>1800</ns1:timeout>
        <ns1:retries>0</ns1:retries>
        <ns1:delay>0</ns1:delay>
        <ns1:errorAction>Abort</ns1:errorAction>
        <ns1:rebootRequired>true</ns1:rebootRequired>
        <ns1:variable>
            <ns1:name>OS_TIMEZONE</ns1:name>
            <ns1:id>1009</ns1:id>
            <ns1:description>Timezone as per &quot;TZUTIL /L&quot;</ns1:description>
            <ns1:uuid>ddd684eb-58a2-4ce4-ade5-e2bce92ebfc4</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath></ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:displayName>OS_TIMEZONE</ns1:displayName>
            <ns1:readable>true</ns1:readable>
            <ns1:writable>true</ns1:writable>
            <ns1:minRequired>1</ns1:minRequired>
            <ns1:maxAllowed>1</ns1:maxAllowed>
            <ns1:validator/>
            <ns1:defaultValue>
                <ns1:id>11159</ns1:id>
                <ns1:name>OS_TIMEZONE</ns1:name>
                <ns1:encrypted>false</ns1:encrypted>
                <ns1:overridable>true</ns1:overridable>
                <ns1:propertyType>
                    <ns1:name>string-any</ns1:name>
                    <ns1:href>/propertytype/4</ns1:href>
                    <ns1:id>4</ns1:id>
                    <ns1:rel>up</ns1:rel>
                    <ns1:type>application/com.servicemesh.agility.api.PropertyType+xml</ns1:type>
                    <ns1:position>0</ns1:position>
                </ns1:propertyType>
                <ns1:propertyDefinition xsi:type="ns1:Link">
                    <ns1:name>OS_TIMEZONE</ns1:name>
                    <ns1:href>/propertydefinition/1009</ns1:href>
                    <ns1:id>1009</ns1:id>
                    <ns1:rel>up</ns1:rel>
                    <ns1:type>application/com.servicemesh.agility.api.PropertyDefinition+xml</ns1:type>
                    <ns1:position>0</ns1:position>
                </ns1:propertyDefinition>
                <ns1:stringValue>AUS Eastern Standard Time</ns1:stringValue>
            </ns1:defaultValue>
            <ns1:propertyType>
                <ns1:name>string-any</ns1:name>
                <ns1:href>propertytype/4</ns1:href>
                <ns1:id>4</ns1:id>
                <ns1:type>application/com.servicemesh.agility.api.PropertyType+xml</ns1:type>
            </ns1:propertyType>
            <ns1:assetPropertyLinkId>1262eba0-6933-489b-9c94-29fafca60ea2</ns1:assetPropertyLinkId>
        </ns1:variable>
        <ns1:runOnProvisionOnly>false</ns1:runOnProvisionOnly>
    </ns1:pendingAsset>
    <ns1:pendingAsset xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="ns1:Script">
        <ns1:name>MWS2R3 - Avecto - Defendpoint Install</ns1:name>
        <ns1:id>356</ns1:id>
        <ns1:description></ns1:description>
        <ns1:uuid>908c8354-35ea-4ceb-bdb4-c35f37ddde47</ns1:uuid>
        <ns1:assetType>
            <ns1:name>script</ns1:name>
            <ns1:href>assettype/2</ns1:href>
            <ns1:id>2</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.AssetType+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:assetType>
        <ns1:top>false</ns1:top>
        <ns1:assetPath>/Root/MWS2R3_SYD</ns1:assetPath>
        <ns1:detailedAssetPath>/Root:#ID#1:#TYPE#VMContainer/MWS2R3_SYD:#ID#8:#TYPE#VMProject</ns1:detailedAssetPath>
        <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
        <ns1:removable>true</ns1:removable>
        <ns1:domain>
            <ns1:name>domain1</ns1:name>
            <ns1:href>domain/1</ns1:href>
            <ns1:id>1</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Domain+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:domain>
        <ns1:creator>
            <ns1:name>dridley</ns1:name>
            <ns1:href>user/12</ns1:href>
            <ns1:id>12</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.User+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:creator>
        <ns1:created>2015-06-05T15:46:11+10:00</ns1:created>
        <ns1:lockType>0</ns1:lockType>
        <ns1:lastModified>2015-06-12T20:43:06+10:00</ns1:lastModified>
        <ns1:parent>
            <ns1:name>MWS2R3_SYD</ns1:name>
            <ns1:href>project/8</ns1:href>
            <ns1:id>8</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Project+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:parent>
        <ns1:slot>7942968e-09bd-4542-8c4f-8908e8b2d36f</ns1:slot>
        <ns1:version>1</ns1:version>
        <ns1:latest>false</ns1:latest>
        <ns1:publishComment></ns1:publishComment>
        <ns1:slotId>193</ns1:slotId>
        <ns1:publisher>
            <ns1:name>dridley</ns1:name>
            <ns1:href>user/12</ns1:href>
            <ns1:id>12</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.User+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:publisher>
        <ns1:versionStatus>versioned</ns1:versionStatus>
        <ns1:checkoutAllowed>true</ns1:checkoutAllowed>
        <ns1:headAllowed>true</ns1:headAllowed>
        <ns1:operatingSystem>Windows</ns1:operatingSystem>
        <ns1:enableExtensions>false</ns1:enableExtensions>
        <ns1:body># Load Common functions
. .\Logging.ps1
. .\GlobalRepository.ps1
. .\LaunchProcess.ps1
. .\FilesUtility.ps1
. .\PlatformUtils.ps1


# get current script location
$scriptPath = split-path -parent $MyInvocation.MyCommand.Definition
$scriptName = $MyInvocation.MyCommand.Name
 
ConfigureLogging $scriptPath $scriptName


#########################################################################
# Main
#########################################################################

#Use ArgList variable in Start-Process commands so embedded variables and env variables resolve


Log &quot;**** Starting: Avecto Defendpoint Install... ****&quot;
Log &quot;`n&quot;

Log &quot;Install Avecto Defendpoint...&quot;
$arglist = &quot;/S /v/qn&quot;
$ret = Start-Process -NoNewWindow -Wait -PassThru -FilePath &quot;$ScriptPath\Defendpoint\DefendpointManagementConsoles_x64.exe&quot; -ArgumentList $arglist
If ($ret.exitcode -ne 0 -And $ret.exitcode -ne 3010) {Log &quot;ERROR: $ret.exitcode - Failed to install Avecto Defendpoint. Exiting...&quot;; EXIT 1}
Log &quot;`n&quot;

Log &quot;**** Finished: Avecto Defendpoint Install... ****&quot;</ns1:body>
        <ns1:type>Guest</ns1:type>
        <ns1:language>
            <ns1:name>powershell</ns1:name>
            <ns1:href>scriptlanguage/5</ns1:href>
            <ns1:id>5</ns1:id>
            <ns1:rel>down</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.ScriptLanguage+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:language>
        <ns1:runAsAdmin>false</ns1:runAsAdmin>
        <ns1:timeout>5400</ns1:timeout>
        <ns1:retries>0</ns1:retries>
        <ns1:delay>300</ns1:delay>
        <ns1:errorAction>Continue</ns1:errorAction>
        <ns1:rebootRequired>true</ns1:rebootRequired>
        <ns1:runOnProvisionOnly>false</ns1:runOnProvisionOnly>
    </ns1:pendingAsset>
    <ns1:pendingAsset xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="ns1:Script">
        <ns1:name>MWS2R3 - Unit Testing</ns1:name>
        <ns1:id>245</ns1:id>
        <ns1:description>Executes unit tests.</ns1:description>
        <ns1:uuid>0675c6bc-c4cc-45cf-aa6e-ed68db0d275c</ns1:uuid>
        <ns1:assetType>
            <ns1:name>script</ns1:name>
            <ns1:href>assettype/2</ns1:href>
            <ns1:id>2</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.AssetType+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:assetType>
        <ns1:top>false</ns1:top>
        <ns1:assetPath>/Root/MWS2R3_SYD</ns1:assetPath>
        <ns1:detailedAssetPath>/Root:#ID#1:#TYPE#VMContainer/MWS2R3_SYD:#ID#8:#TYPE#VMProject</ns1:detailedAssetPath>
        <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
        <ns1:removable>true</ns1:removable>
        <ns1:domain>
            <ns1:name>domain1</ns1:name>
            <ns1:href>domain/1</ns1:href>
            <ns1:id>1</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Domain+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:domain>
        <ns1:creator>
            <ns1:name>dhatchett2</ns1:name>
            <ns1:href>user/8</ns1:href>
            <ns1:id>8</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.User+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:creator>
        <ns1:created>2015-05-26T22:46:49+10:00</ns1:created>
        <ns1:lockType>0</ns1:lockType>
        <ns1:lastModified>2015-05-29T14:31:28+10:00</ns1:lastModified>
        <ns1:parent>
            <ns1:name>MWS2R3_SYD</ns1:name>
            <ns1:href>project/8</ns1:href>
            <ns1:id>8</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Project+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:parent>
        <ns1:slot>b9b4b1fe-d88c-4b70-8a40-7a9cbd5bf7ec</ns1:slot>
        <ns1:version>1</ns1:version>
        <ns1:latest>true</ns1:latest>
        <ns1:publishComment>R3 REL 0.2</ns1:publishComment>
        <ns1:slotId>154</ns1:slotId>
        <ns1:publisher>
            <ns1:name>sskoklev</ns1:name>
            <ns1:href>user/10</ns1:href>
            <ns1:id>10</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.User+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:publisher>
        <ns1:versionStatus>active</ns1:versionStatus>
        <ns1:checkoutAllowed>true</ns1:checkoutAllowed>
        <ns1:headAllowed>false</ns1:headAllowed>
        <ns1:operatingSystem>Windows</ns1:operatingSystem>
        <ns1:enableExtensions>false</ns1:enableExtensions>
        <ns1:body># Script: Unit Testing
# Author: Marina Krynina
#################################################################################################
# \USER_PROFILE
#	  \Test
#        \TestResults
#        \Logs

try
{
    $scriptPath = $env:USERPROFILE
    . .\LoggingV2.ps1 $true $scriptPath &quot;Execute-UnitTest-Server.ps1&quot;
    . .\TestFramework\Execute-UnitTest-Server.ps1 $scriptPath
    exit 0
}
catch
{
    $ex = $_.Exception | format-list | Out-String
    log &quot;ERROR: Exception occurred `nException Message: $ex&quot;

    exit 1
} 
</ns1:body>
        <ns1:type>Guest</ns1:type>
        <ns1:language>
            <ns1:name>powershell</ns1:name>
            <ns1:href>scriptlanguage/5</ns1:href>
            <ns1:id>5</ns1:id>
            <ns1:rel>down</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.ScriptLanguage+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:language>
        <ns1:runAsAdmin>false</ns1:runAsAdmin>
        <ns1:timeout>3600</ns1:timeout>
        <ns1:retries>0</ns1:retries>
        <ns1:delay>0</ns1:delay>
        <ns1:errorAction>Continue</ns1:errorAction>
        <ns1:rebootRequired>false</ns1:rebootRequired>
        <ns1:variable>
            <ns1:name>TESTSCRIPTS</ns1:name>
            <ns1:id>358</ns1:id>
            <ns1:description>&quot;;&quot; delimited string of scripts to execute. No leading &quot;\&quot;.</ns1:description>
            <ns1:uuid>c386d208-7c4a-44b4-8693-a835e80a02aa</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath></ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:displayName>TESTSCRIPTS</ns1:displayName>
            <ns1:readable>true</ns1:readable>
            <ns1:writable>true</ns1:writable>
            <ns1:minRequired>0</ns1:minRequired>
            <ns1:maxAllowed>1</ns1:maxAllowed>
            <ns1:validator/>
            <ns1:defaultValue>
                <ns1:id>4289</ns1:id>
                <ns1:name>TESTSCRIPTS</ns1:name>
                <ns1:encrypted>false</ns1:encrypted>
                <ns1:overridable>true</ns1:overridable>
                <ns1:propertyType>
                    <ns1:name>string-any</ns1:name>
                    <ns1:href>/propertytype/4</ns1:href>
                    <ns1:id>4</ns1:id>
                    <ns1:rel>up</ns1:rel>
                    <ns1:type>application/com.servicemesh.agility.api.PropertyType+xml</ns1:type>
                    <ns1:position>0</ns1:position>
                </ns1:propertyType>
                <ns1:propertyDefinition xsi:type="ns1:Link">
                    <ns1:name>TESTSCRIPTS</ns1:name>
                    <ns1:href>/propertydefinition/358</ns1:href>
                    <ns1:id>358</ns1:id>
                    <ns1:rel>up</ns1:rel>
                    <ns1:type>application/com.servicemesh.agility.api.PropertyDefinition+xml</ns1:type>
                    <ns1:position>0</ns1:position>
                </ns1:propertyDefinition>
                <ns1:stringValue>UnitTest-Server-Common.ps1</ns1:stringValue>
            </ns1:defaultValue>
            <ns1:propertyType>
                <ns1:name>string-any</ns1:name>
                <ns1:href>propertytype/4</ns1:href>
                <ns1:id>4</ns1:id>
                <ns1:type>application/com.servicemesh.agility.api.PropertyType+xml</ns1:type>
            </ns1:propertyType>
            <ns1:assetPropertyLinkId>e3564628-dbe8-4f7c-92f8-0e2f3bdeb4d1</ns1:assetPropertyLinkId>
        </ns1:variable>
        <ns1:variable>
            <ns1:name>ADMIN</ns1:name>
            <ns1:id>359</ns1:id>
            <ns1:description>Domain administrator</ns1:description>
            <ns1:uuid>70e1ad62-5061-4abf-9fe7-46fb1ff7d242</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath></ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:displayName>ADMIN</ns1:displayName>
            <ns1:readable>true</ns1:readable>
            <ns1:writable>true</ns1:writable>
            <ns1:minRequired>0</ns1:minRequired>
            <ns1:maxAllowed>1</ns1:maxAllowed>
            <ns1:validator/>
            <ns1:defaultValue>
                <ns1:id>4290</ns1:id>
                <ns1:name>ADMIN</ns1:name>
                <ns1:encrypted>false</ns1:encrypted>
                <ns1:overridable>true</ns1:overridable>
                <ns1:propertyType>
                    <ns1:name>string-any</ns1:name>
                    <ns1:href>/propertytype/4</ns1:href>
                    <ns1:id>4</ns1:id>
                    <ns1:rel>up</ns1:rel>
                    <ns1:type>application/com.servicemesh.agility.api.PropertyType+xml</ns1:type>
                    <ns1:position>0</ns1:position>
                </ns1:propertyType>
                <ns1:propertyDefinition xsi:type="ns1:Link">
                    <ns1:name>ADMIN</ns1:name>
                    <ns1:href>/propertydefinition/359</ns1:href>
                    <ns1:id>359</ns1:id>
                    <ns1:rel>up</ns1:rel>
                    <ns1:type>application/com.servicemesh.agility.api.PropertyDefinition+xml</ns1:type>
                    <ns1:position>0</ns1:position>
                </ns1:propertyDefinition>
                <ns1:stringValue>agilitydeploy</ns1:stringValue>
            </ns1:defaultValue>
            <ns1:propertyType>
                <ns1:name>string-any</ns1:name>
                <ns1:href>propertytype/4</ns1:href>
                <ns1:id>4</ns1:id>
                <ns1:type>application/com.servicemesh.agility.api.PropertyType+xml</ns1:type>
            </ns1:propertyType>
            <ns1:assetPropertyLinkId>77ee805f-754e-4129-b4f7-82c3b6cd3b35</ns1:assetPropertyLinkId>
        </ns1:variable>
        <ns1:variable>
            <ns1:name>TESTFRAMEWORKFOLDER</ns1:name>
            <ns1:id>360</ns1:id>
            <ns1:description>Folder name where test framework files are stored</ns1:description>
            <ns1:uuid>9f395fff-ab3a-4838-915a-e76f5c0eaa92</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath></ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:displayName>TESTFRAMEWORKFOLDER</ns1:displayName>
            <ns1:readable>true</ns1:readable>
            <ns1:writable>true</ns1:writable>
            <ns1:minRequired>0</ns1:minRequired>
            <ns1:maxAllowed>1</ns1:maxAllowed>
            <ns1:validator/>
            <ns1:defaultValue>
                <ns1:id>4291</ns1:id>
                <ns1:name>TESTFRAMEWORKFOLDER</ns1:name>
                <ns1:encrypted>false</ns1:encrypted>
                <ns1:overridable>true</ns1:overridable>
                <ns1:propertyType>
                    <ns1:name>string-any</ns1:name>
                    <ns1:href>/propertytype/4</ns1:href>
                    <ns1:id>4</ns1:id>
                    <ns1:rel>up</ns1:rel>
                    <ns1:type>application/com.servicemesh.agility.api.PropertyType+xml</ns1:type>
                    <ns1:position>0</ns1:position>
                </ns1:propertyType>
                <ns1:propertyDefinition xsi:type="ns1:Link">
                    <ns1:name>TESTFRAMEWORKFOLDER</ns1:name>
                    <ns1:href>/propertydefinition/360</ns1:href>
                    <ns1:id>360</ns1:id>
                    <ns1:rel>up</ns1:rel>
                    <ns1:type>application/com.servicemesh.agility.api.PropertyDefinition+xml</ns1:type>
                    <ns1:position>0</ns1:position>
                </ns1:propertyDefinition>
                <ns1:stringValue>TestFramework</ns1:stringValue>
            </ns1:defaultValue>
            <ns1:propertyType>
                <ns1:name>string-any</ns1:name>
                <ns1:href>propertytype/4</ns1:href>
                <ns1:id>4</ns1:id>
                <ns1:type>application/com.servicemesh.agility.api.PropertyType+xml</ns1:type>
            </ns1:propertyType>
            <ns1:assetPropertyLinkId>2ef90d52-8de1-4ecd-8e7b-a42ed014d5c4</ns1:assetPropertyLinkId>
        </ns1:variable>
        <ns1:runOnProvisionOnly>false</ns1:runOnProvisionOnly>
    </ns1:pendingAsset>
    <ns1:pendingAsset xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="ns1:Package">
        <ns1:name>MWS2R3 - Avecto Defendpoint</ns1:name>
        <ns1:id>75</ns1:id>
        <ns1:description></ns1:description>
        <ns1:uuid>390e20d7-ba97-4ed1-8047-b1d3539e9015</ns1:uuid>
        <ns1:assetType>
            <ns1:name>package</ns1:name>
            <ns1:href>assettype/3</ns1:href>
            <ns1:id>3</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.AssetType+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:assetType>
        <ns1:top>false</ns1:top>
        <ns1:assetPath>/Root/MWS2R3_SYD</ns1:assetPath>
        <ns1:detailedAssetPath>/Root:#ID#1:#TYPE#VMContainer/MWS2R3_SYD:#ID#8:#TYPE#VMProject</ns1:detailedAssetPath>
        <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
        <ns1:removable>true</ns1:removable>
        <ns1:domain>
            <ns1:name>domain1</ns1:name>
            <ns1:href>domain/1</ns1:href>
            <ns1:id>1</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Domain+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:domain>
        <ns1:creator>
            <ns1:name>dridley</ns1:name>
            <ns1:href>user/12</ns1:href>
            <ns1:id>12</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.User+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:creator>
        <ns1:created>2015-06-05T16:14:04+10:00</ns1:created>
        <ns1:lockType>0</ns1:lockType>
        <ns1:lastModified>2015-07-02T09:57:20+10:00</ns1:lastModified>
        <ns1:parent>
            <ns1:name>MWS2R3_SYD</ns1:name>
            <ns1:href>project/8</ns1:href>
            <ns1:id>8</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Project+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:parent>
        <ns1:version>-1</ns1:version>
        <ns1:latest>false</ns1:latest>
        <ns1:versionStatus>inprogress</ns1:versionStatus>
        <ns1:checkoutAllowed>false</ns1:checkoutAllowed>
        <ns1:headAllowed>false</ns1:headAllowed>
        <ns1:operatingSystem>Windows</ns1:operatingSystem>
        <ns1:install>
            <ns1:name>MWS2R3 - Avecto - Common Prereqs</ns1:name>
            <ns1:href>script/368</ns1:href>
            <ns1:id>386</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Script+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:install>
        <ns1:install>
            <ns1:name>MWS2R3 - Avecto - Defendpoint Install</ns1:name>
            <ns1:href>script/369</ns1:href>
            <ns1:id>389</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Script+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:install>
        <ns1:operational>
            <ns1:name>MWS2R3 - Avecto - Prereqs</ns1:name>
            <ns1:href>script/357</ns1:href>
            <ns1:id>357</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Script+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:operational>
        <ns1:operational>
            <ns1:name>MWS2R3 - Avecto - Defendpoint Install</ns1:name>
            <ns1:href>script/356</ns1:href>
            <ns1:id>356</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Script+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:operational>
        <ns1:operational>
            <ns1:name>MWS2R3 - Unit Testing</ns1:name>
            <ns1:href>script/245</ns1:href>
            <ns1:id>245</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Script+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:operational>
    </ns1:pendingAsset>
    <ns1:pendingAsset xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="ns1:Image">
        <ns1:name>CSC SOE 6.11 Agility Image</ns1:name>
        <ns1:id>3</ns1:id>
        <ns1:uuid>0a9a2ddb-3352-4296-81fc-986c56d68fb6</ns1:uuid>
        <ns1:assetType>
            <ns1:name>image</ns1:name>
            <ns1:href>assettype/19</ns1:href>
            <ns1:id>19</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.AssetType+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:assetType>
        <ns1:top>false</ns1:top>
        <ns1:assetPath></ns1:assetPath>
        <ns1:detailedAssetPath></ns1:detailedAssetPath>
        <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
        <ns1:removable>true</ns1:removable>
        <ns1:architecture>x86_64</ns1:architecture>
        <ns1:imageId>CSC SOE 6.11 Agility Image</ns1:imageId>
        <ns1:cloudType>
            <ns1:name>Microsoft Private Cloud</ns1:name>
            <ns1:href>cloudtype/8</ns1:href>
            <ns1:id>8</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.CloudType+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:cloudType>
        <ns1:cloud>
            <ns1:name>CMWVMMSYD002</ns1:name>
            <ns1:href>cloud/2</ns1:href>
            <ns1:id>2</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Cloud+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:cloud>
        <ns1:location>4ce570c2-0164-4438-aed5-da0284bba2e4</ns1:location>
        <ns1:credentials>
            <ns1:name>smadmin</ns1:name>
            <ns1:id>22</ns1:id>
            <ns1:uuid>37f1a38f-3a69-44cd-a248-8f1287e2b51c</ns1:uuid>
            <ns1:assetType>
                <ns1:name>credential</ns1:name>
                <ns1:href>assettype/26</ns1:href>
                <ns1:id>26</ns1:id>
                <ns1:rel>up</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.AssetType+xml</ns1:type>
                <ns1:position>0</ns1:position>
            </ns1:assetType>
            <ns1:top>false</ns1:top>
            <ns1:assetPath>/Root</ns1:assetPath>
            <ns1:detailedAssetPath>/Root:#ID#1:#TYPE#VMContainer</ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:domain>
                <ns1:name>domain1</ns1:name>
                <ns1:href>domain/1</ns1:href>
                <ns1:id>1</ns1:id>
                <ns1:rel>up</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Domain+xml</ns1:type>
                <ns1:position>0</ns1:position>
            </ns1:domain>
            <ns1:creator>
                <ns1:name>admin</ns1:name>
                <ns1:href>user/1</ns1:href>
                <ns1:id>1</ns1:id>
                <ns1:rel>up</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.User+xml</ns1:type>
                <ns1:position>0</ns1:position>
            </ns1:creator>
            <ns1:created>2015-05-14T21:17:21+10:00</ns1:created>
            <ns1:lockType>0</ns1:lockType>
            <ns1:parent>
                <ns1:name>Root</ns1:name>
                <ns1:href>container/1</ns1:href>
                <ns1:id>1</ns1:id>
                <ns1:rel>up</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Container+xml</ns1:type>
                <ns1:position>0</ns1:position>
            </ns1:parent>
            <ns1:credentialType>Username/Password</ns1:credentialType>
            <ns1:publicKey>4370ad9a3e3eec88f75a08e449eaf430</ns1:publicKey>
            <ns1:privateKey>c28f76c3cc67a39d4be7c8b85b418bf6</ns1:privateKey>
            <ns1:encrypted>true</ns1:encrypted>
        </ns1:credentials>
        <ns1:resources>
            <ns1:name>Base Partition</ns1:name>
            <ns1:id>492</ns1:id>
            <ns1:uuid>4c72c0e7-07b6-4f86-b97c-987cc52a0dfd</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath></ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:applicationType>application/com.servicemesh.agility.api.Resource+xml</ns1:applicationType>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:resourceType>Disk Drive</ns1:resourceType>
            <ns1:units>GB</ns1:units>
            <ns1:quantity>11.0</ns1:quantity>
        </ns1:resources>
        <ns1:resources>
            <ns1:name>Processor</ns1:name>
            <ns1:id>493</ns1:id>
            <ns1:uuid>3dc6b532-2350-4797-9aa7-c9e04341f637</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath></ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:applicationType>application/com.servicemesh.agility.api.Resource+xml</ns1:applicationType>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:resourceType>Processor</ns1:resourceType>
            <ns1:units>Cores</ns1:units>
            <ns1:quantity>2.0</ns1:quantity>
        </ns1:resources>
        <ns1:resources>
            <ns1:name>Memory</ns1:name>
            <ns1:id>494</ns1:id>
            <ns1:uuid>3957db3c-8329-46d6-8667-a8a6b06e1281</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath></ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:applicationType>application/com.servicemesh.agility.api.Resource+xml</ns1:applicationType>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:resourceType>Memory</ns1:resourceType>
            <ns1:units>MB</ns1:units>
            <ns1:quantity>2048.0</ns1:quantity>
        </ns1:resources>
        <ns1:resources xsi:type="ns1:NetworkInterface">
            <ns1:name>Network Adapter</ns1:name>
            <ns1:id>495</ns1:id>
            <ns1:uuid>880a830d-76f6-4584-9b00-db58725e8f82</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath></ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:resourceType>Ethernet Adapter</ns1:resourceType>
            <ns1:quantity>1.0</ns1:quantity>
        </ns1:resources>
        <ns1:mgmtProtocol>winrm-https</ns1:mgmtProtocol>
        <ns1:mgmtPort>5986</ns1:mgmtPort>
        <ns1:properties>
            <ns1:name>StampId</ns1:name>
            <ns1:id>551</ns1:id>
            <ns1:uuid>2922bbd6-2eff-4523-b62d-eb14fbb8d8ba</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath></ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:value>f8ed53cd-60f5-4378-9496-3dc4d8e02065</ns1:value>
            <ns1:overridable>false</ns1:overridable>
            <ns1:encrypted>false</ns1:encrypted>
            <ns1:dataEncrypted>false</ns1:dataEncrypted>
        </ns1:properties>
        <ns1:properties>
            <ns1:name>OSName</ns1:name>
            <ns1:id>552</ns1:id>
            <ns1:uuid>aa078fe7-3eb2-4325-aadd-66a579f8e50f</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath></ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:value>Windows Server 2012 R2 Standard</ns1:value>
            <ns1:overridable>false</ns1:overridable>
            <ns1:encrypted>false</ns1:encrypted>
            <ns1:dataEncrypted>false</ns1:dataEncrypted>
        </ns1:properties>
        <ns1:locations>
            <ns1:name>RSE_Tenant_DEVAUS01</ns1:name>
            <ns1:href>location/1</ns1:href>
            <ns1:id>1</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Location+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:locations>
        <ns1:memoryAddSupported>false</ns1:memoryAddSupported>
        <ns1:memoryRemoveSupported>false</ns1:memoryRemoveSupported>
        <ns1:cpuAddSupported>false</ns1:cpuAddSupported>
        <ns1:cpuRemoveSupported>false</ns1:cpuRemoveSupported>
        <ns1:flagsSynced>true</ns1:flagsSynced>
    </ns1:pendingAsset>
    <ns1:pendingAsset xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="ns1:Stack">
        <ns1:name>CSC SOE 6.11 Agility</ns1:name>
        <ns1:id>4</ns1:id>
        <ns1:description></ns1:description>
        <ns1:uuid>a3defdc2-da21-4b4e-98b9-3705dd107c1e</ns1:uuid>
        <ns1:assetType>
            <ns1:name>stack</ns1:name>
            <ns1:href>assettype/18</ns1:href>
            <ns1:id>18</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.AssetType+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:assetType>
        <ns1:top>false</ns1:top>
        <ns1:Asset xsi:type="ns1:Image">
            <ns1:name>CSC SOE 6.11 Agility Image</ns1:name>
            <ns1:id>3</ns1:id>
            <ns1:uuid>0a9a2ddb-3352-4296-81fc-986c56d68fb6</ns1:uuid>
            <ns1:assetType>
                <ns1:name>image</ns1:name>
                <ns1:href>assettype/19</ns1:href>
                <ns1:id>19</ns1:id>
                <ns1:rel>up</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.AssetType+xml</ns1:type>
                <ns1:position>0</ns1:position>
            </ns1:assetType>
            <ns1:top>false</ns1:top>
            <ns1:assetPath></ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:architecture>x86_64</ns1:architecture>
            <ns1:imageId>CSC SOE 6.11 Agility Image</ns1:imageId>
            <ns1:cloudType>
                <ns1:name>Microsoft Private Cloud</ns1:name>
                <ns1:href>cloudtype/8</ns1:href>
                <ns1:id>8</ns1:id>
                <ns1:rel>up</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.CloudType+xml</ns1:type>
                <ns1:position>0</ns1:position>
            </ns1:cloudType>
            <ns1:cloud>
                <ns1:name>CMWVMMSYD002</ns1:name>
                <ns1:href>cloud/2</ns1:href>
                <ns1:id>2</ns1:id>
                <ns1:rel>up</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Cloud+xml</ns1:type>
                <ns1:position>0</ns1:position>
            </ns1:cloud>
            <ns1:location>4ce570c2-0164-4438-aed5-da0284bba2e4</ns1:location>
            <ns1:credentials>
                <ns1:name>smadmin</ns1:name>
                <ns1:id>22</ns1:id>
                <ns1:uuid>37f1a38f-3a69-44cd-a248-8f1287e2b51c</ns1:uuid>
                <ns1:assetType>
                    <ns1:name>credential</ns1:name>
                    <ns1:href>assettype/26</ns1:href>
                    <ns1:id>26</ns1:id>
                    <ns1:rel>up</ns1:rel>
                    <ns1:type>application/com.servicemesh.agility.api.AssetType+xml</ns1:type>
                    <ns1:position>0</ns1:position>
                </ns1:assetType>
                <ns1:top>false</ns1:top>
                <ns1:assetPath>/Root</ns1:assetPath>
                <ns1:detailedAssetPath>/Root:#ID#1:#TYPE#VMContainer</ns1:detailedAssetPath>
                <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
                <ns1:removable>true</ns1:removable>
                <ns1:domain>
                    <ns1:name>domain1</ns1:name>
                    <ns1:href>domain/1</ns1:href>
                    <ns1:id>1</ns1:id>
                    <ns1:rel>up</ns1:rel>
                    <ns1:type>application/com.servicemesh.agility.api.Domain+xml</ns1:type>
                    <ns1:position>0</ns1:position>
                </ns1:domain>
                <ns1:creator>
                    <ns1:name>admin</ns1:name>
                    <ns1:href>user/1</ns1:href>
                    <ns1:id>1</ns1:id>
                    <ns1:rel>up</ns1:rel>
                    <ns1:type>application/com.servicemesh.agility.api.User+xml</ns1:type>
                    <ns1:position>0</ns1:position>
                </ns1:creator>
                <ns1:created>2015-05-14T21:17:21+10:00</ns1:created>
                <ns1:lockType>0</ns1:lockType>
                <ns1:parent>
                    <ns1:name>Root</ns1:name>
                    <ns1:href>container/1</ns1:href>
                    <ns1:id>1</ns1:id>
                    <ns1:rel>up</ns1:rel>
                    <ns1:type>application/com.servicemesh.agility.api.Container+xml</ns1:type>
                    <ns1:position>0</ns1:position>
                </ns1:parent>
                <ns1:credentialType>Username/Password</ns1:credentialType>
                <ns1:publicKey>4370ad9a3e3eec88f75a08e449eaf430</ns1:publicKey>
                <ns1:privateKey>c28f76c3cc67a39d4be7c8b85b418bf6</ns1:privateKey>
                <ns1:encrypted>true</ns1:encrypted>
            </ns1:credentials>
            <ns1:resources>
                <ns1:name>Base Partition</ns1:name>
                <ns1:id>492</ns1:id>
                <ns1:uuid>4c72c0e7-07b6-4f86-b97c-987cc52a0dfd</ns1:uuid>
                <ns1:top>false</ns1:top>
                <ns1:assetPath></ns1:assetPath>
                <ns1:detailedAssetPath></ns1:detailedAssetPath>
                <ns1:applicationType>application/com.servicemesh.agility.api.Resource+xml</ns1:applicationType>
                <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
                <ns1:removable>true</ns1:removable>
                <ns1:resourceType>Disk Drive</ns1:resourceType>
                <ns1:units>GB</ns1:units>
                <ns1:quantity>11.0</ns1:quantity>
            </ns1:resources>
            <ns1:resources>
                <ns1:name>Processor</ns1:name>
                <ns1:id>493</ns1:id>
                <ns1:uuid>3dc6b532-2350-4797-9aa7-c9e04341f637</ns1:uuid>
                <ns1:top>false</ns1:top>
                <ns1:assetPath></ns1:assetPath>
                <ns1:detailedAssetPath></ns1:detailedAssetPath>
                <ns1:applicationType>application/com.servicemesh.agility.api.Resource+xml</ns1:applicationType>
                <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
                <ns1:removable>true</ns1:removable>
                <ns1:resourceType>Processor</ns1:resourceType>
                <ns1:units>Cores</ns1:units>
                <ns1:quantity>2.0</ns1:quantity>
            </ns1:resources>
            <ns1:resources>
                <ns1:name>Memory</ns1:name>
                <ns1:id>494</ns1:id>
                <ns1:uuid>3957db3c-8329-46d6-8667-a8a6b06e1281</ns1:uuid>
                <ns1:top>false</ns1:top>
                <ns1:assetPath></ns1:assetPath>
                <ns1:detailedAssetPath></ns1:detailedAssetPath>
                <ns1:applicationType>application/com.servicemesh.agility.api.Resource+xml</ns1:applicationType>
                <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
                <ns1:removable>true</ns1:removable>
                <ns1:resourceType>Memory</ns1:resourceType>
                <ns1:units>MB</ns1:units>
                <ns1:quantity>2048.0</ns1:quantity>
            </ns1:resources>
            <ns1:resources xsi:type="ns1:NetworkInterface">
                <ns1:name>Network Adapter</ns1:name>
                <ns1:id>495</ns1:id>
                <ns1:uuid>880a830d-76f6-4584-9b00-db58725e8f82</ns1:uuid>
                <ns1:top>false</ns1:top>
                <ns1:assetPath></ns1:assetPath>
                <ns1:detailedAssetPath></ns1:detailedAssetPath>
                <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
                <ns1:removable>true</ns1:removable>
                <ns1:resourceType>Ethernet Adapter</ns1:resourceType>
                <ns1:quantity>1.0</ns1:quantity>
            </ns1:resources>
            <ns1:mgmtProtocol>winrm-https</ns1:mgmtProtocol>
            <ns1:mgmtPort>5986</ns1:mgmtPort>
            <ns1:properties>
                <ns1:name>StampId</ns1:name>
                <ns1:id>551</ns1:id>
                <ns1:uuid>2922bbd6-2eff-4523-b62d-eb14fbb8d8ba</ns1:uuid>
                <ns1:top>false</ns1:top>
                <ns1:assetPath></ns1:assetPath>
                <ns1:detailedAssetPath></ns1:detailedAssetPath>
                <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
                <ns1:removable>true</ns1:removable>
                <ns1:value>f8ed53cd-60f5-4378-9496-3dc4d8e02065</ns1:value>
                <ns1:overridable>false</ns1:overridable>
                <ns1:encrypted>false</ns1:encrypted>
                <ns1:dataEncrypted>false</ns1:dataEncrypted>
            </ns1:properties>
            <ns1:properties>
                <ns1:name>OSName</ns1:name>
                <ns1:id>552</ns1:id>
                <ns1:uuid>aa078fe7-3eb2-4325-aadd-66a579f8e50f</ns1:uuid>
                <ns1:top>false</ns1:top>
                <ns1:assetPath></ns1:assetPath>
                <ns1:detailedAssetPath></ns1:detailedAssetPath>
                <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
                <ns1:removable>true</ns1:removable>
                <ns1:value>Windows Server 2012 R2 Standard</ns1:value>
                <ns1:overridable>false</ns1:overridable>
                <ns1:encrypted>false</ns1:encrypted>
                <ns1:dataEncrypted>false</ns1:dataEncrypted>
            </ns1:properties>
            <ns1:locations>
                <ns1:name>RSE_Tenant_DEVAUS01</ns1:name>
                <ns1:href>location/1</ns1:href>
                <ns1:id>1</ns1:id>
                <ns1:rel>up</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Location+xml</ns1:type>
                <ns1:position>0</ns1:position>
            </ns1:locations>
            <ns1:memoryAddSupported>false</ns1:memoryAddSupported>
            <ns1:memoryRemoveSupported>false</ns1:memoryRemoveSupported>
            <ns1:cpuAddSupported>false</ns1:cpuAddSupported>
            <ns1:cpuRemoveSupported>false</ns1:cpuRemoveSupported>
            <ns1:flagsSynced>true</ns1:flagsSynced>
        </ns1:Asset>
        <ns1:Asset xsi:type="ns1:Template">
            <ns1:name>template-CSC SOE 6.11 Agility-dff49b9b-6a5d-4e80-966f-f06b15bfb25d</ns1:name>
            <ns1:id>12</ns1:id>
            <ns1:description>Template for Stack: CSC SOE 6.11 Agility</ns1:description>
            <ns1:uuid>dff49b9b-6a5d-4e80-966f-f06b15bfb25d</ns1:uuid>
            <ns1:assetType>
                <ns1:name>template</ns1:name>
                <ns1:href>assettype/20</ns1:href>
                <ns1:id>20</ns1:id>
                <ns1:rel>up</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.AssetType+xml</ns1:type>
                <ns1:position>0</ns1:position>
            </ns1:assetType>
            <ns1:top>false</ns1:top>
            <ns1:assetPath>/Root/MWS2R3_SYD</ns1:assetPath>
            <ns1:detailedAssetPath>/Root:#ID#1:#TYPE#VMContainer/MWS2R3_SYD:#ID#8:#TYPE#VMProject</ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:domain>
                <ns1:name>domain1</ns1:name>
                <ns1:href>domain/1</ns1:href>
                <ns1:id>1</ns1:id>
                <ns1:rel>up</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Domain+xml</ns1:type>
                <ns1:position>0</ns1:position>
            </ns1:domain>
            <ns1:creator>
                <ns1:name>admin</ns1:name>
                <ns1:href>user/1</ns1:href>
                <ns1:id>1</ns1:id>
                <ns1:rel>up</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.User+xml</ns1:type>
                <ns1:position>0</ns1:position>
            </ns1:creator>
            <ns1:created>2015-05-14T21:17:21+10:00</ns1:created>
            <ns1:lockType>0</ns1:lockType>
            <ns1:parent>
                <ns1:name>MWS2R3_SYD</ns1:name>
                <ns1:href>project/8</ns1:href>
                <ns1:id>8</ns1:id>
                <ns1:rel>up</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Project+xml</ns1:type>
                <ns1:position>0</ns1:position>
            </ns1:parent>
            <ns1:numInstances>0</ns1:numInstances>
            <ns1:topology>
                <ns1:name>MWS2R3_SYD</ns1:name>
                <ns1:href>topology/8</ns1:href>
                <ns1:id>8</ns1:id>
                <ns1:rel>up</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Topology+xml</ns1:type>
                <ns1:position>0</ns1:position>
            </ns1:topology>
            <ns1:factory>true</ns1:factory>
            <ns1:stack>
                <ns1:name>CSC SOE 6.11 Agility</ns1:name>
                <ns1:href>stack/4</ns1:href>
                <ns1:id>4</ns1:id>
                <ns1:rel>up</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Stack+xml</ns1:type>
                <ns1:position>0</ns1:position>
            </ns1:stack>
            <ns1:onboarded>false</ns1:onboarded>
            <ns1:releaseDisks>false</ns1:releaseDisks>
            <ns1:stats>
                <ns1:templateId>12</ns1:templateId>
                <ns1:numUnknown>0</ns1:numUnknown>
                <ns1:numStarting>0</ns1:numStarting>
                <ns1:numRunning>0</ns1:numRunning>
                <ns1:numPaused>0</ns1:numPaused>
                <ns1:numStopping>0</ns1:numStopping>
                <ns1:numStopped>0</ns1:numStopped>
                <ns1:numDestroyed>0</ns1:numDestroyed>
                <ns1:numFailed>0</ns1:numFailed>
                <ns1:numDegraded>0</ns1:numDegraded>
                <ns1:numInstances>0</ns1:numInstances>
                <ns1:minCount>0</ns1:minCount>
                <ns1:maxCount>0</ns1:maxCount>
                <ns1:status>Unknown</ns1:status>
            </ns1:stats>
        </ns1:Asset>
        <ns1:Asset xsi:type="ns1:TargetCloud">
            <ns1:name>CSC SOE 6.11 Agility-CMWVMMSYD002</ns1:name>
            <ns1:id>3</ns1:id>
            <ns1:description>CSC SOE 6.11 Agility-CMWVMMSYD002: </ns1:description>
            <ns1:uuid>994ab9dc-7d5e-4df7-8053-56767b7acfb5</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:Asset xsi:type="ns1:Template">
                <ns1:name>CSC SOE 6.11 Agility-CMWVMMSYD002</ns1:name>
                <ns1:id>13</ns1:id>
                <ns1:description>CSC SOE 6.11 Agility-CMWVMMSYD002: </ns1:description>
                <ns1:uuid>ba4bb31f-468a-48fe-a1d4-f50bdfb0be2f</ns1:uuid>
                <ns1:assetType>
                    <ns1:name>template</ns1:name>
                    <ns1:href>assettype/20</ns1:href>
                    <ns1:id>20</ns1:id>
                    <ns1:rel>up</ns1:rel>
                    <ns1:type>application/com.servicemesh.agility.api.AssetType+xml</ns1:type>
                    <ns1:position>0</ns1:position>
                </ns1:assetType>
                <ns1:top>false</ns1:top>
                <ns1:assetPath>/Root/MWS2R3_SYD</ns1:assetPath>
                <ns1:detailedAssetPath>/Root:#ID#1:#TYPE#VMContainer/MWS2R3_SYD:#ID#8:#TYPE#VMProject</ns1:detailedAssetPath>
                <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
                <ns1:removable>true</ns1:removable>
                <ns1:domain>
                    <ns1:name>domain1</ns1:name>
                    <ns1:href>domain/1</ns1:href>
                    <ns1:id>1</ns1:id>
                    <ns1:rel>up</ns1:rel>
                    <ns1:type>application/com.servicemesh.agility.api.Domain+xml</ns1:type>
                    <ns1:position>0</ns1:position>
                </ns1:domain>
                <ns1:creator>
                    <ns1:name>admin</ns1:name>
                    <ns1:href>user/1</ns1:href>
                    <ns1:id>1</ns1:id>
                    <ns1:rel>up</ns1:rel>
                    <ns1:type>application/com.servicemesh.agility.api.User+xml</ns1:type>
                    <ns1:position>0</ns1:position>
                </ns1:creator>
                <ns1:created>2015-05-14T21:17:21+10:00</ns1:created>
                <ns1:lockType>0</ns1:lockType>
                <ns1:parent>
                    <ns1:name>MWS2R3_SYD</ns1:name>
                    <ns1:href>project/8</ns1:href>
                    <ns1:id>8</ns1:id>
                    <ns1:rel>up</ns1:rel>
                    <ns1:type>application/com.servicemesh.agility.api.Project+xml</ns1:type>
                    <ns1:position>0</ns1:position>
                </ns1:parent>
                <ns1:numInstances>1</ns1:numInstances>
                <ns1:topology>
                    <ns1:name>MWS2R3_SYD</ns1:name>
                    <ns1:href>topology/8</ns1:href>
                    <ns1:id>8</ns1:id>
                    <ns1:rel>up</ns1:rel>
                    <ns1:type>application/com.servicemesh.agility.api.Topology+xml</ns1:type>
                    <ns1:position>0</ns1:position>
                </ns1:topology>
                <ns1:cloud>
                    <ns1:name>CMWVMMSYD002</ns1:name>
                    <ns1:href>cloud/2</ns1:href>
                    <ns1:id>2</ns1:id>
                    <ns1:rel>up</ns1:rel>
                    <ns1:type>application/com.servicemesh.agility.api.Cloud+xml</ns1:type>
                    <ns1:position>0</ns1:position>
                </ns1:cloud>
                <ns1:factory>true</ns1:factory>
                <ns1:stack>
                    <ns1:name>CSC SOE 6.11 Agility</ns1:name>
                    <ns1:href>stack/4</ns1:href>
                    <ns1:id>4</ns1:id>
                    <ns1:rel>up</ns1:rel>
                    <ns1:type>application/com.servicemesh.agility.api.Stack+xml</ns1:type>
                    <ns1:position>0</ns1:position>
                </ns1:stack>
                <ns1:image>
                    <ns1:name>CSC SOE 6.11 Agility Image</ns1:name>
                    <ns1:href>image/3</ns1:href>
                    <ns1:id>3</ns1:id>
                    <ns1:rel>up</ns1:rel>
                    <ns1:type>application/com.servicemesh.agility.api.Image+xml</ns1:type>
                    <ns1:position>0</ns1:position>
                </ns1:image>
                <ns1:model>Gen1 1 CPU 2 GB HA</ns1:model>
                <ns1:location>RSE_Tenant_DEVAUS01</ns1:location>
                <ns1:credential>
                    <ns1:name>DEVRAUS001-Key</ns1:name>
                    <ns1:id>5</ns1:id>
                    <ns1:description></ns1:description>
                    <ns1:uuid>59ce4b0b-96f4-417e-ae2f-72743006697f</ns1:uuid>
                    <ns1:assetType>
                        <ns1:name>credential</ns1:name>
                        <ns1:href>assettype/26</ns1:href>
                        <ns1:id>26</ns1:id>
                        <ns1:rel>up</ns1:rel>
                        <ns1:type>application/com.servicemesh.agility.api.AssetType+xml</ns1:type>
                        <ns1:position>0</ns1:position>
                    </ns1:assetType>
                    <ns1:top>false</ns1:top>
                    <ns1:assetPath>/Root/MWS2R3_SYD</ns1:assetPath>
                    <ns1:detailedAssetPath>/Root:#ID#1:#TYPE#VMContainer/MWS2R3_SYD:#ID#8:#TYPE#VMProject</ns1:detailedAssetPath>
                    <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
                    <ns1:removable>true</ns1:removable>
                    <ns1:domain>
                        <ns1:name>domain1</ns1:name>
                        <ns1:href>domain/1</ns1:href>
                        <ns1:id>1</ns1:id>
                        <ns1:rel>up</ns1:rel>
                        <ns1:type>application/com.servicemesh.agility.api.Domain+xml</ns1:type>
                        <ns1:position>0</ns1:position>
                    </ns1:domain>
                    <ns1:creator>
                        <ns1:name>admin</ns1:name>
                        <ns1:href>user/1</ns1:href>
                        <ns1:id>1</ns1:id>
                        <ns1:rel>up</ns1:rel>
                        <ns1:type>application/com.servicemesh.agility.api.User+xml</ns1:type>
                        <ns1:position>0</ns1:position>
                    </ns1:creator>
                    <ns1:created>2015-05-14T14:28:03+10:00</ns1:created>
                    <ns1:lockType>0</ns1:lockType>
                    <ns1:lastModified>2015-05-14T14:28:03+10:00</ns1:lastModified>
                    <ns1:parent>
                        <ns1:name>MWS2R3_SYD</ns1:name>
                        <ns1:href>project/8</ns1:href>
                        <ns1:id>8</ns1:id>
                        <ns1:rel>up</ns1:rel>
                        <ns1:type>application/com.servicemesh.agility.api.Project+xml</ns1:type>
                        <ns1:position>0</ns1:position>
                    </ns1:parent>
                    <ns1:credentialType>SSH</ns1:credentialType>
                    <ns1:publicKey>3a307f2660ba16e026a2acc9a7bcdd5bf8304b8cfc4fb301827cdddd52a87daa7d23e8cbebbee927c7e30d9250e66044bafe1c4bb6994931457f100617f2bac48557ca49c86c67116f5b1d800530aef36d89013ae5b3ba5d313e4a5006fb13a2b60fb915ef5c74a0607a14933b354be552e4ff82a31daf8e5027ddc2e02d95d8a83c3f939d1307f8d244bef12b4154bef8501e4df352c2344c657fac59dda4399f2c31713c539d27c4ade17030dbd9a8e6d9596db5664532c734362682ad1c0468b8282931edd24c17c2febc67c8e33b479d4c3ec952c83dcd7500e57ae2b892cc555fb1f60ea359a2a37e5a2927e71b89409c29a3c7db06c1309803c6bf3026c821a024c855ed2813e8b9c853c669ed0e46b24322bed3ac984d32304fc55ebf63e15f2cc57e864a936a5fc6f355dfe6398d80d86d4c7eb0a45f38b8ac53293348ca3a5ef45574473c52848aad1313913670ab9905cb844d081215e0abddefc9336e9e424a3eb2c6a4f687e6361c4caea96bba250c34a68f0206fd201730a25b455ceb0dd05a08ef373a1eac8d4476ba</ns1:publicKey>
                    <ns1:privateKey>1a421c2020f5be41f08092ae923b48f230817b66d53c1c5a4beaf763275e846753d9ac822059893b912c346cb735abf7727169bbf4ef16f9341da773ccd42f3d389acb7d44d4f8d54df89cc5d6b7d8073aed5b0e325e4e497ff853371a9c9bf52a2a5797276b7469cb64bb3b24c17a8b497d5373c7d02d9c17e73b6d4964592e08a9e9260bad10cdec327e93e0056306d977e2d6a7ecfc778f3c7c720a68f7a39f79cb1154a64664c3af0b01b680bfe257f7e0ce4804b12e15a9855bfbfb238bd540da99a23e5c0d105f61a33b25106e9fcb30a3e712680dc3d76b81921a7d8e5392e245e7f2fb35b2f2cc3c6a313c943a64a74be953967855d28d81e853b626f03e1ccea8f579470c4865fb7d9aeb0bcb50d06f05c5ddb6f52847dec5ee79c7079f1fe598c1e7f2c63c36b4568665236fabca3dd79db22015fb4adaadc6d7514fdadd7331635deb31843ebc3412c4453e28de4386a103a353b54335c98953fc1f7cee1157e34fa092fe68eac5e0b2ec2e553640fc96414b88cb713a037649dcf7a317d21bbc233a0249f1509bdbcd81965f4d0eb0613ab1d4f3f0470d91b1994b631f73923f74fbfa770454d2496e3544877ece7e997bd93ee4d705b5c34de15c41a792387d5c32e7439cfc4ae663b1996e66aac95194b9abc0eb964f98757df4acc06af07206cf76639f33fbd4eb97e5a69329e364b9c997cba06da1c7eca0a7bf46c7c6e5be8200a9adb67c270b27a6a3ab8c90b8460d281620e8aba28a2454ab924030535a5f4461ee466b817e1024a23c19b2b7059a1eed16a7b85b01b28b268e914bb8fbeb153fc6e9a25c4cab190a3844ee90e46a05cf774761fbb6ef1693d9ff49c6fcf744d99bd14b2658f7dda27cb9b10d8a1935bb39affa8da0ee47e4797427e2ff20577ea61deef581e51d854a3c58ccf916c95c9ed65a923d53c27857b8a0d64cb227ec28919a527ea1669c4d7b62b39afb3b8cf48b29c5c01dd6d93924fcc4a558e6ec6797b68e7e4bb38949265a666bbb2aa0b1b812b75dd05d0712e82d68572929a8d2fe98c8da65dfd89c59b8f82d870ba705a053fc615bb9bac3bf5cece4a377d269a1ad4509579952f031348e4629910cc5feb25d302cda1dfa4842843d66cc9d8e4d8f0c12ae7ed0cf54b8b64faa80488706c0ae86078fc6ce8ee6cdf741eaa731390009103e998be60cdd2843aa2266cd3ccccfdad7395fe716d21287841ab315847c1dbea229546c9dc140fb06ce7c259e2e139d8545c9e411e6f6ce439798e95351efbf6e41c4eb3e06ddb15c4ed6054a28fd08341e4d4f1f3e878d5d892284de762f59f4200ef7e9e4558e6637e9696307a9179f0f680c821ae4e43ac7d1102c1aa1aca21968b8be7b359b8bd7e14f99cd1b10383a872e4d12b13a88ad52d09856368a58e49940144e7ae2b8691eeb25ccffc958a9aafdd57034035fc37f325415cf50fa3cb58f2d8d6bbde12851e40fe0645ce51529eadca8f921546292d8f6c5c4d32c316a640a02b6ff48b5adc5e72e91fcb45ea60d16f51412f684d988e7aa18683f25529865e6e3571324472672149ab6e6afe5aaeba6e553d6cdf2c75773df9581adfdbc0b668908e31c497de0a96b191751e07845e8c3b42e7a481fae19cf8310433620bbd63b9bd97bf8f81ebd49e49b2b85235de157530390d1d786a0538df26bec63ae7048f03170dc16d8ac95120f49442b6419473033ec6536098a3685cfba6a63243d666f032651e82fa68f8d20b59799b19a421bc80c5d379c25fe6f2a89e00fa8c088e920ee09afe5a7279f3df148a67c954f1dcee79368344d6045f5a11076a86cf0faeb8e1df8ada818e7532afd7c7cb54904b62b207e021172f281bd1963ed322c36a5c781d624f80857969b6ab0787692dc5fcda4faa6452fe9a4c166989daf6fa900fd5edbcf00adbbfed71937f8f16f412084f2d955702fbe8bc9bf96f147dc8c318866efcd71ada41d494f884869d9e76e130d0e69319a1a828cdf809ac884038c5ea43b19fa7d697a34170a10853ecdda6259e24582d35d459c18654730b2c755868743d9bcc2b3cbc77257223ef1c1e4321c858903fff39c1bc5affbf98f6722fc10e49b157ea9eda69708832c31781d6c1617dcb9bfc7c9784c11db45f34b45c21d01ac2bee8dd5128d6b9eebd55b0db52b72a1206a677e9e801768fcc71156100444b0857f618d52a29546d19e88067f8fe6277e0a1c126abf63454d0d87de2ac86293b33261883c404e76bee7f2b714695525f5d0315ec7301991b55cffdbb6431096ee3cd33dc5d7aa495d5b9eea5729e3fd4a2367fed9da58073f6593e9a6d946188b4404623e52b960dc99604fb5a035a6086f807a</ns1:privateKey>
                    <ns1:encrypted>true</ns1:encrypted>
                    <ns1:cloud>
                        <ns1:name>CMWVMMSYD002</ns1:name>
                        <ns1:id>2</ns1:id>
                        <ns1:description></ns1:description>
                        <ns1:uuid>b0cdd3f1-f6e7-49ac-8331-7455a41296e1</ns1:uuid>
                        <ns1:top>false</ns1:top>
                        <ns1:cloudType>
                            <ns1:name>Microsoft Private Cloud</ns1:name>
                            <ns1:href>cloudtype/8</ns1:href>
                            <ns1:id>8</ns1:id>
                            <ns1:rel>up</ns1:rel>
                            <ns1:type>application/com.servicemesh.agility.api.CloudType+xml</ns1:type>
                            <ns1:position>0</ns1:position>
                        </ns1:cloudType>
                    </ns1:cloud>
                </ns1:credential>
                <ns1:resources>
                    <ns1:name>40 GB</ns1:name>
                    <ns1:id>506</ns1:id>
                    <ns1:uuid>965db90f-5fda-46dc-8069-b56feeb4a279</ns1:uuid>
                    <ns1:top>false</ns1:top>
                    <ns1:assetPath></ns1:assetPath>
                    <ns1:detailedAssetPath></ns1:detailedAssetPath>
                    <ns1:applicationType>application/com.servicemesh.agility.api.Resource+xml</ns1:applicationType>
                    <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
                    <ns1:removable>true</ns1:removable>
                    <ns1:resourceType>Disk Drive</ns1:resourceType>
                    <ns1:units>GB</ns1:units>
                    <ns1:quantity>40.0</ns1:quantity>
                </ns1:resources>
                <ns1:resources xsi:type="ns1:NetworkInterface">
                    <ns1:name>Network Adapter</ns1:name>
                    <ns1:id>696</ns1:id>
                    <ns1:uuid>cf99fb77-72c1-41e5-977c-de149f84aa80</ns1:uuid>
                    <ns1:top>false</ns1:top>
                    <ns1:assetPath></ns1:assetPath>
                    <ns1:detailedAssetPath></ns1:detailedAssetPath>
                    <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
                    <ns1:removable>true</ns1:removable>
                    <ns1:resourceType>Ethernet Adapter</ns1:resourceType>
                    <ns1:quantity>1.0</ns1:quantity>
                    <ns1:hostResource>RSE_Tenant_1101</ns1:hostResource>
                    <ns1:network>
                        <ns1:name>RSE_Tenant_1101</ns1:name>
                        <ns1:href>network/2</ns1:href>
                        <ns1:id>2</ns1:id>
                        <ns1:rel>up</ns1:rel>
                        <ns1:type>application/com.servicemesh.agility.api.Network+xml</ns1:type>
                        <ns1:position>0</ns1:position>
                    </ns1:network>
                </ns1:resources>
                <ns1:resources>
                    <ns1:name>Base Partition</ns1:name>
                    <ns1:id>492</ns1:id>
                    <ns1:uuid>4c72c0e7-07b6-4f86-b97c-987cc52a0dfd</ns1:uuid>
                    <ns1:top>false</ns1:top>
                    <ns1:assetPath></ns1:assetPath>
                    <ns1:detailedAssetPath></ns1:detailedAssetPath>
                    <ns1:applicationType>application/com.servicemesh.agility.api.Resource+xml</ns1:applicationType>
                    <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
                    <ns1:removable>true</ns1:removable>
                    <ns1:resourceType>Disk Drive</ns1:resourceType>
                    <ns1:units>GB</ns1:units>
                    <ns1:quantity>11.0</ns1:quantity>
                </ns1:resources>
                <ns1:resources>
                    <ns1:name>2048 MB</ns1:name>
                    <ns1:id>505</ns1:id>
                    <ns1:uuid>90244b7d-9bb4-47fc-b4d7-9e4243c8a30e</ns1:uuid>
                    <ns1:top>false</ns1:top>
                    <ns1:assetPath></ns1:assetPath>
                    <ns1:detailedAssetPath></ns1:detailedAssetPath>
                    <ns1:applicationType>application/com.servicemesh.agility.api.Resource+xml</ns1:applicationType>
                    <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
                    <ns1:removable>true</ns1:removable>
                    <ns1:resourceType>Memory</ns1:resourceType>
                    <ns1:units>MB</ns1:units>
                    <ns1:quantity>2048.0</ns1:quantity>
                </ns1:resources>
                <ns1:resources>
                    <ns1:name>1 VCPU</ns1:name>
                    <ns1:id>504</ns1:id>
                    <ns1:uuid>09c080d4-34e8-4e4a-9313-796759399d16</ns1:uuid>
                    <ns1:top>false</ns1:top>
                    <ns1:assetPath></ns1:assetPath>
                    <ns1:detailedAssetPath></ns1:detailedAssetPath>
                    <ns1:applicationType>application/com.servicemesh.agility.api.Resource+xml</ns1:applicationType>
                    <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
                    <ns1:removable>true</ns1:removable>
                    <ns1:resourceType>Processor</ns1:resourceType>
                    <ns1:units>VCPU</ns1:units>
                    <ns1:quantity>1.0</ns1:quantity>
                </ns1:resources>
                <ns1:onboarded>false</ns1:onboarded>
                <ns1:project>
                    <ns1:name>MWS2R3_SYD</ns1:name>
                    <ns1:href>project/8</ns1:href>
                    <ns1:id>8</ns1:id>
                    <ns1:rel>up</ns1:rel>
                    <ns1:type>application/com.servicemesh.agility.api.Project+xml</ns1:type>
                    <ns1:position>0</ns1:position>
                </ns1:project>
                <ns1:releaseDisks>false</ns1:releaseDisks>
                <ns1:stats>
                    <ns1:templateId>13</ns1:templateId>
                    <ns1:numUnknown>0</ns1:numUnknown>
                    <ns1:numStarting>0</ns1:numStarting>
                    <ns1:numRunning>0</ns1:numRunning>
                    <ns1:numPaused>0</ns1:numPaused>
                    <ns1:numStopping>0</ns1:numStopping>
                    <ns1:numStopped>0</ns1:numStopped>
                    <ns1:numDestroyed>0</ns1:numDestroyed>
                    <ns1:numFailed>0</ns1:numFailed>
                    <ns1:numDegraded>0</ns1:numDegraded>
                    <ns1:numInstances>0</ns1:numInstances>
                    <ns1:minCount>1</ns1:minCount>
                    <ns1:maxCount>1</ns1:maxCount>
                    <ns1:status>Unknown</ns1:status>
                </ns1:stats>
            </ns1:Asset>
            <ns1:assetPath></ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:cloud>
                <ns1:name>CMWVMMSYD002</ns1:name>
                <ns1:href>cloud/2</ns1:href>
                <ns1:id>2</ns1:id>
                <ns1:rel>up</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Cloud+xml</ns1:type>
                <ns1:position>0</ns1:position>
            </ns1:cloud>
            <ns1:stack>
                <ns1:name>CSC SOE 6.11 Agility</ns1:name>
                <ns1:href>stack/4</ns1:href>
                <ns1:id>4</ns1:id>
                <ns1:rel>up</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Stack+xml</ns1:type>
                <ns1:position>0</ns1:position>
            </ns1:stack>
            <ns1:template>
                <ns1:name>CSC SOE 6.11 Agility-CMWVMMSYD002</ns1:name>
                <ns1:href>template/13</ns1:href>
                <ns1:id>13</ns1:id>
                <ns1:rel>up</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Template+xml</ns1:type>
                <ns1:position>0</ns1:position>
            </ns1:template>
            <ns1:models>
                <ns1:name>Gen1 1 CPU 2 GB HA</ns1:name>
                <ns1:href>model/72</ns1:href>
                <ns1:id>72</ns1:id>
                <ns1:rel>up</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Model+xml</ns1:type>
                <ns1:position>0</ns1:position>
            </ns1:models>
            <ns1:models>
                <ns1:name>Gen1 8 CPU 16 GB HA</ns1:name>
                <ns1:href>model/73</ns1:href>
                <ns1:id>73</ns1:id>
                <ns1:rel>up</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Model+xml</ns1:type>
                <ns1:position>0</ns1:position>
            </ns1:models>
            <ns1:models>
                <ns1:name>Gen1 2 CPU 4 GB HA</ns1:name>
                <ns1:href>model/74</ns1:href>
                <ns1:id>74</ns1:id>
                <ns1:rel>up</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Model+xml</ns1:type>
                <ns1:position>0</ns1:position>
            </ns1:models>
            <ns1:models>
                <ns1:name>Gen1 2 CPU 2 GB HA</ns1:name>
                <ns1:href>model/75</ns1:href>
                <ns1:id>75</ns1:id>
                <ns1:rel>up</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Model+xml</ns1:type>
                <ns1:position>0</ns1:position>
            </ns1:models>
            <ns1:models>
                <ns1:name>Gen1 4 CPU 8 GB HA</ns1:name>
                <ns1:href>model/76</ns1:href>
                <ns1:id>76</ns1:id>
                <ns1:rel>up</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Model+xml</ns1:type>
                <ns1:position>0</ns1:position>
            </ns1:models>
            <ns1:models>
                <ns1:name>Gen1 4 CPU 16 GB HA</ns1:name>
                <ns1:href>model/77</ns1:href>
                <ns1:id>77</ns1:id>
                <ns1:rel>up</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Model+xml</ns1:type>
                <ns1:position>0</ns1:position>
            </ns1:models>
            <ns1:models>
                <ns1:name>Gen1 4 CPU 4 GB HA</ns1:name>
                <ns1:href>model/78</ns1:href>
                <ns1:id>78</ns1:id>
                <ns1:rel>up</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Model+xml</ns1:type>
                <ns1:position>0</ns1:position>
            </ns1:models>
            <ns1:maxInstances>1</ns1:maxInstances>
        </ns1:Asset>
        <ns1:assetPath>/Root/MWS2R3_SYD</ns1:assetPath>
        <ns1:detailedAssetPath>/Root:#ID#1:#TYPE#VMContainer/MWS2R3_SYD:#ID#8:#TYPE#VMProject</ns1:detailedAssetPath>
        <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
        <ns1:removable>true</ns1:removable>
        <ns1:domain>
            <ns1:name>domain1</ns1:name>
            <ns1:href>domain/1</ns1:href>
            <ns1:id>1</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Domain+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:domain>
        <ns1:creator>
            <ns1:name>admin</ns1:name>
            <ns1:href>user/1</ns1:href>
            <ns1:id>1</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.User+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:creator>
        <ns1:created>2015-05-14T21:17:21+10:00</ns1:created>
        <ns1:lockType>0</ns1:lockType>
        <ns1:lastModified>2015-05-29T14:01:54+10:00</ns1:lastModified>
        <ns1:policyAssignment>
            <ns1:name>Instance Provision</ns1:name>
            <ns1:id>1</ns1:id>
            <ns1:uuid>756c1984-8259-11e4-96fc-005056952d4b</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath>/Root</ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:applyToSelf>false</ns1:applyToSelf>
            <ns1:applyChildrenDepth>0</ns1:applyChildrenDepth>
            <ns1:allowChildrenOverride>false</ns1:allowChildrenOverride>
            <ns1:policy xsi:type="ns1:VersionedItemLink">
                <ns1:name>Instance Provision</ns1:name>
                <ns1:href>policy/44</ns1:href>
                <ns1:id>44</ns1:id>
                <ns1:rel>down</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Policy+xml</ns1:type>
                <ns1:position>0</ns1:position>
                <ns1:slot>#INSTANCE-PROVISION#</ns1:slot>
                <ns1:version>1</ns1:version>
                <ns1:latest>true</ns1:latest>
                <ns1:slotId>92</ns1:slotId>
                <ns1:versionStatus>active</ns1:versionStatus>
                <ns1:lockType>0</ns1:lockType>
            </ns1:policy>
            <ns1:policyTypeName>Workflow</ns1:policyTypeName>
            <ns1:itemClass>VMContainer</ns1:itemClass>
            <ns1:itemId>1</ns1:itemId>
            <ns1:itemName>Root</ns1:itemName>
        </ns1:policyAssignment>
        <ns1:policyAssignment>
            <ns1:name>Instance Start</ns1:name>
            <ns1:id>2</ns1:id>
            <ns1:uuid>756c76c2-8259-11e4-96fc-005056952d4b</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath>/Root</ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:applyToSelf>false</ns1:applyToSelf>
            <ns1:applyChildrenDepth>0</ns1:applyChildrenDepth>
            <ns1:allowChildrenOverride>false</ns1:allowChildrenOverride>
            <ns1:policy xsi:type="ns1:VersionedItemLink">
                <ns1:name>Instance Start</ns1:name>
                <ns1:href>policy/45</ns1:href>
                <ns1:id>45</ns1:id>
                <ns1:rel>down</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Policy+xml</ns1:type>
                <ns1:position>0</ns1:position>
                <ns1:slot>#INSTANCE-START#</ns1:slot>
                <ns1:version>1</ns1:version>
                <ns1:latest>true</ns1:latest>
                <ns1:slotId>93</ns1:slotId>
                <ns1:versionStatus>active</ns1:versionStatus>
                <ns1:lockType>0</ns1:lockType>
            </ns1:policy>
            <ns1:policyTypeName>Workflow</ns1:policyTypeName>
            <ns1:itemClass>VMContainer</ns1:itemClass>
            <ns1:itemId>1</ns1:itemId>
            <ns1:itemName>Root</ns1:itemName>
        </ns1:policyAssignment>
        <ns1:policyAssignment>
            <ns1:name>Instance Stop</ns1:name>
            <ns1:id>3</ns1:id>
            <ns1:uuid>756ccc30-8259-11e4-96fc-005056952d4b</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath>/Root</ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:applyToSelf>false</ns1:applyToSelf>
            <ns1:applyChildrenDepth>0</ns1:applyChildrenDepth>
            <ns1:allowChildrenOverride>false</ns1:allowChildrenOverride>
            <ns1:policy xsi:type="ns1:VersionedItemLink">
                <ns1:name>Instance Stop</ns1:name>
                <ns1:href>policy/46</ns1:href>
                <ns1:id>46</ns1:id>
                <ns1:rel>down</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Policy+xml</ns1:type>
                <ns1:position>0</ns1:position>
                <ns1:slot>#INSTANCE-STOP#</ns1:slot>
                <ns1:version>1</ns1:version>
                <ns1:latest>true</ns1:latest>
                <ns1:slotId>94</ns1:slotId>
                <ns1:versionStatus>active</ns1:versionStatus>
                <ns1:lockType>0</ns1:lockType>
            </ns1:policy>
            <ns1:policyTypeName>Workflow</ns1:policyTypeName>
            <ns1:itemClass>VMContainer</ns1:itemClass>
            <ns1:itemId>1</ns1:itemId>
            <ns1:itemName>Root</ns1:itemName>
        </ns1:policyAssignment>
        <ns1:policyAssignment>
            <ns1:name>Topology Start</ns1:name>
            <ns1:id>4</ns1:id>
            <ns1:uuid>756d25a4-8259-11e4-96fc-005056952d4b</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath>/Root</ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:applyToSelf>false</ns1:applyToSelf>
            <ns1:applyChildrenDepth>0</ns1:applyChildrenDepth>
            <ns1:allowChildrenOverride>false</ns1:allowChildrenOverride>
            <ns1:policy xsi:type="ns1:VersionedItemLink">
                <ns1:name>Topology Start</ns1:name>
                <ns1:href>policy/47</ns1:href>
                <ns1:id>47</ns1:id>
                <ns1:rel>down</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Policy+xml</ns1:type>
                <ns1:position>0</ns1:position>
                <ns1:slot>#TOPOLOGY-START#</ns1:slot>
                <ns1:version>1</ns1:version>
                <ns1:latest>true</ns1:latest>
                <ns1:slotId>95</ns1:slotId>
                <ns1:versionStatus>active</ns1:versionStatus>
                <ns1:lockType>0</ns1:lockType>
            </ns1:policy>
            <ns1:policyTypeName>Workflow</ns1:policyTypeName>
            <ns1:itemClass>VMContainer</ns1:itemClass>
            <ns1:itemId>1</ns1:itemId>
            <ns1:itemName>Root</ns1:itemName>
        </ns1:policyAssignment>
        <ns1:policyAssignment>
            <ns1:name>Blueprint Checkin</ns1:name>
            <ns1:id>5</ns1:id>
            <ns1:uuid>756d847c-8259-11e4-96fc-005056952d4b</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath>/Root</ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:applyToSelf>false</ns1:applyToSelf>
            <ns1:applyChildrenDepth>0</ns1:applyChildrenDepth>
            <ns1:allowChildrenOverride>false</ns1:allowChildrenOverride>
            <ns1:policy xsi:type="ns1:VersionedItemLink">
                <ns1:name>Blueprint Checkin</ns1:name>
                <ns1:href>policy/48</ns1:href>
                <ns1:id>48</ns1:id>
                <ns1:rel>down</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Policy+xml</ns1:type>
                <ns1:position>0</ns1:position>
                <ns1:slot>#BLUEPRINT-PUBLISH#</ns1:slot>
                <ns1:version>1</ns1:version>
                <ns1:latest>true</ns1:latest>
                <ns1:slotId>96</ns1:slotId>
                <ns1:versionStatus>active</ns1:versionStatus>
                <ns1:lockType>0</ns1:lockType>
            </ns1:policy>
            <ns1:policyTypeName>Workflow</ns1:policyTypeName>
            <ns1:itemClass>VMContainer</ns1:itemClass>
            <ns1:itemId>1</ns1:itemId>
            <ns1:itemName>Root</ns1:itemName>
        </ns1:policyAssignment>
        <ns1:policyAssignment>
            <ns1:name>Package Checkin</ns1:name>
            <ns1:id>6</ns1:id>
            <ns1:uuid>756dd97c-8259-11e4-96fc-005056952d4b</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath>/Root</ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:applyToSelf>false</ns1:applyToSelf>
            <ns1:applyChildrenDepth>0</ns1:applyChildrenDepth>
            <ns1:allowChildrenOverride>false</ns1:allowChildrenOverride>
            <ns1:policy xsi:type="ns1:VersionedItemLink">
                <ns1:name>Package Checkin</ns1:name>
                <ns1:href>policy/49</ns1:href>
                <ns1:id>49</ns1:id>
                <ns1:rel>down</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Policy+xml</ns1:type>
                <ns1:position>0</ns1:position>
                <ns1:slot>#PACKAGE-PUBLISH#</ns1:slot>
                <ns1:version>1</ns1:version>
                <ns1:latest>true</ns1:latest>
                <ns1:slotId>97</ns1:slotId>
                <ns1:versionStatus>active</ns1:versionStatus>
                <ns1:lockType>0</ns1:lockType>
            </ns1:policy>
            <ns1:policyTypeName>Workflow</ns1:policyTypeName>
            <ns1:itemClass>VMContainer</ns1:itemClass>
            <ns1:itemId>1</ns1:itemId>
            <ns1:itemName>Root</ns1:itemName>
        </ns1:policyAssignment>
        <ns1:policyAssignment>
            <ns1:name>Script Checkin</ns1:name>
            <ns1:id>7</ns1:id>
            <ns1:uuid>756e2e22-8259-11e4-96fc-005056952d4b</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath>/Root</ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:applyToSelf>false</ns1:applyToSelf>
            <ns1:applyChildrenDepth>0</ns1:applyChildrenDepth>
            <ns1:allowChildrenOverride>false</ns1:allowChildrenOverride>
            <ns1:policy xsi:type="ns1:VersionedItemLink">
                <ns1:name>Script Checkin</ns1:name>
                <ns1:href>policy/50</ns1:href>
                <ns1:id>50</ns1:id>
                <ns1:rel>down</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Policy+xml</ns1:type>
                <ns1:position>0</ns1:position>
                <ns1:slot>#SCRIPT-PUBLISH#</ns1:slot>
                <ns1:version>1</ns1:version>
                <ns1:latest>true</ns1:latest>
                <ns1:slotId>98</ns1:slotId>
                <ns1:versionStatus>active</ns1:versionStatus>
                <ns1:lockType>0</ns1:lockType>
            </ns1:policy>
            <ns1:policyTypeName>Workflow</ns1:policyTypeName>
            <ns1:itemClass>VMContainer</ns1:itemClass>
            <ns1:itemId>1</ns1:itemId>
            <ns1:itemName>Root</ns1:itemName>
        </ns1:policyAssignment>
        <ns1:policyAssignment>
            <ns1:name>Stack Checkin</ns1:name>
            <ns1:id>8</ns1:id>
            <ns1:uuid>756e85a2-8259-11e4-96fc-005056952d4b</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath>/Root</ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:applyToSelf>false</ns1:applyToSelf>
            <ns1:applyChildrenDepth>0</ns1:applyChildrenDepth>
            <ns1:allowChildrenOverride>false</ns1:allowChildrenOverride>
            <ns1:policy xsi:type="ns1:VersionedItemLink">
                <ns1:name>Stack Checkin</ns1:name>
                <ns1:href>policy/51</ns1:href>
                <ns1:id>51</ns1:id>
                <ns1:rel>down</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Policy+xml</ns1:type>
                <ns1:position>0</ns1:position>
                <ns1:slot>#STACK-PUBLISH#</ns1:slot>
                <ns1:version>1</ns1:version>
                <ns1:latest>true</ns1:latest>
                <ns1:slotId>99</ns1:slotId>
                <ns1:versionStatus>active</ns1:versionStatus>
                <ns1:lockType>0</ns1:lockType>
            </ns1:policy>
            <ns1:policyTypeName>Workflow</ns1:policyTypeName>
            <ns1:itemClass>VMContainer</ns1:itemClass>
            <ns1:itemId>1</ns1:itemId>
            <ns1:itemName>Root</ns1:itemName>
        </ns1:policyAssignment>
        <ns1:policyAssignment>
            <ns1:name>Product Order</ns1:name>
            <ns1:id>9</ns1:id>
            <ns1:uuid>756ee5b0-8259-11e4-96fc-005056952d4b</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath>/Root</ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:applyToSelf>false</ns1:applyToSelf>
            <ns1:applyChildrenDepth>0</ns1:applyChildrenDepth>
            <ns1:allowChildrenOverride>false</ns1:allowChildrenOverride>
            <ns1:policy xsi:type="ns1:VersionedItemLink">
                <ns1:name>Product Order</ns1:name>
                <ns1:href>policy/54</ns1:href>
                <ns1:id>54</ns1:id>
                <ns1:rel>down</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Policy+xml</ns1:type>
                <ns1:position>0</ns1:position>
                <ns1:slot>#PRODUCT-ORDER#</ns1:slot>
                <ns1:version>1</ns1:version>
                <ns1:latest>true</ns1:latest>
                <ns1:slotId>102</ns1:slotId>
                <ns1:versionStatus>active</ns1:versionStatus>
                <ns1:lockType>0</ns1:lockType>
            </ns1:policy>
            <ns1:policyTypeName>Workflow</ns1:policyTypeName>
            <ns1:itemClass>VMContainer</ns1:itemClass>
            <ns1:itemId>1</ns1:itemId>
            <ns1:itemName>Root</ns1:itemName>
        </ns1:policyAssignment>
        <ns1:policyAssignment>
            <ns1:name>Product Deploy</ns1:name>
            <ns1:id>10</ns1:id>
            <ns1:uuid>756f4a3c-8259-11e4-96fc-005056952d4b</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath>/Root</ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:applyToSelf>false</ns1:applyToSelf>
            <ns1:applyChildrenDepth>0</ns1:applyChildrenDepth>
            <ns1:allowChildrenOverride>false</ns1:allowChildrenOverride>
            <ns1:policy xsi:type="ns1:VersionedItemLink">
                <ns1:name>Product Deploy</ns1:name>
                <ns1:href>policy/55</ns1:href>
                <ns1:id>55</ns1:id>
                <ns1:rel>down</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Policy+xml</ns1:type>
                <ns1:position>0</ns1:position>
                <ns1:slot>#PRODUCT-DEPLOY#</ns1:slot>
                <ns1:version>1</ns1:version>
                <ns1:latest>true</ns1:latest>
                <ns1:slotId>103</ns1:slotId>
                <ns1:versionStatus>active</ns1:versionStatus>
                <ns1:lockType>0</ns1:lockType>
            </ns1:policy>
            <ns1:policyTypeName>Workflow</ns1:policyTypeName>
            <ns1:itemClass>VMContainer</ns1:itemClass>
            <ns1:itemId>1</ns1:itemId>
            <ns1:itemName>Root</ns1:itemName>
        </ns1:policyAssignment>
        <ns1:policyAssignment>
            <ns1:name>Solution Deploy</ns1:name>
            <ns1:id>11</ns1:id>
            <ns1:uuid>756fac3e-8259-11e4-96fc-005056952d4b</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath>/Root</ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:applyToSelf>false</ns1:applyToSelf>
            <ns1:applyChildrenDepth>0</ns1:applyChildrenDepth>
            <ns1:allowChildrenOverride>false</ns1:allowChildrenOverride>
            <ns1:policy xsi:type="ns1:VersionedItemLink">
                <ns1:name>Solution Deploy</ns1:name>
                <ns1:href>policy/56</ns1:href>
                <ns1:id>56</ns1:id>
                <ns1:rel>down</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Policy+xml</ns1:type>
                <ns1:position>0</ns1:position>
                <ns1:slot>#DEPLOYMENT-SUBMIT#</ns1:slot>
                <ns1:version>1</ns1:version>
                <ns1:latest>true</ns1:latest>
                <ns1:slotId>104</ns1:slotId>
                <ns1:versionStatus>active</ns1:versionStatus>
                <ns1:lockType>0</ns1:lockType>
            </ns1:policy>
            <ns1:policyTypeName>Workflow</ns1:policyTypeName>
            <ns1:itemClass>VMContainer</ns1:itemClass>
            <ns1:itemId>1</ns1:itemId>
            <ns1:itemName>Root</ns1:itemName>
        </ns1:policyAssignment>
        <ns1:policyAssignment>
            <ns1:name>Configuration Artifact Change</ns1:name>
            <ns1:id>12</ns1:id>
            <ns1:uuid>756fff2c-8259-11e4-96fc-005056952d4b</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath>/Root</ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:applyToSelf>false</ns1:applyToSelf>
            <ns1:applyChildrenDepth>0</ns1:applyChildrenDepth>
            <ns1:allowChildrenOverride>false</ns1:allowChildrenOverride>
            <ns1:policy xsi:type="ns1:VersionedItemLink">
                <ns1:name>Configuration Artifact Change</ns1:name>
                <ns1:href>policy/57</ns1:href>
                <ns1:id>57</ns1:id>
                <ns1:rel>down</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Policy+xml</ns1:type>
                <ns1:position>0</ns1:position>
                <ns1:slot>#ARTIFACT-SYNC#</ns1:slot>
                <ns1:version>1</ns1:version>
                <ns1:latest>true</ns1:latest>
                <ns1:slotId>105</ns1:slotId>
                <ns1:versionStatus>active</ns1:versionStatus>
                <ns1:lockType>0</ns1:lockType>
            </ns1:policy>
            <ns1:policyTypeName>Workflow</ns1:policyTypeName>
            <ns1:itemClass>VMContainer</ns1:itemClass>
            <ns1:itemId>1</ns1:itemId>
            <ns1:itemName>Root</ns1:itemName>
        </ns1:policyAssignment>
        <ns1:policyAssignment>
            <ns1:name>Instance Release</ns1:name>
            <ns1:id>13</ns1:id>
            <ns1:uuid>75706200-8259-11e4-96fc-005056952d4b</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath>/Root</ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:applyToSelf>false</ns1:applyToSelf>
            <ns1:applyChildrenDepth>0</ns1:applyChildrenDepth>
            <ns1:allowChildrenOverride>false</ns1:allowChildrenOverride>
            <ns1:policy xsi:type="ns1:VersionedItemLink">
                <ns1:name>Instance Release</ns1:name>
                <ns1:href>policy/58</ns1:href>
                <ns1:id>58</ns1:id>
                <ns1:rel>down</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Policy+xml</ns1:type>
                <ns1:position>0</ns1:position>
                <ns1:slot>#INSTANCE-RELEASE#</ns1:slot>
                <ns1:version>1</ns1:version>
                <ns1:latest>true</ns1:latest>
                <ns1:slotId>106</ns1:slotId>
                <ns1:versionStatus>active</ns1:versionStatus>
                <ns1:lockType>0</ns1:lockType>
            </ns1:policy>
            <ns1:policyTypeName>Workflow</ns1:policyTypeName>
            <ns1:itemClass>VMContainer</ns1:itemClass>
            <ns1:itemId>1</ns1:itemId>
            <ns1:itemName>Root</ns1:itemName>
        </ns1:policyAssignment>
        <ns1:policyAssignment>
            <ns1:name>Instance Restart</ns1:name>
            <ns1:id>14</ns1:id>
            <ns1:uuid>7570b912-8259-11e4-96fc-005056952d4b</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath>/Root</ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:applyToSelf>false</ns1:applyToSelf>
            <ns1:applyChildrenDepth>0</ns1:applyChildrenDepth>
            <ns1:allowChildrenOverride>false</ns1:allowChildrenOverride>
            <ns1:policy xsi:type="ns1:VersionedItemLink">
                <ns1:name>Instance Restart</ns1:name>
                <ns1:href>policy/59</ns1:href>
                <ns1:id>59</ns1:id>
                <ns1:rel>down</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Policy+xml</ns1:type>
                <ns1:position>0</ns1:position>
                <ns1:slot>#INSTANCE-RESTART#</ns1:slot>
                <ns1:version>1</ns1:version>
                <ns1:latest>true</ns1:latest>
                <ns1:slotId>107</ns1:slotId>
                <ns1:versionStatus>active</ns1:versionStatus>
                <ns1:lockType>0</ns1:lockType>
            </ns1:policy>
            <ns1:policyTypeName>Workflow</ns1:policyTypeName>
            <ns1:itemClass>VMContainer</ns1:itemClass>
            <ns1:itemId>1</ns1:itemId>
            <ns1:itemName>Root</ns1:itemName>
        </ns1:policyAssignment>
        <ns1:policyAssignment>
            <ns1:name>Template Start</ns1:name>
            <ns1:id>15</ns1:id>
            <ns1:uuid>75710caa-8259-11e4-96fc-005056952d4b</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath>/Root</ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:applyToSelf>false</ns1:applyToSelf>
            <ns1:applyChildrenDepth>0</ns1:applyChildrenDepth>
            <ns1:allowChildrenOverride>false</ns1:allowChildrenOverride>
            <ns1:policy xsi:type="ns1:VersionedItemLink">
                <ns1:name>Template Start</ns1:name>
                <ns1:href>policy/60</ns1:href>
                <ns1:id>60</ns1:id>
                <ns1:rel>down</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Policy+xml</ns1:type>
                <ns1:position>0</ns1:position>
                <ns1:slot>#TEMPLATE-START#</ns1:slot>
                <ns1:version>1</ns1:version>
                <ns1:latest>true</ns1:latest>
                <ns1:slotId>108</ns1:slotId>
                <ns1:versionStatus>active</ns1:versionStatus>
                <ns1:lockType>0</ns1:lockType>
            </ns1:policy>
            <ns1:policyTypeName>Workflow</ns1:policyTypeName>
            <ns1:itemClass>VMContainer</ns1:itemClass>
            <ns1:itemId>1</ns1:itemId>
            <ns1:itemName>Root</ns1:itemName>
        </ns1:policyAssignment>
        <ns1:policyAssignment>
            <ns1:name>Template Restart</ns1:name>
            <ns1:id>16</ns1:id>
            <ns1:uuid>75715fde-8259-11e4-96fc-005056952d4b</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath>/Root</ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:applyToSelf>false</ns1:applyToSelf>
            <ns1:applyChildrenDepth>0</ns1:applyChildrenDepth>
            <ns1:allowChildrenOverride>false</ns1:allowChildrenOverride>
            <ns1:policy xsi:type="ns1:VersionedItemLink">
                <ns1:name>Template Restart</ns1:name>
                <ns1:href>policy/61</ns1:href>
                <ns1:id>61</ns1:id>
                <ns1:rel>down</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Policy+xml</ns1:type>
                <ns1:position>0</ns1:position>
                <ns1:slot>#TEMPLATE-RESTART#</ns1:slot>
                <ns1:version>1</ns1:version>
                <ns1:latest>true</ns1:latest>
                <ns1:slotId>109</ns1:slotId>
                <ns1:versionStatus>active</ns1:versionStatus>
                <ns1:lockType>0</ns1:lockType>
            </ns1:policy>
            <ns1:policyTypeName>Workflow</ns1:policyTypeName>
            <ns1:itemClass>VMContainer</ns1:itemClass>
            <ns1:itemId>1</ns1:itemId>
            <ns1:itemName>Root</ns1:itemName>
        </ns1:policyAssignment>
        <ns1:policyAssignment>
            <ns1:name>Template Stop</ns1:name>
            <ns1:id>17</ns1:id>
            <ns1:uuid>7571b5d8-8259-11e4-96fc-005056952d4b</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath>/Root</ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:applyToSelf>false</ns1:applyToSelf>
            <ns1:applyChildrenDepth>0</ns1:applyChildrenDepth>
            <ns1:allowChildrenOverride>false</ns1:allowChildrenOverride>
            <ns1:policy xsi:type="ns1:VersionedItemLink">
                <ns1:name>Template Stop</ns1:name>
                <ns1:href>policy/62</ns1:href>
                <ns1:id>62</ns1:id>
                <ns1:rel>down</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Policy+xml</ns1:type>
                <ns1:position>0</ns1:position>
                <ns1:slot>#TEMPLATE-STOP#</ns1:slot>
                <ns1:version>1</ns1:version>
                <ns1:latest>true</ns1:latest>
                <ns1:slotId>110</ns1:slotId>
                <ns1:versionStatus>active</ns1:versionStatus>
                <ns1:lockType>0</ns1:lockType>
            </ns1:policy>
            <ns1:policyTypeName>Workflow</ns1:policyTypeName>
            <ns1:itemClass>VMContainer</ns1:itemClass>
            <ns1:itemId>1</ns1:itemId>
            <ns1:itemName>Root</ns1:itemName>
        </ns1:policyAssignment>
        <ns1:policyAssignment>
            <ns1:name>Template Release</ns1:name>
            <ns1:id>18</ns1:id>
            <ns1:uuid>75720ca4-8259-11e4-96fc-005056952d4b</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath>/Root</ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:applyToSelf>false</ns1:applyToSelf>
            <ns1:applyChildrenDepth>0</ns1:applyChildrenDepth>
            <ns1:allowChildrenOverride>false</ns1:allowChildrenOverride>
            <ns1:policy xsi:type="ns1:VersionedItemLink">
                <ns1:name>Template Release</ns1:name>
                <ns1:href>policy/63</ns1:href>
                <ns1:id>63</ns1:id>
                <ns1:rel>down</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Policy+xml</ns1:type>
                <ns1:position>0</ns1:position>
                <ns1:slot>#TEMPLATE-RELEASE#</ns1:slot>
                <ns1:version>1</ns1:version>
                <ns1:latest>true</ns1:latest>
                <ns1:slotId>111</ns1:slotId>
                <ns1:versionStatus>active</ns1:versionStatus>
                <ns1:lockType>0</ns1:lockType>
            </ns1:policy>
            <ns1:policyTypeName>Workflow</ns1:policyTypeName>
            <ns1:itemClass>VMContainer</ns1:itemClass>
            <ns1:itemId>1</ns1:itemId>
            <ns1:itemName>Root</ns1:itemName>
        </ns1:policyAssignment>
        <ns1:policyAssignment>
            <ns1:name>Topology Stop</ns1:name>
            <ns1:id>19</ns1:id>
            <ns1:uuid>75725e3e-8259-11e4-96fc-005056952d4b</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath>/Root</ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:applyToSelf>false</ns1:applyToSelf>
            <ns1:applyChildrenDepth>0</ns1:applyChildrenDepth>
            <ns1:allowChildrenOverride>false</ns1:allowChildrenOverride>
            <ns1:policy xsi:type="ns1:VersionedItemLink">
                <ns1:name>Topology Stop</ns1:name>
                <ns1:href>policy/64</ns1:href>
                <ns1:id>64</ns1:id>
                <ns1:rel>down</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Policy+xml</ns1:type>
                <ns1:position>0</ns1:position>
                <ns1:slot>#TOPOLOGY-STOP#</ns1:slot>
                <ns1:version>1</ns1:version>
                <ns1:latest>true</ns1:latest>
                <ns1:slotId>112</ns1:slotId>
                <ns1:versionStatus>active</ns1:versionStatus>
                <ns1:lockType>0</ns1:lockType>
            </ns1:policy>
            <ns1:policyTypeName>Workflow</ns1:policyTypeName>
            <ns1:itemClass>VMContainer</ns1:itemClass>
            <ns1:itemId>1</ns1:itemId>
            <ns1:itemName>Root</ns1:itemName>
        </ns1:policyAssignment>
        <ns1:policyAssignment>
            <ns1:name>Topology Restart</ns1:name>
            <ns1:id>20</ns1:id>
            <ns1:uuid>7572b87a-8259-11e4-96fc-005056952d4b</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath>/Root</ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:applyToSelf>false</ns1:applyToSelf>
            <ns1:applyChildrenDepth>0</ns1:applyChildrenDepth>
            <ns1:allowChildrenOverride>false</ns1:allowChildrenOverride>
            <ns1:policy xsi:type="ns1:VersionedItemLink">
                <ns1:name>Topology Restart</ns1:name>
                <ns1:href>policy/65</ns1:href>
                <ns1:id>65</ns1:id>
                <ns1:rel>down</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Policy+xml</ns1:type>
                <ns1:position>0</ns1:position>
                <ns1:slot>#TOPOLOGY-RESTART#</ns1:slot>
                <ns1:version>1</ns1:version>
                <ns1:latest>true</ns1:latest>
                <ns1:slotId>113</ns1:slotId>
                <ns1:versionStatus>active</ns1:versionStatus>
                <ns1:lockType>0</ns1:lockType>
            </ns1:policy>
            <ns1:policyTypeName>Workflow</ns1:policyTypeName>
            <ns1:itemClass>VMContainer</ns1:itemClass>
            <ns1:itemId>1</ns1:itemId>
            <ns1:itemName>Root</ns1:itemName>
        </ns1:policyAssignment>
        <ns1:policyAssignment>
            <ns1:name>Topology Release</ns1:name>
            <ns1:id>21</ns1:id>
            <ns1:uuid>75730bcc-8259-11e4-96fc-005056952d4b</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath>/Root</ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:applyToSelf>false</ns1:applyToSelf>
            <ns1:applyChildrenDepth>0</ns1:applyChildrenDepth>
            <ns1:allowChildrenOverride>false</ns1:allowChildrenOverride>
            <ns1:policy xsi:type="ns1:VersionedItemLink">
                <ns1:name>Topology Release</ns1:name>
                <ns1:href>policy/66</ns1:href>
                <ns1:id>66</ns1:id>
                <ns1:rel>down</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Policy+xml</ns1:type>
                <ns1:position>0</ns1:position>
                <ns1:slot>#TOPOLOGY-RELEASE#</ns1:slot>
                <ns1:version>1</ns1:version>
                <ns1:latest>true</ns1:latest>
                <ns1:slotId>114</ns1:slotId>
                <ns1:versionStatus>active</ns1:versionStatus>
                <ns1:lockType>0</ns1:lockType>
            </ns1:policy>
            <ns1:policyTypeName>Workflow</ns1:policyTypeName>
            <ns1:itemClass>VMContainer</ns1:itemClass>
            <ns1:itemId>1</ns1:itemId>
            <ns1:itemName>Root</ns1:itemName>
        </ns1:policyAssignment>
        <ns1:policyAssignment>
            <ns1:name>Topology Checkin</ns1:name>
            <ns1:id>22</ns1:id>
            <ns1:uuid>75735d16-8259-11e4-96fc-005056952d4b</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath>/Root</ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:applyToSelf>false</ns1:applyToSelf>
            <ns1:applyChildrenDepth>0</ns1:applyChildrenDepth>
            <ns1:allowChildrenOverride>false</ns1:allowChildrenOverride>
            <ns1:policy xsi:type="ns1:VersionedItemLink">
                <ns1:name>Topology Checkin</ns1:name>
                <ns1:href>policy/52</ns1:href>
                <ns1:id>52</ns1:id>
                <ns1:rel>down</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Policy+xml</ns1:type>
                <ns1:position>0</ns1:position>
                <ns1:slot>#TOPOLOGY-PUBLISH#</ns1:slot>
                <ns1:version>1</ns1:version>
                <ns1:latest>true</ns1:latest>
                <ns1:slotId>100</ns1:slotId>
                <ns1:versionStatus>active</ns1:versionStatus>
                <ns1:lockType>0</ns1:lockType>
            </ns1:policy>
            <ns1:policyTypeName>Workflow</ns1:policyTypeName>
            <ns1:itemClass>VMContainer</ns1:itemClass>
            <ns1:itemId>1</ns1:itemId>
            <ns1:itemName>Root</ns1:itemName>
        </ns1:policyAssignment>
        <ns1:policyAssignment>
            <ns1:name>Template Delete</ns1:name>
            <ns1:id>23</ns1:id>
            <ns1:uuid>7573af96-8259-11e4-96fc-005056952d4b</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath>/Root</ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:applyToSelf>false</ns1:applyToSelf>
            <ns1:applyChildrenDepth>0</ns1:applyChildrenDepth>
            <ns1:allowChildrenOverride>false</ns1:allowChildrenOverride>
            <ns1:policy xsi:type="ns1:VersionedItemLink">
                <ns1:name>Template Delete</ns1:name>
                <ns1:href>policy/67</ns1:href>
                <ns1:id>67</ns1:id>
                <ns1:rel>down</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Policy+xml</ns1:type>
                <ns1:position>0</ns1:position>
                <ns1:slot>#TEMPLATE-DELETE#</ns1:slot>
                <ns1:version>1</ns1:version>
                <ns1:latest>true</ns1:latest>
                <ns1:slotId>115</ns1:slotId>
                <ns1:versionStatus>active</ns1:versionStatus>
                <ns1:lockType>0</ns1:lockType>
            </ns1:policy>
            <ns1:policyTypeName>Workflow</ns1:policyTypeName>
            <ns1:itemClass>VMContainer</ns1:itemClass>
            <ns1:itemId>1</ns1:itemId>
            <ns1:itemName>Root</ns1:itemName>
        </ns1:policyAssignment>
        <ns1:parent>
            <ns1:name>MWS2R3_SYD</ns1:name>
            <ns1:href>project/8</ns1:href>
            <ns1:id>8</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Project+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:parent>
        <ns1:slot>1aac43f4-ca41-4fc4-a6e8-cb39462bd272</ns1:slot>
        <ns1:version>1</ns1:version>
        <ns1:latest>true</ns1:latest>
        <ns1:publishComment>R3 REL 0.2</ns1:publishComment>
        <ns1:slotId>147</ns1:slotId>
        <ns1:publisher>
            <ns1:name>devraus01</ns1:name>
            <ns1:href>user/9</ns1:href>
            <ns1:id>9</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.User+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:publisher>
        <ns1:versionStatus>active</ns1:versionStatus>
        <ns1:checkoutAllowed>true</ns1:checkoutAllowed>
        <ns1:headAllowed>false</ns1:headAllowed>
        <ns1:operatingSystem>Windows|2012</ns1:operatingSystem>
        <ns1:targets>
            <ns1:name>CSC SOE 6.11 Agility-CMWVMMSYD002</ns1:name>
            <ns1:href>targetcloud/3</ns1:href>
            <ns1:id>3</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.TargetCloud+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:targets>
        <ns1:status>Built</ns1:status>
        <ns1:images>
            <ns1:name>CSC SOE 6.11 Agility Image</ns1:name>
            <ns1:href>image/3</ns1:href>
            <ns1:id>3</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Image+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:images>
        <ns1:template>
            <ns1:name>template-CSC SOE 6.11 Agility-dff49b9b-6a5d-4e80-966f-f06b15bfb25d</ns1:name>
            <ns1:href>template/12</ns1:href>
            <ns1:id>12</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Template+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:template>
    </ns1:pendingAsset>
    <ns1:Asset xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="ns1:CloudType">
        <ns1:name>Microsoft Private Cloud</ns1:name>
        <ns1:id>8</ns1:id>
        <ns1:description>AzurePack/SPF Beta</ns1:description>
        <ns1:uuid>6ad8624a-90e7-445c-b62d-8a6933631fab</ns1:uuid>
        <ns1:importMode>Lookup</ns1:importMode>
        <ns1:importDirectives>
            <ns1:onNotFound>Continue</ns1:onNotFound>
        </ns1:importDirectives>
        <ns1:top>false</ns1:top>
    </ns1:Asset>
    <ns1:Asset xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="ns1:Cloud">
        <ns1:name>CMWVMMSYD002</ns1:name>
        <ns1:id>2</ns1:id>
        <ns1:description></ns1:description>
        <ns1:uuid>b0cdd3f1-f6e7-49ac-8331-7455a41296e1</ns1:uuid>
        <ns1:importMode>Lookup</ns1:importMode>
        <ns1:importDirectives>
            <ns1:onNotFound>Continue</ns1:onNotFound>
        </ns1:importDirectives>
        <ns1:top>false</ns1:top>
        <ns1:cloudType>
            <ns1:name>Microsoft Private Cloud</ns1:name>
            <ns1:href>cloudtype/8</ns1:href>
            <ns1:id>8</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.CloudType+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:cloudType>
    </ns1:Asset>
    <ns1:Asset xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="ns1:Blueprint">
        <ns1:name>MWS2R3 - Avecto Defendpoint</ns1:name>
        <ns1:id>151</ns1:id>
        <ns1:description></ns1:description>
        <ns1:uuid>f536e00b-c5a4-4573-97b7-5e436827dbe6</ns1:uuid>
        <ns1:assetType>
            <ns1:name>blueprint</ns1:name>
            <ns1:href>assettype/6</ns1:href>
            <ns1:id>6</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.AssetType+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:assetType>
        <ns1:top>true</ns1:top>
        <ns1:assetPath>/Root/MWS2R3_SYD</ns1:assetPath>
        <ns1:detailedAssetPath>/Root:#ID#1:#TYPE#VMContainer/MWS2R3_SYD:#ID#8:#TYPE#VMProject</ns1:detailedAssetPath>
        <ns1:applicationType>application/com.servicemesh.agility.api.Blueprint+xml</ns1:applicationType>
        <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
        <ns1:removable>true</ns1:removable>
        <ns1:domain>
            <ns1:name>domain1</ns1:name>
            <ns1:href>domain/1</ns1:href>
            <ns1:id>1</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Domain+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:domain>
        <ns1:creator>
            <ns1:name>dridley</ns1:name>
            <ns1:href>user/12</ns1:href>
            <ns1:id>12</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.User+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:creator>
        <ns1:created>2015-06-05T16:28:53+10:00</ns1:created>
        <ns1:lockType>0</ns1:lockType>
        <ns1:lastModified>2015-06-05T16:33:16+10:00</ns1:lastModified>
        <ns1:parent>
            <ns1:name>MWS2R3_SYD</ns1:name>
            <ns1:href>project/8</ns1:href>
            <ns1:id>8</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Project+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:parent>
        <ns1:version>-1</ns1:version>
        <ns1:latest>false</ns1:latest>
        <ns1:publisher>
            <ns1:name>dridley</ns1:name>
            <ns1:href>user/12</ns1:href>
            <ns1:id>12</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.User+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:publisher>
        <ns1:versionStatus>inprogress</ns1:versionStatus>
        <ns1:checkoutAllowed>false</ns1:checkoutAllowed>
        <ns1:headAllowed>false</ns1:headAllowed>
        <ns1:path>/Root/MWS2R3_SYD</ns1:path>
        <ns1:dirty>false</ns1:dirty>
        <ns1:layout>1.6707690954208374,0,0</ns1:layout>
        <ns1:resourceAffinity>None</ns1:resourceAffinity>
        <ns1:mandatoryAffinity>false</ns1:mandatoryAffinity>
        <ns1:antiAffinity>false</ns1:antiAffinity>
        <ns1:anyOrderItem xsi:type="ns1:Workload">
            <ns1:name>Avecto - Defendpoint</ns1:name>
            <ns1:description></ns1:description>
            <ns1:uuid>48bb334a-3c4d-410f-82a2-471bcaeab37e</ns1:uuid>
            <ns1:assetType>
                <ns1:name>designworkload</ns1:name>
                <ns1:href>assettype/8</ns1:href>
                <ns1:id>8</ns1:id>
                <ns1:rel>up</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.AssetType+xml</ns1:type>
                <ns1:position>0</ns1:position>
            </ns1:assetType>
            <ns1:top>false</ns1:top>
            <ns1:assetPath>/Root/MWS2R3_SYD</ns1:assetPath>
            <ns1:detailedAssetPath>/Root:#ID#1:#TYPE#VMContainer/MWS2R3_SYD:#ID#8:#TYPE#VMProject</ns1:detailedAssetPath>
            <ns1:applicationType>application/com.servicemesh.agility.api.Workload+xml</ns1:applicationType>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:domain>
                <ns1:name>domain1</ns1:name>
                <ns1:href>domain/1</ns1:href>
                <ns1:id>1</ns1:id>
                <ns1:rel>up</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Domain+xml</ns1:type>
                <ns1:position>0</ns1:position>
            </ns1:domain>
            <ns1:creator>
                <ns1:name>dridley</ns1:name>
                <ns1:href>user/12</ns1:href>
                <ns1:id>12</ns1:id>
                <ns1:rel>up</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.User+xml</ns1:type>
                <ns1:position>0</ns1:position>
            </ns1:creator>
            <ns1:created>2015-06-05T16:33:16+10:00</ns1:created>
            <ns1:lockType>0</ns1:lockType>
            <ns1:lastModified>2015-06-05T16:33:16+10:00</ns1:lastModified>
            <ns1:parent>
                <ns1:name>MWS2R3_SYD</ns1:name>
                <ns1:href>project/8</ns1:href>
                <ns1:id>8</ns1:id>
                <ns1:rel>up</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Project+xml</ns1:type>
                <ns1:position>0</ns1:position>
            </ns1:parent>
            <ns1:anyOrderPosition>0</ns1:anyOrderPosition>
            <ns1:variable>
                <ns1:id>10755</ns1:id>
                <ns1:name>COMPONENTID</ns1:name>
                <ns1:encrypted>false</ns1:encrypted>
                <ns1:overridable>true</ns1:overridable>
                <ns1:propertyType>
                    <ns1:name>string-any</ns1:name>
                    <ns1:href>/propertytype/4</ns1:href>
                    <ns1:id>4</ns1:id>
                    <ns1:rel>up</ns1:rel>
                    <ns1:type>application/com.servicemesh.agility.api.PropertyType+xml</ns1:type>
                    <ns1:position>0</ns1:position>
                </ns1:propertyType>
                <ns1:propertyDefinition xsi:type="ns1:Link">
                    <ns1:name>COMPONENTID</ns1:name>
                    <ns1:href>/propertydefinition/514</ns1:href>
                    <ns1:id>514</ns1:id>
                    <ns1:rel>up</ns1:rel>
                    <ns1:type>application/com.servicemesh.agility.api.PropertyDefinition+xml</ns1:type>
                    <ns1:position>0</ns1:position>
                </ns1:propertyDefinition>
                <ns1:stringValue>ADP</ns1:stringValue>
                <ns1:intValue>0</ns1:intValue>
                <ns1:booleanValue>false</ns1:booleanValue>
            </ns1:variable>
            <ns1:variable>
                <ns1:id>10756</ns1:id>
                <ns1:name>TESTSCRIPTS</ns1:name>
                <ns1:encrypted>false</ns1:encrypted>
                <ns1:overridable>true</ns1:overridable>
                <ns1:propertyType>
                    <ns1:name>string-any</ns1:name>
                    <ns1:href>/propertytype/4</ns1:href>
                    <ns1:id>4</ns1:id>
                    <ns1:rel>up</ns1:rel>
                    <ns1:type>application/com.servicemesh.agility.api.PropertyType+xml</ns1:type>
                    <ns1:position>0</ns1:position>
                </ns1:propertyType>
                <ns1:propertyDefinition xsi:type="ns1:Link">
                    <ns1:name>TESTSCRIPTS</ns1:name>
                    <ns1:href>/propertydefinition/358</ns1:href>
                    <ns1:id>358</ns1:id>
                    <ns1:rel>up</ns1:rel>
                    <ns1:type>application/com.servicemesh.agility.api.PropertyDefinition+xml</ns1:type>
                    <ns1:position>0</ns1:position>
                </ns1:propertyDefinition>
                <ns1:stringValue>UnitTest-Server-Common.ps1;UnitTest-Server-Common-IIS.ps1</ns1:stringValue>
                <ns1:intValue>0</ns1:intValue>
                <ns1:booleanValue>false</ns1:booleanValue>
            </ns1:variable>
            <ns1:path>/Root/MWS2R3_SYD</ns1:path>
            <ns1:dirty>false</ns1:dirty>
            <ns1:layout>350,170,300,325,false</ns1:layout>
            <ns1:logicalId>a9252d44-8bb9-4524-8fd3-90cc89b38a82</ns1:logicalId>
            <ns1:numInstances>1</ns1:numInstances>
            <ns1:packages xsi:type="ns1:VersionedItemLink">
                <ns1:name>MWS2R3 - AD Rename and Add to Domain</ns1:name>
                <ns1:href>package/36</ns1:href>
                <ns1:id>36</ns1:id>
                <ns1:rel>down</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Package+xml</ns1:type>
                <ns1:position>0</ns1:position>
                <ns1:slot>ca672b7b-d7d2-4e55-9cf0-c1d824ad2b2b</ns1:slot>
                <ns1:version>2</ns1:version>
                <ns1:latest>true</ns1:latest>
                <ns1:slotId>126</ns1:slotId>
                <ns1:versionStatus>active</ns1:versionStatus>
                <ns1:lockType>0</ns1:lockType>
            </ns1:packages>
            <ns1:packages xsi:type="ns1:VersionedItemLink">
                <ns1:name>MWS2R3 - Avecto Defendpoint</ns1:name>
                <ns1:href>package/75</ns1:href>
                <ns1:id>75</ns1:id>
                <ns1:rel>down</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Package+xml</ns1:type>
                <ns1:position>1</ns1:position>
                <ns1:version>-1</ns1:version>
                <ns1:latest>false</ns1:latest>
                <ns1:versionStatus>inprogress</ns1:versionStatus>
                <ns1:lockType>0</ns1:lockType>
            </ns1:packages>
            <ns1:baseStack xsi:type="ns1:VersionedItemLink">
                <ns1:name>CSC SOE 6.11 Agility</ns1:name>
                <ns1:href>stack/4</ns1:href>
                <ns1:id>4</ns1:id>
                <ns1:rel>down</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Stack+xml</ns1:type>
                <ns1:position>0</ns1:position>
                <ns1:slot>1aac43f4-ca41-4fc4-a6e8-cb39462bd272</ns1:slot>
                <ns1:version>1</ns1:version>
                <ns1:latest>true</ns1:latest>
                <ns1:slotId>147</ns1:slotId>
                <ns1:versionStatus>active</ns1:versionStatus>
                <ns1:lockType>0</ns1:lockType>
            </ns1:baseStack>
            <ns1:operatingSystem>Windows|2012</ns1:operatingSystem>
            <ns1:releaseDisks>false</ns1:releaseDisks>
        </ns1:anyOrderItem>
        <ns1:deep>true</ns1:deep>
        <ns1:topology>
            <ns1:name>MWS2R3 - Avecto Defendpoint</ns1:name>
            <ns1:href>topology/54</ns1:href>
            <ns1:id>54</ns1:id>
            <ns1:rel>down</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Topology+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:topology>
    </ns1:Asset>
</ns1:Envelope>
