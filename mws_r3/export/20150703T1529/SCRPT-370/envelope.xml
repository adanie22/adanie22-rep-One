<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<ns1:Envelope xmlns:ns1="http://servicemesh.com/agility/api" xmlns:ns2="http://servicemesh.com/core/messaging" ns1:version="3.0" ns1:productVersion="9.2.4">
    <ns1:Asset xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="ns1:Script">
        <ns1:name>MW2SR3 - AppSense EM PM install</ns1:name>
        <ns1:id>370</ns1:id>
        <ns1:description>AppSense EM Pm base installer. Includes pre-requisites.</ns1:description>
        <ns1:uuid>2e303cb1-33e0-45fd-97a9-51c2c7faf537</ns1:uuid>
        <ns1:assetType>
            <ns1:name>script</ns1:name>
            <ns1:href>assettype/2</ns1:href>
            <ns1:id>2</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.AssetType+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:assetType>
        <ns1:top>true</ns1:top>
        <ns1:assetPath>/Root/MWS2R3_SYD</ns1:assetPath>
        <ns1:detailedAssetPath>/Root:#ID#1:#TYPE#VMContainer/MWS2R3_SYD:#ID#8:#TYPE#VMProject</ns1:detailedAssetPath>
        <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
        <ns1:removable>true</ns1:removable>
        <ns1:domain>
            <ns1:name>domain1</ns1:name>
            <ns1:href>domain/1</ns1:href>
            <ns1:id>1</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Domain+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:domain>
        <ns1:creator>
            <ns1:name>ctamondong2</ns1:name>
            <ns1:href>user/13</ns1:href>
            <ns1:id>13</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.User+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:creator>
        <ns1:created>2015-06-15T14:19:20+10:00</ns1:created>
        <ns1:lockType>0</ns1:lockType>
        <ns1:lastModified>2015-06-15T14:19:20+10:00</ns1:lastModified>
        <ns1:parent>
            <ns1:name>MWS2R3_SYD</ns1:name>
            <ns1:href>project/8</ns1:href>
            <ns1:id>8</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Project+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:parent>
        <ns1:version>-1</ns1:version>
        <ns1:latest>false</ns1:latest>
        <ns1:versionStatus>inprogress</ns1:versionStatus>
        <ns1:checkoutAllowed>false</ns1:checkoutAllowed>
        <ns1:headAllowed>false</ns1:headAllowed>
        <ns1:operatingSystem>Windows|2012R2</ns1:operatingSystem>
        <ns1:operatingSystem>Windows|2012R2|*|x64</ns1:operatingSystem>
        <ns1:enableExtensions>false</ns1:enableExtensions>
        <ns1:body>write-output &quot;Starting&quot;
# Load Common functions
. .\Logging.ps1
. .\LaunchProcess.ps1
. .\FilesUtility.ps1

$scriptPath = split-path -parent $MyInvocation.MyCommand.Definition
$scriptName = $MyInvocation.MyCommand.Name

ConfigureLogging $scriptPath $scriptName

# Launch processes

# Install all required Visual C++ redistributables
start-process &quot;$scriptPath\AppSense\Server\Prerequisites\vcredist2013_x64.exe&quot; &quot;/q /norestart | Out-Null&quot;
start-process &quot;$scriptPath\AppSense\Server\Prerequisites\vcredist2013_x32.exe&quot; &quot;/q /norestart | Out-Null&quot;

# Add required Windows roles and features
Import-Module ServerManager
Add-WindowsFeature NET-Framework-Core, NET-HTTP-Activation
Add-WindowsFeature NET-WCF-HTTP-Activation45
Add-WindowsFeature Web-WebServer
Add-WindowsFeature Web-Http-Redirect
Add-WindowsFeature Web-Log-Libraries, Web-Request-Monitor, Web-Http-Tracing
Add-WindowsFeature Web-Basic-Auth, Web-Windows-Auth, Web-IP-Security
Add-WindowsFeature Web-Asp-Net
Add-WindowsFeature Web-Mgmt-Console, Web-Metabase


# Install AppSense Licensing Console
Start-Process -FilePath &quot;$env:systemroot\system32\msiexec.exe&quot; -ArgumentList &quot;/i $scriptPath\AppSense\Server\Products\LicensingConsole64.msi /qn&quot; -Wait

# Install AppSense DesktopNow Environment Manager Personalization Server and console
Start-Process -FilePath &quot;$env:systemroot\system32\msiexec.exe&quot; -ArgumentList &quot;/i $scriptPath\AppSense\Server\Products\PersonalizationServer64.msi /qn&quot; -Wait
Start-Process -FilePath &quot;$env:systemroot\system32\msiexec.exe&quot; -ArgumentList &quot;/i $scriptPath\AppSense\Server\Products\EnvironmentManagerConsole64.msi /qn&quot; -Wait

# Import AppSense DesktopNow Environment Manager Personalization Server Configuration PowerShell module
Import-Module &quot;$env:programfiles\AppSense\Environment Manager\Personalization Server\bin\AppSense.ServerConfiguration.PowerShell.dll&quot;

# Target the AppSense DesktopNow Environment Manager Personalization Server ApsInstance
Import-ApsInstanceModule -ProductName &quot;Personalization Server&quot;

# Catch up on any missing prerequisites
Install-ApsPrerequisite -All



Start-Sleep -Seconds 300

</ns1:body>
        <ns1:type>Guest</ns1:type>
        <ns1:language>
            <ns1:name>powershell</ns1:name>
            <ns1:href>scriptlanguage/5</ns1:href>
            <ns1:id>5</ns1:id>
            <ns1:rel>down</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.ScriptLanguage+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:language>
        <ns1:runAsAdmin>false</ns1:runAsAdmin>
        <ns1:timeout>3600</ns1:timeout>
        <ns1:retries>0</ns1:retries>
        <ns1:delay>0</ns1:delay>
        <ns1:errorAction>Continue</ns1:errorAction>
        <ns1:rebootRequired>false</ns1:rebootRequired>
        <ns1:runOnProvisionOnly>false</ns1:runOnProvisionOnly>
    </ns1:Asset>
</ns1:Envelope>
