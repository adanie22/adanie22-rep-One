<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<ns1:Envelope xmlns:ns1="http://servicemesh.com/agility/api" xmlns:ns2="http://servicemesh.com/core/messaging" ns1:version="3.0" ns1:productVersion="9.2.4">
    <ns1:pendingAsset xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="ns1:Script">
        <ns1:name>MWS2R2 - AD Global Repository</ns1:name>
        <ns1:id>268</ns1:id>
        <ns1:description></ns1:description>
        <ns1:uuid>bc995880-d1ef-4461-b817-f48a7a7a5c12</ns1:uuid>
        <ns1:assetType>
            <ns1:name>script</ns1:name>
            <ns1:href>assettype/2</ns1:href>
            <ns1:id>2</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.AssetType+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:assetType>
        <ns1:top>false</ns1:top>
        <ns1:assetPath>/Root/MWS2/MWS2_CDCR2</ns1:assetPath>
        <ns1:detailedAssetPath>/Root:#ID#1:#TYPE#VMContainer/MWS2:#ID#8:#TYPE#VMContainer/MWS2_CDCR2:#ID#9:#TYPE#VMProject</ns1:detailedAssetPath>
        <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
        <ns1:removable>true</ns1:removable>
        <ns1:domain>
            <ns1:name>domain1</ns1:name>
            <ns1:href>domain/1</ns1:href>
            <ns1:id>1</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Domain+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:domain>
        <ns1:creator>
            <ns1:name>dridley</ns1:name>
            <ns1:href>user/8</ns1:href>
            <ns1:id>8</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.User+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:creator>
        <ns1:created>2015-05-21T18:18:29-05:00</ns1:created>
        <ns1:lockType>0</ns1:lockType>
        <ns1:lastModified>2015-05-21T18:19:24-05:00</ns1:lastModified>
        <ns1:parent>
            <ns1:name>MWS2_CDCR2</ns1:name>
            <ns1:href>project/9</ns1:href>
            <ns1:id>9</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Project+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:parent>
        <ns1:slot>7890a1c9-2153-4224-9ca2-e73c1064ab06</ns1:slot>
        <ns1:version>8</ns1:version>
        <ns1:latest>false</ns1:latest>
        <ns1:publishComment></ns1:publishComment>
        <ns1:slotId>186</ns1:slotId>
        <ns1:publisher>
            <ns1:name>dridley</ns1:name>
            <ns1:href>user/8</ns1:href>
            <ns1:id>8</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.User+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:publisher>
        <ns1:versionStatus>active</ns1:versionStatus>
        <ns1:checkoutAllowed>false</ns1:checkoutAllowed>
        <ns1:headAllowed>false</ns1:headAllowed>
        <ns1:operatingSystem>Windows</ns1:operatingSystem>
        <ns1:enableExtensions>false</ns1:enableExtensions>
        <ns1:body># Support multiple deployment environments
$environment = $ENVIRONMENT

$script = @'
Add-Type -AssemblyName System.Web

function set-globalvariable($key,$val) {
	__ENVCODE__
	Invoke-WebRequest -Method PUT -Uri http://10.5.4.40:4001/v2/keys/$($key)?value=$([System.Web.HttpUtility]::UrlEncode($($val))) -UseBasicParsing
}

function get-globalvariable($key) {
	__ENVCODE__
	$resp = Invoke-RestMethod -Method GET -Uri http://10.5.4.40:4001/v2/keys/$key
	return $resp.node
}

function get-globalvariable_json($key) {
	__ENVCODE__
	$resp = Invoke-RestMethod -Method GET -Uri http://10.5.4.40:4001/v2/keys/$key
	return ConvertFrom-Json $resp.node.value
}


function connect-deploymentshare
{
    #$share = get-globalvariable 'Global/DeploymentShare'
    #$username = get-globalvariable 'Global/DeploymentUsername'
    #$password = get-globalvariable 'Global/DeploymentPassword'
    
    #$secure_pwd = convertto-securestring $password.value -asplaintext -force
    
    #$dcred = new-object -typename System.Management.Automation.PSCredential -argumentlist $username.value, $secure_pwd
    #$d = New-PSDrive -Name 'Y' -PSProvider FileSystem -Root $share.value -Credential $dcred -Scope Global -persist 

	# [DRidley] updated to utilise dynamic drive letter 'drv' &amp; NET USE instead, as New-PSDrive always fails when run a 2nd time
	$share = 	(get-globalvariable(&quot;Global\DeploymentShare&quot;)).value
    $username = (get-globalvariable(&quot;Global\DeploymentUsername&quot;)).value
    $password = (get-globalvariable(&quot;Global\DeploymentPassword&quot;)).value
    
	$global:drv = dir function:[m-z]: -Name | Where { -Not (test-path $_ )} | select -first 1
	$d = net use $drv $share /user:$username $password
    
    #If (Test-Path $drv) {Write-Host &quot;$drv = Yes&quot;} Else {Write-Host &quot;$drv = No&quot;; EXIT}
}


function disconnect-deploymentshare
{
    #$d = Remove-PSDrive -Name 'Y'
    $d = net use $drv /delete
}


# Stiven: cater for the introduction of deploy folder subfolders as a result of introducing SVN
#         assumption is computer related folders will always and only be in the deployScript folder
function get-files($computer){
    connect-deploymentshare
    
    # Copy Common Files
    Copy-Item &quot;$drv\DeployScript\Common\*&quot; .\ -Recurse -force -Verbose
    Copy-Item &quot;$drv\DeployInstall\Common\*&quot; .\ -Recurse -force -Verbose
        
    # Copy Computer Specific files
    $c = $computer
    if( Test-Path -Path (&quot;$drv\DeployScript\&quot; + $c)){
    	$p = &quot;$drv\DeployScript\&quot; + $c + &quot;\*&quot;
    	Copy-Item $p .\ -Recurse -force -Verbose
    }else{
    	write-output &quot;computername folder does not exist - $c&quot;
    }
    
    disconnect-deploymentshare
}


function Get-AppFiles($appname){
   connect-deploymentshare

   $rootFolder = &quot;$drv\DeployScript\&quot;
   Copy-Files $rootFolder $appname

   $rootFolder = &quot;$drv\DeployInstall\&quot;
   Copy-Files $rootFolder $appname

   disconnect-deploymentshare
}

# Stiven: cater for the introduction of deploy folder subfolders as a result of introducing SVN
function Copy-Files($rootfolder, $appname){
    $p = $rootFolder + $appname + &quot;\*&quot;
    if(Test-Path -Path ($rootFolder + $appname)){
        Write-Output &quot;Copying Application files from $rootFolder$($appname)&quot;
        Copy-Item $p .\ -Recurse -force
    } Else {
        Write-Error &quot;Application folder $appname does not exist&quot; -ErrorAction SilentlyContinue
    }  
}

'@


# Perform a replace on __ENVCODE__ to support multiple AD environments
if($environment -eq $null){
	write-output &quot;Generating script for default environment&quot;
	$script = $script -replace &quot;__ENVCODE__&quot;,&quot;&quot;
}else{
	write-output &quot;Generating script for [$environment] environment&quot;
	$newstring = $('$key= &quot;[' + $environment + ']/$key&quot;')
    	$script = $script -replace &quot;__ENVCODE__&quot;,$newstring
}

$script | out-file &quot;GlobalRepository.ps1&quot;

# Load Common functions
#. .\GlobalRepository.ps1
# download common files and computer specific files
#get-files</ns1:body>
        <ns1:type>Guest</ns1:type>
        <ns1:language>
            <ns1:name>powershell</ns1:name>
            <ns1:href>scriptlanguage/5</ns1:href>
            <ns1:id>5</ns1:id>
            <ns1:rel>down</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.ScriptLanguage+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:language>
        <ns1:runAsAdmin>false</ns1:runAsAdmin>
        <ns1:timeout>3600</ns1:timeout>
        <ns1:retries>0</ns1:retries>
        <ns1:delay>0</ns1:delay>
        <ns1:errorAction>Abort</ns1:errorAction>
        <ns1:rebootRequired>false</ns1:rebootRequired>
        <ns1:variable>
            <ns1:name>ENVIRONMENT</ns1:name>
            <ns1:id>453</ns1:id>
            <ns1:description></ns1:description>
            <ns1:uuid>100213b6-cd6e-4f7d-8d1d-940cad781360</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath></ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:displayName>ENVIRONMENT</ns1:displayName>
            <ns1:readable>true</ns1:readable>
            <ns1:writable>true</ns1:writable>
            <ns1:minRequired>0</ns1:minRequired>
            <ns1:maxAllowed>1</ns1:maxAllowed>
            <ns1:validator/>
            <ns1:propertyType>
                <ns1:name>string-any</ns1:name>
                <ns1:href>propertytype/4</ns1:href>
                <ns1:id>4</ns1:id>
                <ns1:type>application/com.servicemesh.agility.api.PropertyType+xml</ns1:type>
            </ns1:propertyType>
            <ns1:assetPropertyLinkId>882764b4-65f6-4f47-a170-9934b4780aee</ns1:assetPropertyLinkId>
        </ns1:variable>
        <ns1:runOnProvisionOnly>false</ns1:runOnProvisionOnly>
    </ns1:pendingAsset>
    <ns1:pendingAsset xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="ns1:Script">
        <ns1:name>MWS2R2 - AD Rename Computer</ns1:name>
        <ns1:id>262</ns1:id>
        <ns1:description></ns1:description>
        <ns1:uuid>fb548fad-cacb-49ef-a1fd-b82f84a3414f</ns1:uuid>
        <ns1:assetType>
            <ns1:name>script</ns1:name>
            <ns1:href>assettype/2</ns1:href>
            <ns1:id>2</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.AssetType+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:assetType>
        <ns1:top>false</ns1:top>
        <ns1:assetPath>/Root/MWS2/MWS2_CDCR2</ns1:assetPath>
        <ns1:detailedAssetPath>/Root:#ID#1:#TYPE#VMContainer/MWS2:#ID#8:#TYPE#VMContainer/MWS2_CDCR2:#ID#9:#TYPE#VMProject</ns1:detailedAssetPath>
        <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
        <ns1:removable>true</ns1:removable>
        <ns1:domain>
            <ns1:name>domain1</ns1:name>
            <ns1:href>domain/1</ns1:href>
            <ns1:id>1</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Domain+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:domain>
        <ns1:creator>
            <ns1:name>dridley</ns1:name>
            <ns1:href>user/8</ns1:href>
            <ns1:id>8</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.User+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:creator>
        <ns1:created>2015-05-20T22:13:28-05:00</ns1:created>
        <ns1:lockType>0</ns1:lockType>
        <ns1:lastModified>2015-05-20T22:14:08-05:00</ns1:lastModified>
        <ns1:parent>
            <ns1:name>MWS2_CDCR2</ns1:name>
            <ns1:href>project/9</ns1:href>
            <ns1:id>9</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Project+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:parent>
        <ns1:slot>c81389ef-c101-4448-a7e4-1804b50696c2</ns1:slot>
        <ns1:version>4</ns1:version>
        <ns1:latest>false</ns1:latest>
        <ns1:publishComment></ns1:publishComment>
        <ns1:slotId>187</ns1:slotId>
        <ns1:publisher>
            <ns1:name>dridley</ns1:name>
            <ns1:href>user/8</ns1:href>
            <ns1:id>8</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.User+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:publisher>
        <ns1:versionStatus>active</ns1:versionStatus>
        <ns1:checkoutAllowed>false</ns1:checkoutAllowed>
        <ns1:headAllowed>false</ns1:headAllowed>
        <ns1:operatingSystem>Windows</ns1:operatingSystem>
        <ns1:enableExtensions>false</ns1:enableExtensions>
        <ns1:body>#	ScriptName: 	AD Rename Computer
#	Author: 	Mark Freeman
#	Required Variables: COMPONENTID, INSTANCEID
#	Description:
#
#	Renames a computer based on MWS2 naming standard
#	Registers the computername and IP address in the key value store
#	Downloads common and computer specific files from the deployment file share
#	Resets the local administrator account password to a random value
#	Registers the password in the key value share
#	Updates the instance name in Cloud Provider
#
#	2015/05/21	DRidley		-Updated Rename Computer section to check if IstanceID has already been deployed


. .\GlobalRepository.ps1


$ComponentID = $COMPONENTID
$InstanceID =  $INSTANCEID
$DomainFQDN =  (get-globalvariable(&quot;Global\DomainFQDN&quot;)).value

$CustomerID = (get-globalvariable &quot;Global/CustomerID&quot;).value
$LocationID = (get-globalvariable &quot;Global/LocationID&quot;).value

# Set Primary &amp; Secondary DNS on active NIC. This is required to check if InstanceID has already been deployed
$PrimaryDNS =   (get-globalvariable(&quot;AD\PrimaryDNS&quot;)).value
$SecondaryDNS = (get-globalvariable(&quot;AD\SecondaryDNS&quot;)).value
$NICindex = Get-NetAdapter -physical | where status -eq 'up' | Select 'Name' -ExpandProperty ifIndex
Write-Output &quot;Setting $PrimaryDNS and $SecondaryDNS as DNS servers on active NIC&quot;
Set-DNSClientServerAddress -InterfaceIndex $NICindex -ServerAddresses ($PrimaryDNS,$SecondaryDNS)


# Rename Computer
$Computername = $($CustomerID + $ComponentID + $LocationID + $InstanceID + &quot;W&quot;)
Write-Output &quot;Checking if $Computername has been previously deployed...&quot;
If (Test-Connection -Computername &quot;$Computername.$DomainFQDN&quot; -Count 2 -Quiet)
{
	Write-Output &quot;ERROR: $Computername is already deployed! Exiting...&quot;
	EXIT 1
}
Else
{
	Write-Output &quot;$ComponentID-$InstanceID does not appear to have been previously deployed. Continuing...&quot;
	Write-Output &quot;Setting computername to $Computername&quot;
	Rename-Computer -NewName $Computername -force
}


write-output &quot;Storing IP Address in key value store&quot;
$key = 'Network/{0}' -f $Computername
$ip = Get-NetIPAddress | Where-Object -FilterScript {$_.AddressFamily -eq &quot;IPv4&quot; } | Where-Object -FilterScript {$_.IPAddress -ne &quot;127.0.0.1&quot;}
$ipa = $ip.IPAddress
Set-globalvariable $key $ipa

write-output &quot;Downloading common files and computer files from repository&quot;

get-files &quot;$ComponentID$InstanceID&quot;

write-output &quot;Resetting local administrator password&quot;
. .\New-RandomPassword.ps1
$password = new-randompassword -PasswordLength 10
$adminUser = [ADSI] &quot;WinNT://./SOE-LOAD,User&quot;
$adminUser.SetPassword($password)
Set-globalvariable &quot;Administrator/$Computername&quot; $password

#register name tag
#write-output &quot;Registering AWS name tag&quot;
#$aid  = Invoke-RestMethod -Uri http://169.254.169.254/latest/meta-data/instance-id
#$uri = &quot;http://10.0.0.23:5000/p1/&quot; + $aid + &quot;?tagname=&quot; + $Computername 
#Invoke-RestMethod -Uri $uri -Method Put


write-output &quot;Restarting computer&quot;

</ns1:body>
        <ns1:type>Guest</ns1:type>
        <ns1:language>
            <ns1:name>powershell</ns1:name>
            <ns1:href>scriptlanguage/5</ns1:href>
            <ns1:id>5</ns1:id>
            <ns1:rel>down</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.ScriptLanguage+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:language>
        <ns1:runAsAdmin>false</ns1:runAsAdmin>
        <ns1:timeout>3600</ns1:timeout>
        <ns1:retries>0</ns1:retries>
        <ns1:delay>0</ns1:delay>
        <ns1:errorAction>Abort</ns1:errorAction>
        <ns1:rebootRequired>true</ns1:rebootRequired>
        <ns1:variable>
            <ns1:name>COMPONENTID</ns1:name>
            <ns1:id>443</ns1:id>
            <ns1:description>COMPONENTID</ns1:description>
            <ns1:uuid>5158c63f-5af9-491c-96b4-81c97c7f86d5</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath></ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:displayName>COMPONENTID</ns1:displayName>
            <ns1:readable>true</ns1:readable>
            <ns1:writable>true</ns1:writable>
            <ns1:minRequired>0</ns1:minRequired>
            <ns1:maxAllowed>1</ns1:maxAllowed>
            <ns1:validator/>
            <ns1:propertyType>
                <ns1:name>string-any</ns1:name>
                <ns1:href>propertytype/4</ns1:href>
                <ns1:id>4</ns1:id>
                <ns1:type>application/com.servicemesh.agility.api.PropertyType+xml</ns1:type>
            </ns1:propertyType>
            <ns1:assetPropertyLinkId>de0200c9-8810-412c-8fd6-0c33775f9bdb</ns1:assetPropertyLinkId>
        </ns1:variable>
        <ns1:variable>
            <ns1:name>INSTANCEID</ns1:name>
            <ns1:id>444</ns1:id>
            <ns1:description>INSTANCEID</ns1:description>
            <ns1:uuid>023e7fbf-a627-4a28-99f4-7d1cf65841de</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath></ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:displayName>INSTANCEID</ns1:displayName>
            <ns1:readable>true</ns1:readable>
            <ns1:writable>true</ns1:writable>
            <ns1:minRequired>0</ns1:minRequired>
            <ns1:maxAllowed>1</ns1:maxAllowed>
            <ns1:validator/>
            <ns1:propertyType>
                <ns1:name>string-any</ns1:name>
                <ns1:href>propertytype/4</ns1:href>
                <ns1:id>4</ns1:id>
                <ns1:type>application/com.servicemesh.agility.api.PropertyType+xml</ns1:type>
            </ns1:propertyType>
            <ns1:assetPropertyLinkId>24d648a9-5594-414a-8982-443a1d37910d</ns1:assetPropertyLinkId>
        </ns1:variable>
        <ns1:runOnProvisionOnly>false</ns1:runOnProvisionOnly>
    </ns1:pendingAsset>
    <ns1:pendingAsset xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="ns1:Script">
        <ns1:name>MWS2R2 - AD Add To Domain</ns1:name>
        <ns1:id>233</ns1:id>
        <ns1:description></ns1:description>
        <ns1:uuid>610a72d9-8165-4970-86f0-58ba43b6d6f3</ns1:uuid>
        <ns1:assetType>
            <ns1:name>script</ns1:name>
            <ns1:href>assettype/2</ns1:href>
            <ns1:id>2</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.AssetType+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:assetType>
        <ns1:top>false</ns1:top>
        <ns1:assetPath>/Root/MWS2/MWS2_CDCR2</ns1:assetPath>
        <ns1:detailedAssetPath>/Root:#ID#1:#TYPE#VMContainer/MWS2:#ID#8:#TYPE#VMContainer/MWS2_CDCR2:#ID#9:#TYPE#VMProject</ns1:detailedAssetPath>
        <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
        <ns1:removable>true</ns1:removable>
        <ns1:domain>
            <ns1:name>domain1</ns1:name>
            <ns1:href>domain/1</ns1:href>
            <ns1:id>1</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Domain+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:domain>
        <ns1:creator>
            <ns1:name>mfreeman</ns1:name>
            <ns1:href>user/12</ns1:href>
            <ns1:id>12</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.User+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:creator>
        <ns1:created>2015-04-16T20:07:22-05:00</ns1:created>
        <ns1:lockType>0</ns1:lockType>
        <ns1:lastModified>2015-04-16T20:12:30-05:00</ns1:lastModified>
        <ns1:parent>
            <ns1:name>MWS2_CDCR2</ns1:name>
            <ns1:href>project/9</ns1:href>
            <ns1:id>9</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Project+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:parent>
        <ns1:slot>d24bbade-b665-4ced-bb6a-397057153d30</ns1:slot>
        <ns1:version>2</ns1:version>
        <ns1:latest>false</ns1:latest>
        <ns1:publishComment></ns1:publishComment>
        <ns1:slotId>188</ns1:slotId>
        <ns1:publisher>
            <ns1:name>mfreeman</ns1:name>
            <ns1:href>user/12</ns1:href>
            <ns1:id>12</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.User+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:publisher>
        <ns1:versionStatus>active_checkedout</ns1:versionStatus>
        <ns1:checkoutAllowed>false</ns1:checkoutAllowed>
        <ns1:headAllowed>false</ns1:headAllowed>
        <ns1:operatingSystem>Windows</ns1:operatingSystem>
        <ns1:enableExtensions>false</ns1:enableExtensions>
        <ns1:body>#	ScriptName: 	AD Add to Domain
#	Author: 	Mark Freeman
#	Required Variables: None
#	Description:
#
#	Adds a computer to the MWS2 Resource Domain


. .\GlobalRepository.ps1

$domainname = (get-globalvariable &quot;Global\DomainFQDN&quot;).value
$domainNB = (get-globalvariable &quot;Global\DomainNetBIOS&quot;).value
$short_username = (get-globalvariable &quot;Global\DeploymentUsername&quot;).value
$username = &quot;$domainNB\$short_username&quot;
$password = (get-globalvariable &quot;Global\DeploymentPassword&quot;).value
$dn = (get-globalvariable &quot;AD\DistinguishedName&quot;).value

$pdns = (get-globalvariable &quot;AD\PrimaryDNS&quot;).value
$sdns = (get-globalvariable &quot;AD\SecondaryDNS&quot;).value

$computername = $env:COMPUTERNAME
$ouPath = &quot;OU=servers,OU=customer,$dn&quot;

if ($computername.ToLower().Contains(&quot;dbs&quot;)){
    $ouPath=&quot;OU=Database,$ouPath&quot;
}

if ($computername.ToLower().Contains(&quot;mas&quot;)){
    $ouPath=&quot;OU=Exchange,$ouPath&quot;
}

$na=Get-NetAdapter -Physical | where status -eq 'up'
Set-DnsClientServerAddress -InterfaceIndex $na.ifIndex -ServerAddresses ($pdns,$sdns)

$secure_pwd = convertto-securestring $password -asplaintext -force
$djcred = new-object -typename System.Management.Automation.PSCredential `
         -argumentlist $username, $secure_pwd

Add-Computer -DomainName $domainname -Credential $djcred -OUPath $ouPath -Force
write-output &quot;Joined domain.&quot;


</ns1:body>
        <ns1:type>Guest</ns1:type>
        <ns1:language>
            <ns1:name>powershell</ns1:name>
            <ns1:href>scriptlanguage/5</ns1:href>
            <ns1:id>5</ns1:id>
            <ns1:rel>down</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.ScriptLanguage+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:language>
        <ns1:runAsAdmin>false</ns1:runAsAdmin>
        <ns1:timeout>3600</ns1:timeout>
        <ns1:retries>0</ns1:retries>
        <ns1:delay>0</ns1:delay>
        <ns1:errorAction>Continue</ns1:errorAction>
        <ns1:rebootRequired>true</ns1:rebootRequired>
        <ns1:runOnProvisionOnly>false</ns1:runOnProvisionOnly>
    </ns1:pendingAsset>
    <ns1:pendingAsset xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="ns1:Package">
        <ns1:name>MWS2R2 - AD Rename and Add to Domain</ns1:name>
        <ns1:id>72</ns1:id>
        <ns1:description></ns1:description>
        <ns1:uuid>1b7093bb-c335-4d1f-bed2-a7a10200632e</ns1:uuid>
        <ns1:assetType>
            <ns1:name>package</ns1:name>
            <ns1:href>assettype/3</ns1:href>
            <ns1:id>3</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.AssetType+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:assetType>
        <ns1:top>false</ns1:top>
        <ns1:assetPath>/Root/MWS2/MWS2_CDCR2</ns1:assetPath>
        <ns1:detailedAssetPath>/Root:#ID#1:#TYPE#VMContainer/MWS2:#ID#8:#TYPE#VMContainer/MWS2_CDCR2:#ID#9:#TYPE#VMProject</ns1:detailedAssetPath>
        <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
        <ns1:removable>true</ns1:removable>
        <ns1:domain>
            <ns1:name>domain1</ns1:name>
            <ns1:href>domain/1</ns1:href>
            <ns1:id>1</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Domain+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:domain>
        <ns1:creator>
            <ns1:name>mkrynina</ns1:name>
            <ns1:href>user/6</ns1:href>
            <ns1:id>6</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.User+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:creator>
        <ns1:created>2015-05-04T18:27:20-05:00</ns1:created>
        <ns1:lockType>0</ns1:lockType>
        <ns1:lastModified>2015-05-04T19:05:43-05:00</ns1:lastModified>
        <ns1:parent>
            <ns1:name>MWS2_CDCR2</ns1:name>
            <ns1:href>project/9</ns1:href>
            <ns1:id>9</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Project+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:parent>
        <ns1:slot>4f2a9e8d-2a66-41b9-adfc-f19e59a3f24b</ns1:slot>
        <ns1:version>4</ns1:version>
        <ns1:latest>false</ns1:latest>
        <ns1:publishComment>removed product specific defaults from the package variables</ns1:publishComment>
        <ns1:slotId>185</ns1:slotId>
        <ns1:publisher>
            <ns1:name>mkrynina</ns1:name>
            <ns1:href>user/6</ns1:href>
            <ns1:id>6</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.User+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:publisher>
        <ns1:versionStatus>active</ns1:versionStatus>
        <ns1:checkoutAllowed>false</ns1:checkoutAllowed>
        <ns1:headAllowed>false</ns1:headAllowed>
        <ns1:operatingSystem>Windows</ns1:operatingSystem>
        <ns1:install>
            <ns1:name>MWS2R2 - AD Global Repository</ns1:name>
            <ns1:href>script/228</ns1:href>
            <ns1:id>268</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Script+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:install>
        <ns1:install>
            <ns1:name>MWS2R2 - AD Rename Computer</ns1:name>
            <ns1:href>script/229</ns1:href>
            <ns1:id>262</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Script+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:install>
        <ns1:install>
            <ns1:name>MWS2R2 - AD Add To Domain</ns1:name>
            <ns1:href>script/230</ns1:href>
            <ns1:id>233</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Script+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:install>
        <ns1:variable>
            <ns1:name>INSTANCEID</ns1:name>
            <ns1:id>431</ns1:id>
            <ns1:description></ns1:description>
            <ns1:uuid>b26b9e43-9f1a-45c9-b626-a0997cdfdf2e</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath></ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:displayName>INSTANCEID</ns1:displayName>
            <ns1:readable>true</ns1:readable>
            <ns1:writable>true</ns1:writable>
            <ns1:minRequired>0</ns1:minRequired>
            <ns1:maxAllowed>1</ns1:maxAllowed>
            <ns1:validator/>
            <ns1:propertyType>
                <ns1:name>string-any</ns1:name>
                <ns1:href>propertytype/4</ns1:href>
                <ns1:id>4</ns1:id>
                <ns1:type>application/com.servicemesh.agility.api.PropertyType+xml</ns1:type>
            </ns1:propertyType>
            <ns1:assetPropertyLinkId>a033d7a6-a3e2-46bc-88c1-4150cadc8c07</ns1:assetPropertyLinkId>
        </ns1:variable>
        <ns1:variable>
            <ns1:name>COMPONENTID</ns1:name>
            <ns1:id>432</ns1:id>
            <ns1:description>COMPONENTID</ns1:description>
            <ns1:uuid>1dd2d48e-590c-4044-8875-6726a52bcf4b</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath></ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:displayName>COMPONENTID</ns1:displayName>
            <ns1:readable>true</ns1:readable>
            <ns1:writable>true</ns1:writable>
            <ns1:minRequired>0</ns1:minRequired>
            <ns1:maxAllowed>1</ns1:maxAllowed>
            <ns1:validator/>
            <ns1:propertyType>
                <ns1:name>string-any</ns1:name>
                <ns1:href>propertytype/4</ns1:href>
                <ns1:id>4</ns1:id>
                <ns1:type>application/com.servicemesh.agility.api.PropertyType+xml</ns1:type>
            </ns1:propertyType>
            <ns1:assetPropertyLinkId>4bd256a6-1c17-4f64-9c1d-29f4c27a614f</ns1:assetPropertyLinkId>
        </ns1:variable>
    </ns1:pendingAsset>
    <ns1:pendingAsset xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="ns1:Script">
        <ns1:name>MWS2R2 - CM2012 - Static Vars Primary</ns1:name>
        <ns1:id>163</ns1:id>
        <ns1:description>Sets variables used in subsequent scripts.</ns1:description>
        <ns1:uuid>8dc044ee-bed1-4287-892f-d48de074d812</ns1:uuid>
        <ns1:assetType>
            <ns1:name>script</ns1:name>
            <ns1:href>assettype/2</ns1:href>
            <ns1:id>2</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.AssetType+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:assetType>
        <ns1:top>false</ns1:top>
        <ns1:assetPath>/Root/MWS2/MWS2_CDCR2</ns1:assetPath>
        <ns1:detailedAssetPath>/Root:#ID#1:#TYPE#VMContainer/MWS2:#ID#8:#TYPE#VMContainer/MWS2_CDCR2:#ID#9:#TYPE#VMProject</ns1:detailedAssetPath>
        <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
        <ns1:removable>true</ns1:removable>
        <ns1:domain>
            <ns1:name>domain1</ns1:name>
            <ns1:href>domain/1</ns1:href>
            <ns1:id>1</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Domain+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:domain>
        <ns1:creator>
            <ns1:name>dridley</ns1:name>
            <ns1:href>user/8</ns1:href>
            <ns1:id>8</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.User+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:creator>
        <ns1:created>2015-02-19T19:47:09-06:00</ns1:created>
        <ns1:lockType>0</ns1:lockType>
        <ns1:lastModified>2015-04-30T20:12:18-05:00</ns1:lastModified>
        <ns1:parent>
            <ns1:name>MWS2_CDCR2</ns1:name>
            <ns1:href>project/9</ns1:href>
            <ns1:id>9</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Project+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:parent>
        <ns1:version>-1</ns1:version>
        <ns1:latest>false</ns1:latest>
        <ns1:versionStatus>inprogress</ns1:versionStatus>
        <ns1:checkoutAllowed>false</ns1:checkoutAllowed>
        <ns1:headAllowed>false</ns1:headAllowed>
        <ns1:operatingSystem>Windows</ns1:operatingSystem>
        <ns1:enableExtensions>false</ns1:enableExtensions>
        <ns1:body># Load Common functions
. .\Logging.ps1
. .\GlobalRepository.ps1
. .\LaunchProcess.ps1
. .\FilesUtility.ps1

# get current script location
$scriptPath = split-path -parent $MyInvocation.MyCommand.Definition
$scriptName = $MyInvocation.MyCommand.Name
 
ConfigureLogging $scriptPath $scriptName
 
#########################################################################
# Main
#########################################################################
 
 
Log &quot;**** Starting: Static Variables... ****&quot;
Log &quot;`n&quot;

If ($CM_SITECODE -eq $NULL) 		{Write-Host 'ERROR: $CM_SITECODE not defined'; EXIT 1}
If ($CM_SITEDESCRIPTION -eq $NULL) 	{Write-Host 'ERROR: $CM_SITEDESCRIPTION not defined'; EXIT 1}
If ($CM_SMSINSTALLDIR -eq $NULL) 	{Write-Host 'ERROR: $CM_SMSINSTALLDIR not defined'; EXIT 1}
If ($SQL_COMPONENTID -eq $NULL) 	{Write-Host 'ERROR: $SQL_COMPONENTID not defined'; EXIT 1}
If ($SQL_INSTANCEID -eq $NULL) 		{Write-Host 'ERROR: $SQL_INSTANCEID not defined'; EXIT 1}
If ($SQL_DATAFILEPATH -eq $NULL) 	{Write-Host 'ERROR: $SQL_DATAFILEPATH not defined'; EXIT 1}
If ($SQL_LOGFILEPATH -eq $NULL) 	{Write-Host 'ERROR: $SQL_LOGFILEPATH not defined'; EXIT 1}
If ($SQL_INSTANCENAME -eq $NULL) 	{Write-Host 'ERROR: $SQL_INSTANCENAME not defined'; EXIT 1}


Log &quot;Set Primary Specific Environment Variables...&quot;
SETX CM_SiteCode 		$CM_SITECODE /M
SETX CM_SiteDescription $CM_SITEDESCRIPTION /M
SETX CM_SMSInstallDir 	$CM_SMSINSTALLDIR /M
SETX SQL_ComponentID 	$SQL_COMPONENTID /M
SETX SQL_InstanceID 	$SQL_INSTANCEID /M
SETX SQL_DataFilePath	$SQL_DATAFILEPATH /M
SETX SQL_LogFilePath 	$SQL_LOGFILEPATH /M
SETX SQL_InstanceName	$SQL_INSTANCENAME /M


Log &quot;**** Finished: Static Variables... ****&quot;</ns1:body>
        <ns1:type>Guest</ns1:type>
        <ns1:language>
            <ns1:name>powershell</ns1:name>
            <ns1:href>scriptlanguage/5</ns1:href>
            <ns1:id>5</ns1:id>
            <ns1:rel>down</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.ScriptLanguage+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:language>
        <ns1:runAsAdmin>false</ns1:runAsAdmin>
        <ns1:timeout>1800</ns1:timeout>
        <ns1:retries>0</ns1:retries>
        <ns1:delay>0</ns1:delay>
        <ns1:errorAction>Abort</ns1:errorAction>
        <ns1:rebootRequired>true</ns1:rebootRequired>
        <ns1:variable>
            <ns1:name>CM_SMSINSTALLDIR</ns1:name>
            <ns1:id>240</ns1:id>
            <ns1:description>Folder where ConfigMgr will be installed</ns1:description>
            <ns1:uuid>92fc0f7f-bf9d-4ad0-bb31-fe7eee95f3e0</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath></ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:displayName>CM_SMSINSTALLDIR</ns1:displayName>
            <ns1:readable>true</ns1:readable>
            <ns1:writable>true</ns1:writable>
            <ns1:minRequired>1</ns1:minRequired>
            <ns1:maxAllowed>1</ns1:maxAllowed>
            <ns1:validator/>
            <ns1:defaultValue>
                <ns1:id>15170</ns1:id>
                <ns1:name></ns1:name>
                <ns1:encrypted>false</ns1:encrypted>
                <ns1:overridable>true</ns1:overridable>
                <ns1:propertyType>
                    <ns1:name>string-any</ns1:name>
                    <ns1:href>/propertytype/4</ns1:href>
                    <ns1:id>4</ns1:id>
                    <ns1:rel>up</ns1:rel>
                    <ns1:type>application/com.servicemesh.agility.api.PropertyType+xml</ns1:type>
                    <ns1:position>0</ns1:position>
                </ns1:propertyType>
                <ns1:stringValue>F:\SMS_ConfigMgr</ns1:stringValue>
            </ns1:defaultValue>
            <ns1:propertyType>
                <ns1:name>string-any</ns1:name>
                <ns1:href>propertytype/4</ns1:href>
                <ns1:id>4</ns1:id>
                <ns1:type>application/com.servicemesh.agility.api.PropertyType+xml</ns1:type>
            </ns1:propertyType>
            <ns1:assetPropertyLinkId>14d54ae3-f60b-4457-a2af-aebeedd254de</ns1:assetPropertyLinkId>
        </ns1:variable>
        <ns1:variable>
            <ns1:name>CM_SITEDESCRIPTION</ns1:name>
            <ns1:id>241</ns1:id>
            <ns1:description>Description of ConfigMgr server</ns1:description>
            <ns1:uuid>8596b2f0-0a25-42d9-9b3a-25abe954aa73</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath></ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:displayName>CM_SITEDESCRIPTION</ns1:displayName>
            <ns1:readable>true</ns1:readable>
            <ns1:writable>true</ns1:writable>
            <ns1:minRequired>1</ns1:minRequired>
            <ns1:maxAllowed>1</ns1:maxAllowed>
            <ns1:validator/>
            <ns1:defaultValue>
                <ns1:id>14011</ns1:id>
                <ns1:name>CM_SITEDESCRIPTION</ns1:name>
                <ns1:encrypted>false</ns1:encrypted>
                <ns1:overridable>true</ns1:overridable>
                <ns1:propertyType>
                    <ns1:name>string-any</ns1:name>
                    <ns1:href>/propertytype/4</ns1:href>
                    <ns1:id>4</ns1:id>
                    <ns1:rel>up</ns1:rel>
                    <ns1:type>application/com.servicemesh.agility.api.PropertyType+xml</ns1:type>
                    <ns1:position>0</ns1:position>
                </ns1:propertyType>
                <ns1:propertyDefinition xsi:type="ns1:Link">
                    <ns1:name>CM_SITEDESCRIPTION</ns1:name>
                    <ns1:href>/propertydefinition/241</ns1:href>
                    <ns1:id>241</ns1:id>
                    <ns1:rel>up</ns1:rel>
                    <ns1:type>application/com.servicemesh.agility.api.PropertyDefinition+xml</ns1:type>
                    <ns1:position>0</ns1:position>
                </ns1:propertyDefinition>
                <ns1:stringValue>&lt;place_holder&gt;</ns1:stringValue>
            </ns1:defaultValue>
            <ns1:propertyType>
                <ns1:name>string-any</ns1:name>
                <ns1:href>propertytype/4</ns1:href>
                <ns1:id>4</ns1:id>
                <ns1:type>application/com.servicemesh.agility.api.PropertyType+xml</ns1:type>
            </ns1:propertyType>
            <ns1:assetPropertyLinkId>fc4b4529-aca9-40c5-871e-2abc2b8d66dc</ns1:assetPropertyLinkId>
        </ns1:variable>
        <ns1:variable>
            <ns1:name>CM_SITECODE</ns1:name>
            <ns1:id>242</ns1:id>
            <ns1:description>Sitecode of ConfigMgr server</ns1:description>
            <ns1:uuid>38d53275-895f-4caa-abd0-56aa517cfc1e</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath></ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:displayName>CM_SITECODE</ns1:displayName>
            <ns1:readable>true</ns1:readable>
            <ns1:writable>true</ns1:writable>
            <ns1:minRequired>1</ns1:minRequired>
            <ns1:maxAllowed>1</ns1:maxAllowed>
            <ns1:validator/>
            <ns1:defaultValue>
                <ns1:id>2579</ns1:id>
                <ns1:name>CM_SITECODE</ns1:name>
                <ns1:encrypted>false</ns1:encrypted>
                <ns1:overridable>true</ns1:overridable>
                <ns1:propertyType>
                    <ns1:name>string-any</ns1:name>
                    <ns1:href>/propertytype/4</ns1:href>
                    <ns1:id>4</ns1:id>
                    <ns1:rel>up</ns1:rel>
                    <ns1:type>application/com.servicemesh.agility.api.PropertyType+xml</ns1:type>
                    <ns1:position>0</ns1:position>
                </ns1:propertyType>
                <ns1:propertyDefinition xsi:type="ns1:Link">
                    <ns1:name>CM_SITECODE</ns1:name>
                    <ns1:href>/propertydefinition/242</ns1:href>
                    <ns1:id>242</ns1:id>
                    <ns1:rel>up</ns1:rel>
                    <ns1:type>application/com.servicemesh.agility.api.PropertyDefinition+xml</ns1:type>
                    <ns1:position>0</ns1:position>
                </ns1:propertyDefinition>
                <ns1:stringValue>&lt;place_holder&gt;</ns1:stringValue>
            </ns1:defaultValue>
            <ns1:propertyType>
                <ns1:name>string-any</ns1:name>
                <ns1:href>propertytype/4</ns1:href>
                <ns1:id>4</ns1:id>
                <ns1:type>application/com.servicemesh.agility.api.PropertyType+xml</ns1:type>
            </ns1:propertyType>
            <ns1:assetPropertyLinkId>cf179811-b0f8-4fde-977b-ee4b301c14f0</ns1:assetPropertyLinkId>
        </ns1:variable>
        <ns1:variable>
            <ns1:name>SQL_COMPONENTID</ns1:name>
            <ns1:id>244</ns1:id>
            <ns1:description>Agility ComponentID of SQL server</ns1:description>
            <ns1:uuid>f5ae8dfd-2556-4acf-85ad-048b7b59979b</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath></ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:displayName>SQL_COMPONENTID</ns1:displayName>
            <ns1:readable>true</ns1:readable>
            <ns1:writable>true</ns1:writable>
            <ns1:minRequired>1</ns1:minRequired>
            <ns1:maxAllowed>1</ns1:maxAllowed>
            <ns1:validator/>
            <ns1:defaultValue>
                <ns1:id>10641</ns1:id>
                <ns1:name>SQL_COMPONENTID</ns1:name>
                <ns1:encrypted>false</ns1:encrypted>
                <ns1:overridable>true</ns1:overridable>
                <ns1:propertyType>
                    <ns1:name>string-any</ns1:name>
                    <ns1:href>/propertytype/4</ns1:href>
                    <ns1:id>4</ns1:id>
                    <ns1:rel>up</ns1:rel>
                    <ns1:type>application/com.servicemesh.agility.api.PropertyType+xml</ns1:type>
                    <ns1:position>0</ns1:position>
                </ns1:propertyType>
                <ns1:propertyDefinition xsi:type="ns1:Link">
                    <ns1:name>SQL_COMPONENTID</ns1:name>
                    <ns1:href>/propertydefinition/244</ns1:href>
                    <ns1:id>244</ns1:id>
                    <ns1:rel>up</ns1:rel>
                    <ns1:type>application/com.servicemesh.agility.api.PropertyDefinition+xml</ns1:type>
                    <ns1:position>0</ns1:position>
                </ns1:propertyDefinition>
                <ns1:stringValue>CNN</ns1:stringValue>
            </ns1:defaultValue>
            <ns1:propertyType>
                <ns1:name>string-any</ns1:name>
                <ns1:href>propertytype/4</ns1:href>
                <ns1:id>4</ns1:id>
                <ns1:type>application/com.servicemesh.agility.api.PropertyType+xml</ns1:type>
            </ns1:propertyType>
            <ns1:assetPropertyLinkId>5d6b6be7-a16e-4052-8509-c842d25adc11</ns1:assetPropertyLinkId>
        </ns1:variable>
        <ns1:variable>
            <ns1:name>SQL_INSTANCEID</ns1:name>
            <ns1:id>245</ns1:id>
            <ns1:description>Agility InstanceID of SQL server</ns1:description>
            <ns1:uuid>8535b6e4-fcc5-4fa3-bc67-5b67e3ac0619</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath></ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:displayName>SQL_INSTANCEID</ns1:displayName>
            <ns1:readable>true</ns1:readable>
            <ns1:writable>true</ns1:writable>
            <ns1:minRequired>1</ns1:minRequired>
            <ns1:maxAllowed>1</ns1:maxAllowed>
            <ns1:validator/>
            <ns1:defaultValue>
                <ns1:id>2582</ns1:id>
                <ns1:name>SQL_INSTANCEID</ns1:name>
                <ns1:encrypted>false</ns1:encrypted>
                <ns1:overridable>true</ns1:overridable>
                <ns1:propertyType>
                    <ns1:name>string-any</ns1:name>
                    <ns1:href>/propertytype/4</ns1:href>
                    <ns1:id>4</ns1:id>
                    <ns1:rel>up</ns1:rel>
                    <ns1:type>application/com.servicemesh.agility.api.PropertyType+xml</ns1:type>
                    <ns1:position>0</ns1:position>
                </ns1:propertyType>
                <ns1:propertyDefinition xsi:type="ns1:Link">
                    <ns1:name>SQL_INSTANCEID</ns1:name>
                    <ns1:href>/propertydefinition/245</ns1:href>
                    <ns1:id>245</ns1:id>
                    <ns1:rel>up</ns1:rel>
                    <ns1:type>application/com.servicemesh.agility.api.PropertyDefinition+xml</ns1:type>
                    <ns1:position>0</ns1:position>
                </ns1:propertyDefinition>
                <ns1:stringValue>&lt;place_holder&gt;</ns1:stringValue>
            </ns1:defaultValue>
            <ns1:propertyType>
                <ns1:name>string-any</ns1:name>
                <ns1:href>propertytype/4</ns1:href>
                <ns1:id>4</ns1:id>
                <ns1:type>application/com.servicemesh.agility.api.PropertyType+xml</ns1:type>
            </ns1:propertyType>
            <ns1:assetPropertyLinkId>1fd81893-1766-489f-9262-14edec2aad09</ns1:assetPropertyLinkId>
        </ns1:variable>
        <ns1:variable>
            <ns1:name>SQL_INSTANCENAME</ns1:name>
            <ns1:id>246</ns1:id>
            <ns1:description>SQL Instance where ConfigMgr database will be created</ns1:description>
            <ns1:uuid>e2aedf0d-b841-4890-8010-812fabd361d8</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath></ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:displayName>SQL_INSTANCENAME</ns1:displayName>
            <ns1:readable>true</ns1:readable>
            <ns1:writable>true</ns1:writable>
            <ns1:minRequired>1</ns1:minRequired>
            <ns1:maxAllowed>1</ns1:maxAllowed>
            <ns1:validator/>
            <ns1:defaultValue>
                <ns1:id>2982</ns1:id>
                <ns1:name>SQL_INSTANCENAME</ns1:name>
                <ns1:encrypted>false</ns1:encrypted>
                <ns1:overridable>true</ns1:overridable>
                <ns1:propertyType>
                    <ns1:name>string-any</ns1:name>
                    <ns1:href>/propertytype/4</ns1:href>
                    <ns1:id>4</ns1:id>
                    <ns1:rel>up</ns1:rel>
                    <ns1:type>application/com.servicemesh.agility.api.PropertyType+xml</ns1:type>
                    <ns1:position>0</ns1:position>
                </ns1:propertyType>
                <ns1:propertyDefinition xsi:type="ns1:Link">
                    <ns1:name>SQL_INSTANCENAME</ns1:name>
                    <ns1:href>/propertydefinition/246</ns1:href>
                    <ns1:id>246</ns1:id>
                    <ns1:rel>up</ns1:rel>
                    <ns1:type>application/com.servicemesh.agility.api.PropertyDefinition+xml</ns1:type>
                    <ns1:position>0</ns1:position>
                </ns1:propertyDefinition>
                <ns1:stringValue>MWSPCDEVICES01</ns1:stringValue>
            </ns1:defaultValue>
            <ns1:propertyType>
                <ns1:name>string-any</ns1:name>
                <ns1:href>propertytype/4</ns1:href>
                <ns1:id>4</ns1:id>
                <ns1:type>application/com.servicemesh.agility.api.PropertyType+xml</ns1:type>
            </ns1:propertyType>
            <ns1:assetPropertyLinkId>627c834f-0fe2-42ed-939e-f37bcd3c56f0</ns1:assetPropertyLinkId>
        </ns1:variable>
        <ns1:variable>
            <ns1:name>SQL_LOGFILEPATH</ns1:name>
            <ns1:id>247</ns1:id>
            <ns1:description>Folder where DB Log file is stored on SQL server</ns1:description>
            <ns1:uuid>206b524c-192e-4d07-87c9-9e09f76697d8</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath></ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:displayName>SQL_LOGFILEPATH</ns1:displayName>
            <ns1:readable>true</ns1:readable>
            <ns1:writable>true</ns1:writable>
            <ns1:minRequired>1</ns1:minRequired>
            <ns1:maxAllowed>1</ns1:maxAllowed>
            <ns1:validator/>
            <ns1:defaultValue>
                <ns1:id>10732</ns1:id>
                <ns1:name>SQL_LOGFILEPATH</ns1:name>
                <ns1:encrypted>false</ns1:encrypted>
                <ns1:overridable>true</ns1:overridable>
                <ns1:propertyType>
                    <ns1:name>string-any</ns1:name>
                    <ns1:href>/propertytype/4</ns1:href>
                    <ns1:id>4</ns1:id>
                    <ns1:rel>up</ns1:rel>
                    <ns1:type>application/com.servicemesh.agility.api.PropertyType+xml</ns1:type>
                    <ns1:position>0</ns1:position>
                </ns1:propertyType>
                <ns1:propertyDefinition xsi:type="ns1:Link">
                    <ns1:name>SQL_LOGFILEPATH</ns1:name>
                    <ns1:href>/propertydefinition/247</ns1:href>
                    <ns1:id>247</ns1:id>
                    <ns1:rel>up</ns1:rel>
                    <ns1:type>application/com.servicemesh.agility.api.PropertyDefinition+xml</ns1:type>
                    <ns1:position>0</ns1:position>
                </ns1:propertyDefinition>
                <ns1:stringValue>J:\SQL1\LOGS1</ns1:stringValue>
            </ns1:defaultValue>
            <ns1:propertyType>
                <ns1:name>string-any</ns1:name>
                <ns1:href>propertytype/4</ns1:href>
                <ns1:id>4</ns1:id>
                <ns1:type>application/com.servicemesh.agility.api.PropertyType+xml</ns1:type>
            </ns1:propertyType>
            <ns1:assetPropertyLinkId>76acdcea-dc21-4125-97ce-f3e7cdc1b835</ns1:assetPropertyLinkId>
        </ns1:variable>
        <ns1:variable>
            <ns1:name>SQL_DATAFILEPATH</ns1:name>
            <ns1:id>248</ns1:id>
            <ns1:description>Folder where DB Data file is stored on SQL server</ns1:description>
            <ns1:uuid>27706796-18ce-47d4-952b-9a91a1a776c1</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath></ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:displayName>SQL_DATAFILEPATH</ns1:displayName>
            <ns1:readable>true</ns1:readable>
            <ns1:writable>true</ns1:writable>
            <ns1:minRequired>1</ns1:minRequired>
            <ns1:maxAllowed>1</ns1:maxAllowed>
            <ns1:validator/>
            <ns1:defaultValue>
                <ns1:id>10733</ns1:id>
                <ns1:name>SQL_DATAFILEPATH</ns1:name>
                <ns1:encrypted>false</ns1:encrypted>
                <ns1:overridable>true</ns1:overridable>
                <ns1:propertyType>
                    <ns1:name>string-any</ns1:name>
                    <ns1:href>/propertytype/4</ns1:href>
                    <ns1:id>4</ns1:id>
                    <ns1:rel>up</ns1:rel>
                    <ns1:type>application/com.servicemesh.agility.api.PropertyType+xml</ns1:type>
                    <ns1:position>0</ns1:position>
                </ns1:propertyType>
                <ns1:propertyDefinition xsi:type="ns1:Link">
                    <ns1:name>SQL_DATAFILEPATH</ns1:name>
                    <ns1:href>/propertydefinition/248</ns1:href>
                    <ns1:id>248</ns1:id>
                    <ns1:rel>up</ns1:rel>
                    <ns1:type>application/com.servicemesh.agility.api.PropertyDefinition+xml</ns1:type>
                    <ns1:position>0</ns1:position>
                </ns1:propertyDefinition>
                <ns1:stringValue>J:\SQL1\DATA1</ns1:stringValue>
            </ns1:defaultValue>
            <ns1:propertyType>
                <ns1:name>string-any</ns1:name>
                <ns1:href>propertytype/4</ns1:href>
                <ns1:id>4</ns1:id>
                <ns1:type>application/com.servicemesh.agility.api.PropertyType+xml</ns1:type>
            </ns1:propertyType>
            <ns1:assetPropertyLinkId>54f9a1b7-f304-4269-b35d-76817d7f98d0</ns1:assetPropertyLinkId>
        </ns1:variable>
        <ns1:runOnProvisionOnly>false</ns1:runOnProvisionOnly>
    </ns1:pendingAsset>
    <ns1:pendingAsset xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="ns1:Script">
        <ns1:name>MWS2R2 - CM2012 - Prereqs Common</ns1:name>
        <ns1:id>160</ns1:id>
        <ns1:description>Reboots after running</ns1:description>
        <ns1:uuid>cd1df164-cd69-44f4-a95d-5d6c7203f37b</ns1:uuid>
        <ns1:assetType>
            <ns1:name>script</ns1:name>
            <ns1:href>assettype/2</ns1:href>
            <ns1:id>2</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.AssetType+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:assetType>
        <ns1:top>false</ns1:top>
        <ns1:assetPath>/Root/MWS2/MWS2_CDCR2</ns1:assetPath>
        <ns1:detailedAssetPath>/Root:#ID#1:#TYPE#VMContainer/MWS2:#ID#8:#TYPE#VMContainer/MWS2_CDCR2:#ID#9:#TYPE#VMProject</ns1:detailedAssetPath>
        <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
        <ns1:removable>true</ns1:removable>
        <ns1:domain>
            <ns1:name>domain1</ns1:name>
            <ns1:href>domain/1</ns1:href>
            <ns1:id>1</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Domain+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:domain>
        <ns1:creator>
            <ns1:name>dridley</ns1:name>
            <ns1:href>user/8</ns1:href>
            <ns1:id>8</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.User+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:creator>
        <ns1:created>2015-02-19T19:30:54-06:00</ns1:created>
        <ns1:lockType>0</ns1:lockType>
        <ns1:lastModified>2015-05-21T23:01:13-05:00</ns1:lastModified>
        <ns1:parent>
            <ns1:name>MWS2_CDCR2</ns1:name>
            <ns1:href>project/9</ns1:href>
            <ns1:id>9</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Project+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:parent>
        <ns1:version>-1</ns1:version>
        <ns1:latest>false</ns1:latest>
        <ns1:versionStatus>inprogress</ns1:versionStatus>
        <ns1:checkoutAllowed>false</ns1:checkoutAllowed>
        <ns1:headAllowed>false</ns1:headAllowed>
        <ns1:operatingSystem>Windows</ns1:operatingSystem>
        <ns1:enableExtensions>false</ns1:enableExtensions>
        <ns1:body># Load Common functions
. .\Logging.ps1
. .\GlobalRepository.ps1
. .\LaunchProcess.ps1
. .\FilesUtility.ps1
. .\PlatformUtils.ps1
. .\UsersUtility.ps1


# get current script location
$scriptPath = split-path -parent $MyInvocation.MyCommand.Definition
$scriptName = $MyInvocation.MyCommand.Name
 
ConfigureLogging $scriptPath $scriptName
 
#########################################################################
# Main
#########################################################################
 
#Use ArgList variable in Start-Process commands so embedded variables and env variables resolve
#START.exe is used with msiexec otherwise it does not wait

$DomainFQDN =			(get-globalvariable(&quot;Global\DomainFQDN&quot;)).value
$DomainNetBIOS = 		(get-globalvariable(&quot;Global\DomainNetBIOS&quot;)).value
$DomainDN = 			(get-globalvariable(&quot;AD\DistinguishedName&quot;)).value
$ServiceAccountName = 	&quot;$DomainNetBIOS\$CM_SERVICEACCOUNT&quot;										# Svc account not set as a local env variable yet so need to reference BluePrint variable
$ServiceAccountPwd = 	get-serviceAccountPassword -username $CM_SERVICEACCOUNT.ToLower()		# Covert to lowercase as get-serviceAccountPassword function is case sensitive
$ADPermissionsDN = 		&quot;OU=Permissions,OU=Administration,$DomainDN&quot;
$ADRolesDN = 			&quot;OU=Roles,OU=Administration,$DomainDN&quot;

If ($DomainFQDN -eq $NULL) 			{Write-Host 'ERROR: $DomainFQDN not defined'; EXIT 1}
If ($DomainNetBIOS -eq $NULL) 		{Write-Host 'ERROR: $DomainNetBIOS not defined'; EXIT 1}
If ($DomainDN -eq $NULL) 			{Write-Host 'ERROR: $DomainDN not defined'; EXIT 1}
If ($ServiceAccountName -eq $NULL) 	{Write-Host 'ERROR: $ServiceAccountName not defined'; EXIT 1}
If ($ServiceAccountPwd -eq $NULL) 	{Write-Host 'ERROR: $ServiceAccountPwd not defined'; EXIT 1}


Log &quot;**** Starting: Common Pre-Reqs Config... ****&quot;
Log &quot;`n&quot;


Log &quot;Copy required content locally...&quot;		# Will be copied to C:\Users\&lt;profile&gt;
Get-AppFiles &quot;PC Devices\System Center\Server Provisioning\Common&quot;
Get-AppFiles &quot;PC Devices\Misc\Microsoft .NET&quot;
Get-AppFiles &quot;PC Devices\Misc\Windows Features&quot;
Log &quot;`n&quot;


Log &quot;Set Common Environment Variables...&quot;
SETX CM_ServiceAccount $CM_SERVICEACCOUNT /M
Log &quot;`n&quot;


Log &quot;Set Timezone...&quot;
tzutil /s &quot;$OS_TIMEZONE&quot;
If ($LastExitCode -ne 0) {Log &quot;ERROR: Timezone could not be set. Possibly due to inability to enumerate variables.&quot;; EXIT 1}
Log &quot;`n&quot;


Log &quot;Copy CMTrace.exe... &quot;
If (!(Test-Path &quot;$env:ProgramFiles\CMTrace&quot;)) {MD &quot;$env:ProgramFiles\CMTrace&quot;}
Copy-Item &quot;$ScriptPath\ConfigMgr\CMTrace\CMTrace.exe&quot; &quot;$env:ProgramFiles\CMTrace\&quot; -Force
Log &quot;`n&quot;


Log &quot;Defining Windows Firewall Ports...&quot;
Start-Process -NoNewWindow -Wait &quot;$ScriptPath\ConfigMgr\Scripts\Windows Firewall\CM2012-Windows Firewall.cmd&quot;
Log &quot;`n&quot;


# Install Windows Roles and Features. Note: Any Get-AppFiles commands after this point have failed, presumably due to a reboot required that is changing behaviour.
Log &quot;Installing Windows 2012 Roles (.NET 3.5 - includes .NET 2.0 and 3.0)...&quot;			# .NET 4.0 is already included in the Server SOE
Log &quot;    **KB2966828  |  .NET 3.5 prereq on Win2012 as per KB3005628&quot;
CMD /c Start /WAIT WUSA.exe &quot;$ScriptPath\WindowsFeatures_Prereq\Windows8.1-KB2966828-x64.msu&quot; /quiet /norestart /log:&quot;$env:windir\Debug\ConfigMgr2012\$env:Computername\$env:computername-KB3005628.log&quot;
Log &quot;    **.NET 3.5&quot;
Install-WindowsFeature -Name NET-Framework-Core -Source &quot;$ScriptPath\WindowsFeatures_Prereq\sxs&quot; -LogPath &quot;$env:windir\Debug\ConfigMgr2012\$env:Computername\$env:computername-Roles_.NET3.5.log&quot;		# Source switch used for .NET 3.5 only
Log &quot;`n&quot;

Log &quot;Installing Windows 2012 Roles (IIS)...&quot;
Install-WindowsFeature -Name Web-Default-Doc,Web-Dir-Browsing,Web-Http-Errors,Web-Static-Content,Web-Http-Redirect,Web-Health,Web-Performance,Web-Filtering,Web-Basic-Auth,Web-IP-Security,Web-Url-Auth,Web-Windows-Auth,Web-Net-Ext,Web-Net-Ext45,Web-ASP,Web-ASP-Net,Web-ASP-Net45,Web-ISAPI-Ext,Web-ISAPI-Filter,Web-Mgmt-Console,Web-Metabase,Web-Lgcy-Scripting,Web-WMI,Web-Scripting-Tools,Web-Mgmt-Service -LogPath &quot;$env:windir\Debug\ConfigMgr2012\$env:Computername\$env:computername-Roles_IIS.log&quot;
Log &quot;`n&quot;

Log &quot;Installing Windows 2012 Roles (WDS)...&quot;
Install-WindowsFeature -Name WDS -LogPath &quot;$env:windir\Debug\ConfigMgr2012\$env:Computername\$env:computername-Roles_WDS.log&quot;
Log &quot;`n&quot;

Log &quot;Installing Windows 2012 Features (BITS, BranchCache, GPMC, RDC, AD Psh Modules, AD Tools, Share &amp; Storage Mgt, File Resource Mgr)...&quot;
Install-WindowsFeature -Name BITS-IIS-Ext,RSAT-Bits-Server,BranchCache,GPMC,RDC,RSAT-AD-PowerShell,RSAT-ADDS-Tools,RSAT-ADLDS,RSAT-CoreFile-Mgmt,FS-Resource-Manager -LogPath &quot;$env:windir\Debug\ConfigMgr2012\$env:Computername\$env:computername-Features.log&quot;
Log &quot;`n&quot;
Start-Sleep -Seconds 30


Log &quot;Installing .NET 4.5.2...&quot;
$ArgList = &quot;/q /norestart /log `&quot;$env:windir\Debug\ConfigMgr2012\$env:Computername\$env:computername-.NET4.5.2.log`&quot;&quot;
Start-Process -NoNewWindow -Wait -FilePath &quot;$ScriptPath\Microsoft .NET 4.5.2\NDP452-KB2901907-x86-x64-AllOS-ENU.exe&quot; -ArgumentList $arglist
Log &quot;`n&quot;


Log &quot;Define local admins...&quot;		# Does not require domain credentials to run
# Note: svc account needs to be local admin prior to calling any LaunchProcessAsUser function, as it needs logon as a batch job rights
AddUserToLocalAdministrators -ServerName &quot;$env:Computername&quot; -UserName &quot;$ServiceAccountName&quot;
If (!(net LocalGroup Administrators | Select-String -Pattern $CM_SERVICEACCOUNT)) {&quot;ERROR: $ServiceAccountName could not be added to local admins&quot;; EXIT 1}			# Validate local admin

net user /add PCDevices_Admin pcd@dmin01												# Create local account
AddUserToLocalAdministrators -ServerName &quot;$env:Computername&quot; -UserName &quot;$env:Computername\PCDevices_Admin&quot;
Log &quot;`n&quot;


If ($env:CM_SITECODE)							# If Primary server is being stood up, then create AD objects. Needs to be done in this script as it's a prereq to subsequent AD group membership tasks
{
    Log &quot;Current server is detected as a Primary server...&quot;
    Log &quot;    ** Copy required Primary content locally...&quot;				# Will be copied to C:\Users\&lt;profile&gt;
    Get-AppFiles &quot;PC Devices\System Center\Server Provisioning\Primary&quot;
        
    Log &quot;    ** Creating AD Objects&quot;
    # Modify PS1 file
    $PS1File = &quot;$ScriptPath\ConfigMgr\Scripts\CM2012-AD Object-Creation.ps1&quot;
	(Get-Content $PS1File) | ForEach-Object { $_ -replace &quot;DomainNetBIOS =.*&quot; ,		&quot;DomainNetBIOS = `&quot;$DomainNetBIOS`&quot;&quot; }		| Set-Content $PS1File
    (Get-Content $PS1File) | ForEach-Object { $_ -replace &quot;DomainDN =.*&quot; ,			&quot;DomainDN = `&quot;$DomainDN`&quot;&quot; }				| Set-Content $PS1File
	(Get-Content $PS1File) | ForEach-Object { $_ -replace &quot;ADPermissionsDN =.*&quot; ,	&quot;ADPermissionsDN = `&quot;$ADPermissionsDN`&quot;&quot; }	| Set-Content $PS1File
	(Get-Content $PS1File) | ForEach-Object { $_ -replace &quot;ADRolesDN =.*&quot; ,			&quot;ADRolesDN = `&quot;$ADRolesDN`&quot;&quot; }				| Set-Content $PS1File

	# Run PS1 file using svc account credentials
	$ArgList = &quot;/c Powershell -file `&quot;$PS1File`&quot;&quot;
	$ret = LaunchProcessAsUser &quot;$env:ComSpec&quot; $ArgList $ServiceAccountName $ServiceAccountPwd		# Needs to run %COMSPEC% as Powershell.exe was not found and is looking for absolute path
    If ($ret -ne 0) {Log &quot;ERROR: AD object creation failed&quot;; EXIT 1}
    Log &quot;`n&quot;
   
}
Else
{
	Log &quot;Current server is NOT detected as a Primary server. Assuming AD accounts and groups have already been created. Continuing...&quot;
    Log &quot;`n&quot;
}


Log &quot;Define AD group membership...&quot;
$PS1File = &quot;$ScriptPath\ConfigMgr\Scripts\CM2012-AD Group-Membership.ps1&quot;			# Define AD group membership prereqs. Needs to run under svc account
(Get-Content $PS1File) | ForEach-Object { $_ -replace &quot;DomainNetBIOS =.*&quot; ,		&quot;DomainNetBIOS = `&quot;$DomainNetBIOS`&quot;&quot; }		| Set-Content $PS1File
(Get-Content $PS1File) | ForEach-Object { $_ -replace &quot;ADRolesDN =.*&quot; ,			&quot;ADRolesDN = `&quot;$ADRolesDN`&quot;&quot; }				| Set-Content $PS1File
$ArgList = &quot;/c Powershell -file `&quot;$PS1File`&quot;&quot;
$ret = LaunchProcessAsUser &quot;$env:ComSpec&quot; $ArgList $ServiceAccountName $ServiceAccountPwd		# Needs to run %COMSPEC% as Powershell.exe was not found and is looking for absolute path
If ($ret -ne 0) {Log &quot;ERROR: AD group membership failed&quot;; EXIT 1}
Log &quot;`n&quot;


Log &quot;Define Additional Local Admins...&quot;		# Does not require domain credentials to run
AddUserToLocalAdministrators -ServerName &quot;$env:Computername&quot; -UserName &quot;$DomainNetBIOS\ROLE-SCCM-Servers&quot;
If (!(net LocalGroup Administrators | Select-String -Pattern ROLE-SCCM-Servers)) {&quot;ERROR: ROLE-SCCM-Servers could not be added to local admins&quot;; EXIT 1}			# Validate local admin

AddUserToLocalAdministrators -ServerName &quot;$env:Computername&quot; -UserName &quot;$DomainNetBIOS\DEL-G-CSC Infrastructure Services&quot;
Log &quot;`n&quot;


Log &quot;Defining Drive Letters that ConfigMgr can use...&quot;
$disks = gwmi win32_logicaldisk -Filter &quot;DriveType='3'&quot;
ForEach ($id in $disks.DeviceID)
{
	If ($id -ne &quot;F:&quot;) {New-Item $id\NO_SMS_ON_DRIVE.sms -Type file -Force}
}
Log &quot;`n&quot;


Log &quot;Creating IIS Cleanup Task...&quot;
Start-Process -NoNewWindow -Wait &quot;$ScriptPath\ConfigMgr\Scripts\IIS 8.5\IIS Logs-Cleanup-SchTask.cmd&quot;
Log &quot;`n&quot;


Log &quot;Creating User Profile Cleanup Task...&quot;
$SchTasks_Date = (Get-Date).AddDays(5).ToString(&quot;MM/dd/yyyy&quot;)
$ProfPath = $env:UserProfile
# Create Agility User cleanup script
echo &quot;Get-CimInstance win32_userprofile -Verbose | Where {`$_.LocalPath -eq '$ProfPath'} | Remove-CimInstance -Verbose&quot; &gt; $env:windir\Debug\ConfigMgr2012\Agility-DelProf.ps1
SchTasks /Create /SC &quot;Once&quot; /SD $SchTasks_Date /ST 01:00 /F /RU &quot;SYSTEM&quot; /TN &quot;Agility-DelProf&quot; /TR &quot;Powershell.exe -File '$env:windir\Debug\ConfigMgr2012\Agility-DelProf.ps1'&quot;
Log &quot;`n&quot;


Log &quot;**** Finished: Common Pre-Reqs Config... ****&quot;</ns1:body>
        <ns1:type>Guest</ns1:type>
        <ns1:language>
            <ns1:name>powershell</ns1:name>
            <ns1:href>scriptlanguage/5</ns1:href>
            <ns1:id>5</ns1:id>
            <ns1:rel>down</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.ScriptLanguage+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:language>
        <ns1:runAsAdmin>false</ns1:runAsAdmin>
        <ns1:timeout>1800</ns1:timeout>
        <ns1:retries>0</ns1:retries>
        <ns1:delay>0</ns1:delay>
        <ns1:errorAction>Abort</ns1:errorAction>
        <ns1:rebootRequired>true</ns1:rebootRequired>
        <ns1:variable>
            <ns1:name>CM_SERVICEACCOUNT</ns1:name>
            <ns1:id>238</ns1:id>
            <ns1:description>Service Account used to install ConfigMgr</ns1:description>
            <ns1:uuid>fb4d387e-43c2-4258-9427-3d2a57065114</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath></ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:displayName>CM_SERVICEACCOUNT</ns1:displayName>
            <ns1:readable>true</ns1:readable>
            <ns1:writable>true</ns1:writable>
            <ns1:minRequired>1</ns1:minRequired>
            <ns1:maxAllowed>1</ns1:maxAllowed>
            <ns1:validator/>
            <ns1:defaultValue>
                <ns1:id>2207</ns1:id>
                <ns1:name>CM_SERVICEACCOUNT</ns1:name>
                <ns1:encrypted>false</ns1:encrypted>
                <ns1:overridable>true</ns1:overridable>
                <ns1:propertyType>
                    <ns1:name>string-any</ns1:name>
                    <ns1:href>/propertytype/4</ns1:href>
                    <ns1:id>4</ns1:id>
                    <ns1:rel>up</ns1:rel>
                    <ns1:type>application/com.servicemesh.agility.api.PropertyType+xml</ns1:type>
                    <ns1:position>0</ns1:position>
                </ns1:propertyType>
                <ns1:propertyDefinition xsi:type="ns1:Link">
                    <ns1:name>CM_SERVICEACCOUNT</ns1:name>
                    <ns1:href>/propertydefinition/238</ns1:href>
                    <ns1:id>238</ns1:id>
                    <ns1:rel>up</ns1:rel>
                    <ns1:type>application/com.servicemesh.agility.api.PropertyDefinition+xml</ns1:type>
                    <ns1:position>0</ns1:position>
                </ns1:propertyDefinition>
                <ns1:stringValue>svc_SCCM_Install</ns1:stringValue>
            </ns1:defaultValue>
            <ns1:propertyType>
                <ns1:name>string-any</ns1:name>
                <ns1:href>propertytype/4</ns1:href>
                <ns1:id>4</ns1:id>
                <ns1:type>application/com.servicemesh.agility.api.PropertyType+xml</ns1:type>
            </ns1:propertyType>
            <ns1:assetPropertyLinkId>606ec98d-86a6-4394-91e9-ebd07266448b</ns1:assetPropertyLinkId>
        </ns1:variable>
        <ns1:variable>
            <ns1:name>OS_TIMEZONE</ns1:name>
            <ns1:id>239</ns1:id>
            <ns1:description>Timezone as per &quot;TZUTIL /L&quot;</ns1:description>
            <ns1:uuid>1c576101-066e-47a0-ad4e-2e95943ab774</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath></ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:displayName>OS_TIMEZONE</ns1:displayName>
            <ns1:readable>true</ns1:readable>
            <ns1:writable>true</ns1:writable>
            <ns1:minRequired>1</ns1:minRequired>
            <ns1:maxAllowed>1</ns1:maxAllowed>
            <ns1:validator/>
            <ns1:defaultValue>
                <ns1:id>2208</ns1:id>
                <ns1:name>OS_TIMEZONE</ns1:name>
                <ns1:encrypted>false</ns1:encrypted>
                <ns1:overridable>true</ns1:overridable>
                <ns1:propertyType>
                    <ns1:name>string-any</ns1:name>
                    <ns1:href>/propertytype/4</ns1:href>
                    <ns1:id>4</ns1:id>
                    <ns1:rel>up</ns1:rel>
                    <ns1:type>application/com.servicemesh.agility.api.PropertyType+xml</ns1:type>
                    <ns1:position>0</ns1:position>
                </ns1:propertyType>
                <ns1:propertyDefinition xsi:type="ns1:Link">
                    <ns1:name>OS_TIMEZONE</ns1:name>
                    <ns1:href>/propertydefinition/239</ns1:href>
                    <ns1:id>239</ns1:id>
                    <ns1:rel>up</ns1:rel>
                    <ns1:type>application/com.servicemesh.agility.api.PropertyDefinition+xml</ns1:type>
                    <ns1:position>0</ns1:position>
                </ns1:propertyDefinition>
                <ns1:stringValue>AUS Eastern Standard Time</ns1:stringValue>
            </ns1:defaultValue>
            <ns1:propertyType>
                <ns1:name>string-any</ns1:name>
                <ns1:href>propertytype/4</ns1:href>
                <ns1:id>4</ns1:id>
                <ns1:type>application/com.servicemesh.agility.api.PropertyType+xml</ns1:type>
            </ns1:propertyType>
            <ns1:assetPropertyLinkId>01cf64cf-3fbf-460f-83a5-ecc7703041bb</ns1:assetPropertyLinkId>
        </ns1:variable>
        <ns1:runOnProvisionOnly>false</ns1:runOnProvisionOnly>
    </ns1:pendingAsset>
    <ns1:pendingAsset xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="ns1:Script">
        <ns1:name>MWS2R2 - CM2012 - Prereqs Primary</ns1:name>
        <ns1:id>161</ns1:id>
        <ns1:description>Delay count required as this script follows on from scripts that install Windows Features. Upon reboot Server Manager has to reinitialise.</ns1:description>
        <ns1:uuid>9820acf5-d399-48d5-b625-96f5cdee094d</ns1:uuid>
        <ns1:assetType>
            <ns1:name>script</ns1:name>
            <ns1:href>assettype/2</ns1:href>
            <ns1:id>2</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.AssetType+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:assetType>
        <ns1:top>false</ns1:top>
        <ns1:assetPath>/Root/MWS2/MWS2_CDCR2</ns1:assetPath>
        <ns1:detailedAssetPath>/Root:#ID#1:#TYPE#VMContainer/MWS2:#ID#8:#TYPE#VMContainer/MWS2_CDCR2:#ID#9:#TYPE#VMProject</ns1:detailedAssetPath>
        <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
        <ns1:removable>true</ns1:removable>
        <ns1:domain>
            <ns1:name>domain1</ns1:name>
            <ns1:href>domain/1</ns1:href>
            <ns1:id>1</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Domain+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:domain>
        <ns1:creator>
            <ns1:name>dridley</ns1:name>
            <ns1:href>user/8</ns1:href>
            <ns1:id>8</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.User+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:creator>
        <ns1:created>2015-02-19T19:32:27-06:00</ns1:created>
        <ns1:lockType>0</ns1:lockType>
        <ns1:lastModified>2015-05-21T23:45:00-05:00</ns1:lastModified>
        <ns1:parent>
            <ns1:name>MWS2_CDCR2</ns1:name>
            <ns1:href>project/9</ns1:href>
            <ns1:id>9</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Project+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:parent>
        <ns1:version>-1</ns1:version>
        <ns1:latest>false</ns1:latest>
        <ns1:versionStatus>inprogress</ns1:versionStatus>
        <ns1:checkoutAllowed>false</ns1:checkoutAllowed>
        <ns1:headAllowed>false</ns1:headAllowed>
        <ns1:operatingSystem>Windows</ns1:operatingSystem>
        <ns1:enableExtensions>false</ns1:enableExtensions>
        <ns1:body># Load Common functions
. .\Logging.ps1
. .\GlobalRepository.ps1
. .\LaunchProcess.ps1
. .\FilesUtility.ps1
. .\PlatformUtils.ps1

# get current script location
$scriptPath = split-path -parent $MyInvocation.MyCommand.Definition
$scriptName = $MyInvocation.MyCommand.Name
 
ConfigureLogging $scriptPath $scriptName
 
#########################################################################
# Main (Primary Server only)
#########################################################################

#Use ArgList variable in Start-Process commands so embedded variables and env variables resolve
#START.exe is used with msiexec otherwise it does not wait

$DomainFQDN =			(get-globalvariable(&quot;Global\DomainFQDN&quot;)).value
$DomainNetBIOS = 		(get-globalvariable(&quot;Global\DomainNetBIOS&quot;)).value
$DomainDN = 			(get-globalvariable(&quot;AD\DistinguishedName&quot;)).value
$ServiceAccountName = 	&quot;$DomainNetBIOS\$env:CM_ServiceAccount&quot;
$ServiceAccountPwd = 	get-serviceAccountPassword -username $env:CM_ServiceAccount.ToLower()					# Covert to lowercase as get-serviceAccountPassword function is case sensitive
$SQLServerName = 		get-computername -ComponentID $env:SQL_ComponentID -InstanceID $env:SQL_InstanceID

If ($DomainFQDN -eq $NULL) 			{Write-Host 'ERROR: $DomainFQDN not defined'; EXIT 1}
If ($DomainNetBIOS -eq $NULL) 		{Write-Host 'ERROR: $DomainNetBIOS not defined'; EXIT 1}
If ($DomainDN -eq $NULL) 			{Write-Host 'ERROR: $DomainDN not defined'; EXIT 1}
If ($ServiceAccountName -eq $NULL) 	{Write-Host 'ERROR: $ServiceAccountName not defined'; EXIT 1}
If ($ServiceAccountPwd -eq $NULL) 	{Write-Host 'ERROR: $ServiceAccountPwd not defined'; EXIT 1}
If ($SQLServerName -eq $NULL)	 	{Write-Host 'ERROR: $SQLServerName not defined'; EXIT 1}


Log &quot;**** Starting: Primary Pre-Reqs Config... ****&quot;
Log &quot;`n&quot;


Log &quot;Copy required content locally&quot;		# Will be copied to C:\Users\&lt;profile&gt;
Get-AppFiles &quot;PC Devices\Misc\SQL Server\SQL Server 2012 Exp x64 SP2&quot;
Log &quot;`n&quot;


Log &quot;Check AD Group membership prereq...&quot;
$arglist = &quot;/c Powershell.exe -Command `&quot;&amp; { If (!(Get-ADComputer $env:Computername -Properties MemberOf | Select -Expand Memberof | Select-String -Pattern 'ROLE-SCCM-Servers')) { EXIT 1} }`&quot;&quot;
$ret = LaunchProcessAsUser $env:COMSPEC $arglist $ServiceAccountName $ServiceAccountPwd
If ($ret -ne 0) {Log &quot;ERROR: $env:computername is NOT a member of $DomainNetBIOS\ROLE-SCCM-Servers. Exiting...&quot;; EXIT 1}
Log &quot;`n&quot;


Log &quot;ADK for Windows 8.1...&quot;
$arglist = &quot;/features OptionID.DeploymentTools OptionID.WindowsPreinstallationEnvironment OptionID.UserStateMigrationTool /installpath C:\WindowsKits\8.1 /quiet /norestart /ceip off /log $env:windir\Debug\ConfigMgr2012\$env:Computername\$env:computername-ADK.log&quot;
Start-Process -NoNewWindow -Wait -FilePath &quot;$ScriptPath\ConfigMgr\ADK for Win8.1\adksetup.exe&quot; -ArgumentList $arglist
Start-Sleep -Seconds 300
Log &quot;`n&quot;


Log &quot;Installing Report Viewer 2012...&quot;		#Used for launching reports from CM2012 console
Log &quot;    **Running CLR Types**&quot;
CMD /c Start /WAIT msiexec /i &quot;$ScriptPath\ConfigMgr\Microsoft Report Viewer\Microsoft Report Viewer 2012\SQLSysClrTypes.msi&quot; /qn /norestart /log $env:windir\Debug\ConfigMgr2012\$env:Computername\$env:computername-ReportViewer_SQLSysClrTypes.log
Start-Sleep -Seconds 30
Log &quot;    **Running Report Viewer MSI**&quot;
CMD /c Start /WAIT msiexec /i &quot;$ScriptPath\ConfigMgr\Microsoft Report Viewer\Microsoft Report Viewer 2012\ReportViewer.msi&quot; /qn /norestart /log $env:windir\Debug\ConfigMgr2012\$env:Computername\$env:computername-ReportViewer_MSI.log
Start-Sleep -Seconds 30
Log &quot;`n&quot;


Log &quot;Microsoft SQL Server 2012 Report Builder...&quot;
CMD /c Start /WAIT msiexec /i &quot;$ScriptPath\ConfigMgr\Microsoft SQL Server Report Builder\Microsoft SQL Server 2012 Report Builder\ReportBuilder3.msi&quot; /qn /norestart /log $env:windir\Debug\ConfigMgr2012\$env:Computername\$env:computername-ReportBuilder3.log
Start-Sleep -Seconds 30
Log &quot;`n&quot;

Log &quot;Installing Windows 2012 Roles (WSUS)...&quot;
Install-WindowsFeature -Name UpdateServices-Services,UpdateServices-DB -IncludeManagementTools -LogPath &quot;$env:windir\Debug\ConfigMgr2012\$env:Computername\$env:computername-Roles_WSUS.log&quot;
If ($LastExitCode -ne 0) {Log &quot;ERROR: Failed to install WSUS Role. Exiting...&quot;; EXIT 1}
Log &quot;`n&quot;
Start-Sleep -s 120


Log &quot;Configure WSUS... (log file located under %windir%\tmpXXXX.tmp)&quot;
$arglist = &quot;postinstall SQL_INSTANCE_NAME=$SQLServerName\$env:SQL_InstanceName CONTENT_DIR=F:\WSUS&quot;			# WSUS hosted on SQL box
$ret = LaunchProcessAsUser &quot;C:\Program Files\Update Services\Tools\wsusutil.exe&quot; $arglist $ServiceAccountName $ServiceAccountPwd
If ($ret -ne 0) {Log &quot;ERROR: WSUS install failed&quot;; EXIT 1}
Log &quot;`n&quot;
Start-Sleep -s 300

Log &quot;    **WSUS is using the following DB:&quot;
reg query &quot;HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Update Services\Server\Setup&quot; /v SqlServerName
Log &quot;`n&quot;


Log &quot;Installing SCUP 2011...&quot;
CMD /c Start /WAIT MSIEXEC.exe /i &quot;$ScriptPath\ConfigMgr\Microsoft SCUP 2011\SystemCenterUpdatesPublisher.msi&quot; /qn /norestart /log $env:windir\Debug\ConfigMgr2012\$env:Computername\$env:computername-SCUP.log


Log &quot;Installing MDT 2013 v6.2.5019.0...&quot;
CMD /c Start /WAIT MSIEXEC.exe /i &quot;$ScriptPath\ConfigMgr\MDT\MDT 2013 v6.2.5019.0\MicrosoftDeploymentToolkit2013_x64.msi&quot; /qn /norestart /log $env:windir\Debug\ConfigMgr2012\$env:Computername\$env:computername-MDT.log
Log &quot;`n&quot;


Log &quot;Installing SQL Server 2012 Express SP2 - Management Studio ...&quot;		# Log files located in &quot;C:\Program Files\Microsoft SQL Server\110\Setup Bootstrap\Log&quot;
Log &quot;    **Copying SQL data locally...&quot;
$CMDfile = &quot;$ScriptPath\SQLManagementStudio_x64_ENU\_MS SQL 2012 Exp SP2 x64_MgtStudioOnly.cmd&quot;
(Get-Content $CMDfile) | ForEach-Object { $_ -replace &quot;Set SQLSYSADMINACCOUNTS=.*&quot; , &quot;Set SQLSYSADMINACCOUNTS=`&quot;NT AUTHORITY\System`&quot; `&quot;$DomainNetBIOS\PERM-L-SCCM-SQLAdmins`&quot; `&quot;$ServiceAccountName`&quot;&quot; } | Set-Content $CMDfile
$arglist = &quot;/c `&quot;$CMDfile`&quot;&quot;
Log &quot;    **Installing...&quot;
LaunchProcessAsUser $env:COMSPEC $arglist $ServiceAccountName $ServiceAccountPwd
Log &quot;`n&quot;
Start-Sleep -s 120


Log &quot;	** Configuring SQL server OS and Database Delegation&quot;				# Needs to be run after SQL Server is installed so that 'SQL-Permissions' function can work
$SQLServerName = (get-computername -ComponentID $env:SQL_ComponentID -InstanceID $env:SQL_InstanceID).ToUpper()
$PS1File = &quot;$ScriptPath\ConfigMgr\Scripts\SQL-Server Config.ps1&quot;
# Add commands to PS1File
(Get-Content $PS1File) | ForEach-Object { $_ -replace &quot;ScriptPath =.*&quot; , &quot;ScriptPath = `&quot;$ScriptPath`&quot;&quot; }					| Set-Content $PS1File
(Get-Content $PS1File) | ForEach-Object { $_ -replace &quot;SQLServerName =.*&quot; , &quot;SQLServerName = `&quot;$SQLServerName`&quot;&quot; }			| Set-Content $PS1File
(Get-Content $PS1File) | ForEach-Object { $_ -replace &quot;DomainFQDN =.*&quot; , &quot;DomainFQDN = `&quot;$DomainFQDN`&quot;&quot; }					| Set-Content $PS1File
(Get-Content $PS1File) | ForEach-Object { $_ -replace &quot;DomainNetBIOS =.*&quot; , &quot;DomainNetBIOS = `&quot;$DomainNetBIOS`&quot;&quot; }			| Set-Content $PS1File
    
# Run PS1 file using svc account credentials
$ArgList = &quot;/c Powershell -file `&quot;$PS1File`&quot;&quot;
$ret = LaunchProcessAsUser &quot;$env:ComSpec&quot; $ArgList $ServiceAccountName $ServiceAccountPwd		# Needs to run %COMSPEC% as Powershell.exe was not found and is looking for absolute path
If ($ret -ne 0) {Log &quot;ERROR: SQL delegation failed&quot;; EXIT 1}
Log &quot;`n&quot;

Log &quot;Create Source Repository to house content...&quot;
If (!(Test-Path &quot;F:\ConfigMgr&quot;))
{
	Get-AppFiles &quot;PC Devices\System Center\Ops Repository&quot;
	$tmp = robocopy &quot;$ScriptPath\ConfigMgr_Share&quot; &quot;F:\ConfigMgr&quot; /move /s /e /r:5 /w:10 /np /njh
}
Else
{
	Log &quot;F:\ConfigMgr already exists. Please update manually if still required.&quot;
}


Log &quot;**** Finished: Primary Pre-Reqs Config... ****&quot;</ns1:body>
        <ns1:type>Guest</ns1:type>
        <ns1:language>
            <ns1:name>powershell</ns1:name>
            <ns1:href>scriptlanguage/5</ns1:href>
            <ns1:id>5</ns1:id>
            <ns1:rel>down</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.ScriptLanguage+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:language>
        <ns1:runAsAdmin>false</ns1:runAsAdmin>
        <ns1:timeout>3600</ns1:timeout>
        <ns1:retries>0</ns1:retries>
        <ns1:delay>300</ns1:delay>
        <ns1:errorAction>Abort</ns1:errorAction>
        <ns1:rebootRequired>true</ns1:rebootRequired>
        <ns1:runOnProvisionOnly>false</ns1:runOnProvisionOnly>
    </ns1:pendingAsset>
    <ns1:pendingAsset xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="ns1:Script">
        <ns1:name>MWS2R2 - CM2012 - Install Primary</ns1:name>
        <ns1:id>156</ns1:id>
        <ns1:description></ns1:description>
        <ns1:uuid>1c3da9ae-14e3-4b2e-b490-bd9e1775529e</ns1:uuid>
        <ns1:assetType>
            <ns1:name>script</ns1:name>
            <ns1:href>assettype/2</ns1:href>
            <ns1:id>2</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.AssetType+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:assetType>
        <ns1:top>false</ns1:top>
        <ns1:assetPath>/Root/MWS2/MWS2_CDCR2</ns1:assetPath>
        <ns1:detailedAssetPath>/Root:#ID#1:#TYPE#VMContainer/MWS2:#ID#8:#TYPE#VMContainer/MWS2_CDCR2:#ID#9:#TYPE#VMProject</ns1:detailedAssetPath>
        <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
        <ns1:removable>true</ns1:removable>
        <ns1:domain>
            <ns1:name>domain1</ns1:name>
            <ns1:href>domain/1</ns1:href>
            <ns1:id>1</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Domain+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:domain>
        <ns1:creator>
            <ns1:name>dridley</ns1:name>
            <ns1:href>user/8</ns1:href>
            <ns1:id>8</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.User+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:creator>
        <ns1:created>2015-02-19T19:09:38-06:00</ns1:created>
        <ns1:lockType>0</ns1:lockType>
        <ns1:lastModified>2015-05-21T02:18:19-05:00</ns1:lastModified>
        <ns1:parent>
            <ns1:name>MWS2_CDCR2</ns1:name>
            <ns1:href>project/9</ns1:href>
            <ns1:id>9</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Project+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:parent>
        <ns1:version>-1</ns1:version>
        <ns1:latest>false</ns1:latest>
        <ns1:versionStatus>inprogress</ns1:versionStatus>
        <ns1:checkoutAllowed>false</ns1:checkoutAllowed>
        <ns1:headAllowed>false</ns1:headAllowed>
        <ns1:operatingSystem>Windows</ns1:operatingSystem>
        <ns1:enableExtensions>false</ns1:enableExtensions>
        <ns1:body># Load Common functions
. .\Logging.ps1
. .\GlobalRepository.ps1
. .\LaunchProcess.ps1
. .\FilesUtility.ps1
. .\PlatformUtils.ps1


# get current script location
$scriptPath = split-path -parent $MyInvocation.MyCommand.Definition
$scriptName = $MyInvocation.MyCommand.Name
 
ConfigureLogging $scriptPath $scriptName
 
#########################################################################
# Main
#########################################################################

#Use ArgList variable in Start-Process commands so embedded variables and env variables resolve
#START.exe is used with msiexec otherwise it does not wait

$DomainFQDN =			(get-globalvariable(&quot;Global\DomainFQDN&quot;)).value
$DomainNetBIOS = 		(get-globalvariable(&quot;Global\DomainNetBIOS&quot;)).value
$ServiceAccountName = 	&quot;$DomainNetBIOS\$env:CM_ServiceAccount&quot;
$ServiceAccountPwd = 	get-serviceAccountPassword -username $env:CM_ServiceAccount.ToLower()		#Covert to lowercase as get-serviceAccountPassword function is case sensitive
$SQLServerName = 		(get-computername -ComponentID $env:SQL_ComponentID -InstanceID $env:SQL_InstanceID).ToUpper()
$ComputerName =			$env:ComputerName.ToUpper()

If ($DomainFQDN -eq $NULL) 			{Write-Host 'ERROR: $DomainFQDN not defined'; EXIT 1}
If ($DomainNetBIOS -eq $NULL) 		{Write-Host 'ERROR: $DomainNetBIOS not defined'; EXIT 1}
If ($ServiceAccountName -eq $NULL) 	{Write-Host 'ERROR: $ServiceAccountName not defined'; EXIT 1}
If ($ServiceAccountPwd -eq $NULL) 	{Write-Host 'ERROR: $ServiceAccountPwd not defined'; EXIT 1}
If ($SQLServerName -eq $NULL) 		{Write-Host 'ERROR: $SQLServerName not defined'; EXIT 1}


Log &quot;**** Starting: Primary Install... ****&quot;
Log &quot;`n&quot;

Log &quot;Update ConfigMgr 2012 Primary Unattend file...&quot;
$INIFile = &quot;$env:windir\Debug\ConfigMgr2012\$env:Computername\Unattend_$env:Computername.ini&quot;
Copy-Item &quot;$ScriptPath\ConfigMgr\Scripts\Unattend_Template_PRI.ini&quot; $INIFile -Force
(Get-Content $INIFile) | ForEach-Object { $_ -replace &quot;SiteCode=.*&quot; , 			&quot;SiteCode=$env:CM_SiteCode&quot; } 								| Set-Content $INIFile
(Get-Content $INIFile) | ForEach-Object { $_ -replace &quot;SiteName=.*&quot; , 			&quot;SiteName=$env:CM_SiteDescription&quot; } 						| Set-Content $INIFile
(Get-Content $INIFile) | ForEach-Object { $_ -replace &quot;SMSInstallDir=.*&quot; , 		&quot;SMSInstallDir=$env:CM_SMSInstallDir&quot; } 					| Set-Content $INIFile
(Get-Content $INIFile) | ForEach-Object { $_ -replace &quot;SDKServer=.*&quot; , 			&quot;SDKServer=$ComputerName.$DomainFQDN&quot; } 					| Set-Content $INIFile
(Get-Content $INIFile) | ForEach-Object { $_ -replace &quot;PrerequisitePath=.*&quot; ,	&quot;PrerequisitePath=$ScriptPath\ConfigMgr\ConfigMgr 2012\ConfigMgr 2012 R2_Prereqs&quot; }	| Set-Content $INIFile
(Get-Content $INIFile) | ForEach-Object { $_ -replace &quot;ManagementPoint=.*&quot; , 	&quot;ManagementPoint=$ComputerName.$DomainFQDN&quot; } 				| Set-Content $INIFile
(Get-Content $INIFile) | ForEach-Object { $_ -replace &quot;DistributionPoint=.*&quot; , 	&quot;DistributionPoint=$ComputerName.$DomainFQDN&quot; } 			| Set-Content $INIFile
(Get-Content $INIFile) | ForEach-Object { $_ -replace &quot;SQLServerName=.*&quot; , 		&quot;SQLServerName=$SQLServerName.$DomainFQDN&quot; } 				| Set-Content $INIFile
(Get-Content $INIFile) | ForEach-Object { $_ -replace &quot;DatabaseName=.*&quot; , 		&quot;DatabaseName=$env:SQL_InstanceName\CM_$env:CM_SiteCode&quot; }	| Set-Content $INIFile
(Get-Content $INIFile) | ForEach-Object { $_ -replace &quot;SQLDataFilePath=.*&quot; , 	&quot;SQLDataFilePath=$env:SQL_DataFilePath&quot; } 					| Set-Content $INIFile
(Get-Content $INIFile) | ForEach-Object { $_ -replace &quot;SQLLogFilePath=.*&quot; , 	&quot;SQLLogFilePath=$env:SQL_LogFilePath&quot; } 					| Set-Content $INIFile


Log &quot;Installing ConfigMgr 2012 Primary...&quot;
$arglist = &quot;/Script $INIFile /NoUserInput&quot;
$ret = LaunchProcessAsUser &quot;$ScriptPath\ConfigMgr\ConfigMgr 2012\ConfigMgr 2012 R2 5.00.7958.1000\SMSSETUP\BIN\X64\setup.exe&quot; $arglist $ServiceAccountName $ServiceAccountPwd
If ($ret -ne 0) {Log &quot;ERROR: ConfigMgr 2012 install failed&quot;; EXIT 1}
Log &quot;`n&quot;
Start-Sleep -s 300


# Verify ConfigMgr is installed
If (!(Test-Path &quot;HKLM:\SOFTWARE\Microsoft\SMS\Components\SMS_EXECUTIVE&quot;)) {Write-Host 'ERROR: ConfigMgr install not detected!'; EXIT 1}

Log &quot;Installing POST ConfigMgr 2012 Updates...&quot;
Log &quot;    **KB3054451  |  CU5 for ConfigMgr 2012 R2&quot;		# Log file output to %windir%\Temp
$arglist = &quot;/Unattended /NoSQLTimeout /NoMOFTimeout&quot;
$ret = LaunchProcessAsUser &quot;$ScriptPath\ConfigMgr\Updates\ConfigMgr 2012\CU5 for ConfigMgr 2012 R2\CM12-R2CU5-KB3054451-X64-ENU.exe&quot; $arglist $ServiceAccountName $ServiceAccountPwd
If ($ret -ne 0 -and $ret -ne 3001) {Log &quot;ERROR: ConfigMgr 2012 install failed&quot;; EXIT 1}
Log &quot;`n&quot;
Start-Sleep -s 300


Log &quot;**** Finished: Primary Install... ****&quot;</ns1:body>
        <ns1:type>Guest</ns1:type>
        <ns1:language>
            <ns1:name>powershell</ns1:name>
            <ns1:href>scriptlanguage/5</ns1:href>
            <ns1:id>5</ns1:id>
            <ns1:rel>down</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.ScriptLanguage+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:language>
        <ns1:runAsAdmin>false</ns1:runAsAdmin>
        <ns1:timeout>5400</ns1:timeout>
        <ns1:retries>0</ns1:retries>
        <ns1:delay>300</ns1:delay>
        <ns1:errorAction>Abort</ns1:errorAction>
        <ns1:rebootRequired>true</ns1:rebootRequired>
        <ns1:runOnProvisionOnly>false</ns1:runOnProvisionOnly>
    </ns1:pendingAsset>
    <ns1:pendingAsset xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="ns1:Script">
        <ns1:name>MWS2R2 - CM2012 - POST Config (PRI)</ns1:name>
        <ns1:id>158</ns1:id>
        <ns1:description></ns1:description>
        <ns1:uuid>6cdf829e-f9da-4683-b481-5fc6912e78ef</ns1:uuid>
        <ns1:assetType>
            <ns1:name>script</ns1:name>
            <ns1:href>assettype/2</ns1:href>
            <ns1:id>2</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.AssetType+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:assetType>
        <ns1:top>false</ns1:top>
        <ns1:assetPath>/Root/MWS2/MWS2_CDCR2</ns1:assetPath>
        <ns1:detailedAssetPath>/Root:#ID#1:#TYPE#VMContainer/MWS2:#ID#8:#TYPE#VMContainer/MWS2_CDCR2:#ID#9:#TYPE#VMProject</ns1:detailedAssetPath>
        <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
        <ns1:removable>true</ns1:removable>
        <ns1:domain>
            <ns1:name>domain1</ns1:name>
            <ns1:href>domain/1</ns1:href>
            <ns1:id>1</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Domain+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:domain>
        <ns1:creator>
            <ns1:name>dridley</ns1:name>
            <ns1:href>user/8</ns1:href>
            <ns1:id>8</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.User+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:creator>
        <ns1:created>2015-02-19T19:24:42-06:00</ns1:created>
        <ns1:lockType>0</ns1:lockType>
        <ns1:lastModified>2015-05-17T22:31:07-05:00</ns1:lastModified>
        <ns1:parent>
            <ns1:name>MWS2_CDCR2</ns1:name>
            <ns1:href>project/9</ns1:href>
            <ns1:id>9</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Project+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:parent>
        <ns1:version>-1</ns1:version>
        <ns1:latest>false</ns1:latest>
        <ns1:versionStatus>inprogress</ns1:versionStatus>
        <ns1:checkoutAllowed>false</ns1:checkoutAllowed>
        <ns1:headAllowed>false</ns1:headAllowed>
        <ns1:operatingSystem>Windows</ns1:operatingSystem>
        <ns1:enableExtensions>false</ns1:enableExtensions>
        <ns1:body># Check ConfigMgr is installed
If (!(Test-Path &quot;HKLM:\SOFTWARE\Microsoft\SMS\Components&quot;)) 	{Write-Host 'ERROR: ConfigMgr install not detected!'; EXIT 1}

# Load Common functions
. .\Logging.ps1
. .\GlobalRepository.ps1
. .\LaunchProcess.ps1
. .\FilesUtility.ps1
. .\PlatformUtils.ps1


# get current script location
$scriptPath = split-path -parent $MyInvocation.MyCommand.Definition
$scriptName = $MyInvocation.MyCommand.Name
 
ConfigureLogging $scriptPath $scriptName
 
#########################################################################
# Main
#########################################################################

#Use ArgList variable in Start-Process commands so embedded variables and env variables resolve
#START.exe is used with msiexec otherwise it does not wait

$DomainFQDN =				(get-globalvariable(&quot;Global\DomainFQDN&quot;)).value
$DomainNetBIOS = 			(get-globalvariable(&quot;Global\DomainNetBIOS&quot;)).value
$ServiceAccountName = 		&quot;$DomainNetBIOS\$env:CM_ServiceAccount&quot;
$ServiceAccountPwd = 		get-serviceAccountPassword -username $env:CM_ServiceAccount.ToLower()		#Covert to lowercase as get-serviceAccountPassword function is case sensitive
$SQLServiceAccountName =	&quot;svc_SCCM_SQL&quot;
$SQLServiceAccountPwd = 	get-serviceAccountPassword -username $SQLServiceAccountName.ToLower()		#Covert to lowercase as get-serviceAccountPassword function is case sensitive
$SQLServerName = 			(get-computername -ComponentID $env:SQL_ComponentID -InstanceID $env:SQL_InstanceID).ToUpper()
$ComputerName =				$env:ComputerName.ToUpper()
$Sitecode = 				$env:CM_SiteCode

If ($DomainFQDN -eq $NULL) 				{Write-Host 'ERROR: $DomainFQDN not defined'; EXIT 1}
If ($DomainNetBIOS -eq $NULL) 			{Write-Host 'ERROR: $DomainNetBIOS not defined'; EXIT 1}
If ($ServiceAccountName -eq $NULL) 		{Write-Host 'ERROR: $ServiceAccountName not defined'; EXIT 1}
If ($ServiceAccountPwd -eq $NULL) 		{Write-Host 'ERROR: $ServiceAccountPwd not defined'; EXIT 1}
If ($SQLServiceAccountPwd -eq $NULL) 	{Write-Host 'ERROR: $ServiceAccountPwd not defined'; EXIT 1}
If ($SQLServerName -eq $NULL) 			{Write-Host 'ERROR: $SQLServerName not defined'; EXIT 1}
If ($Sitecode -eq $NULL) 				{Write-Host 'ERROR: $Sitecode not defined'; EXIT 1}

Get-ScheduledTask | Where-Object {$_.TaskName -eq &quot;AgilityTask&quot;} | Unregister-ScheduledTask -Confirm:$False		#Cleanup existing tasks used by LaunchProcessAsUser function


Log &quot;**** Starting: Console Config... ****&quot;
Log &quot;`n&quot;


# Modify PS1 file which configures ConfigMgr console
$PS1File = &quot;$ScriptPath\ConfigMgr\Scripts\CM2012-Console Config (PRI).ps1&quot;
(Get-Content $PS1File) | ForEach-Object { $_ -replace &quot;ScriptPath =.*&quot; ,			&quot;ScriptPath = `'$ScriptPath`'&quot; }									| Set-Content $PS1File
(Get-Content $PS1File) | ForEach-Object { $_ -replace &quot;DomainFQDN =.*&quot; ,			&quot;DomainFQDN = `'$DomainFQDN`'&quot; }									| Set-Content $PS1File
(Get-Content $PS1File) | ForEach-Object { $_ -replace &quot;DomainNetBIOS =.*&quot; ,			&quot;DomainNetBIOS = `'$DomainNetBIOS`'&quot; }								| Set-Content $PS1File
(Get-Content $PS1File) | ForEach-Object { $_ -replace &quot;SQLServerName =.*&quot; ,			&quot;SQLServerName = `'$SQLServerName`'&quot; }								| Set-Content $PS1File
(Get-Content $PS1File) | ForEach-Object { $_ -replace &quot;Sitecode =.*&quot; ,				&quot;Sitecode = `'$Sitecode`'&quot; }										| Set-Content $PS1File
(Get-Content $PS1File) | ForEach-Object { $_ -replace &quot;SQLServiceAccountName =.*&quot; ,	&quot;SQLServiceAccountName = `'$SQLServiceAccountName`'&quot; }				| Set-Content $PS1File
(Get-Content $PS1File) | ForEach-Object { $_ -replace &quot;SQLServiceAccountPwd =.*&quot; ,	&quot;SQLServiceAccountPwd = `'$SQLServiceAccountPwd`'&quot; }				| Set-Content $PS1File		# Needs to use single quotation marks so literal characters are used
(Get-Content $PS1File) | ForEach-Object { $_ -replace &quot;SQLServiceName_Server =.*&quot; ,	&quot;SQLServiceName_Server = `&quot;MSSQL```$$env:SQL_InstanceName`&quot;&quot; }		| Set-Content $PS1File		# Needs to use double quotation marks so $ sign can be used
(Get-Content $PS1File) | ForEach-Object { $_ -replace &quot;SQLServiceName_Agent =.*&quot; ,	&quot;SQLServiceName_Agent = `&quot;SQLAgent```$$env:SQL_InstanceName`&quot;&quot; }	| Set-Content $PS1File

#Run PS1 file which configures ConfigMgr console
$ArgList = &quot;/c Powershell -file `&quot;$PS1File`&quot;&quot;
LaunchProcessAsUser &quot;$env:ComSpec&quot; $ArgList $ServiceAccountName $ServiceAccountPwd			# Needs to run %COMSPEC% as Powershell.exe was not found and is looking for absolute path
Log &quot;`n&quot;

Log &quot;Install ConfigMgr 2012 Configuration Pack...&quot;
$ArgList = &quot;/c Start /WAIT MSIEXEC.exe /i `&quot;$ScriptPath\ConfigMgr\ConfigMgr 2012\ConfigMgr 2012 Configuration Pack\ConfigMgr2012ConfigPack.msi`&quot; /qn /norestart /log `&quot;$env:windir\Debug\ConfigMgr2012\$env:Computername\$env:computername-CM2012 Configuration Pack.msi.log`&quot;&quot;
LaunchProcessAsUser &quot;$env:ComSpec&quot; $ArgList $ServiceAccountName $ServiceAccountPwd			# Needs to run %COMSPEC% in order to call START command
Log &quot;`n&quot;

Log &quot;Install ConfigMgr 2012 Servicing Extension...&quot;
$ArgList = &quot;/c Start /WAIT MSIEXEC.exe /i `&quot;$ScriptPath\ConfigMgr\ConfigMgr 2012\ConfigMgr 2012 Servicing Extension\Configuration Manager 2012 Servicing Extension.msi`&quot; /qn /norestart /log `&quot;$env:windir\Debug\ConfigMgr2012\$env:Computername\$env:computername-CM2012 Servicing Extension.msi.log`&quot;&quot;
LaunchProcessAsUser &quot;$env:ComSpec&quot; $ArgList $ServiceAccountName $ServiceAccountPwd			# Needs to run %COMSPEC% in order to call START command
Log &quot;`n&quot;

Log &quot;Install ConfigMgr 2012 Support Center...&quot;
$ArgList = &quot;/c Start /WAIT MSIEXEC.exe /i `&quot;$ScriptPath\ConfigMgr\ConfigMgr 2012\ConfigMgr 2012 Support Center\cmsupportcenter.msi`&quot; /qn /norestart /log `&quot;$env:windir\Debug\ConfigMgr2012\$env:Computername\$env:computername-CM2012 Support Center.msi.log`&quot;&quot;
LaunchProcessAsUser &quot;$env:ComSpec&quot; $ArgList $ServiceAccountName $ServiceAccountPwd			# Needs to run %COMSPEC% in order to call START command
Log &quot;`n&quot;


Log &quot;**** Finished: Console Config... ****&quot;</ns1:body>
        <ns1:type>Guest</ns1:type>
        <ns1:language>
            <ns1:name>powershell</ns1:name>
            <ns1:href>scriptlanguage/5</ns1:href>
            <ns1:id>5</ns1:id>
            <ns1:rel>down</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.ScriptLanguage+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:language>
        <ns1:runAsAdmin>false</ns1:runAsAdmin>
        <ns1:timeout>900</ns1:timeout>
        <ns1:retries>0</ns1:retries>
        <ns1:delay>300</ns1:delay>
        <ns1:errorAction>Abort</ns1:errorAction>
        <ns1:rebootRequired>false</ns1:rebootRequired>
        <ns1:runOnProvisionOnly>false</ns1:runOnProvisionOnly>
    </ns1:pendingAsset>
    <ns1:pendingAsset xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="ns1:Script">
        <ns1:name>MWS2R2 - CM2012 - Install Secondary</ns1:name>
        <ns1:id>157</ns1:id>
        <ns1:description>Needs to be triggered from PRIMARY server</ns1:description>
        <ns1:uuid>34a0d712-9b21-44dd-aad1-fbd71ed021ab</ns1:uuid>
        <ns1:assetType>
            <ns1:name>script</ns1:name>
            <ns1:href>assettype/2</ns1:href>
            <ns1:id>2</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.AssetType+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:assetType>
        <ns1:top>false</ns1:top>
        <ns1:assetPath>/Root/MWS2/MWS2_CDCR2</ns1:assetPath>
        <ns1:detailedAssetPath>/Root:#ID#1:#TYPE#VMContainer/MWS2:#ID#8:#TYPE#VMContainer/MWS2_CDCR2:#ID#9:#TYPE#VMProject</ns1:detailedAssetPath>
        <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
        <ns1:removable>true</ns1:removable>
        <ns1:domain>
            <ns1:name>domain1</ns1:name>
            <ns1:href>domain/1</ns1:href>
            <ns1:id>1</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Domain+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:domain>
        <ns1:creator>
            <ns1:name>dridley</ns1:name>
            <ns1:href>user/8</ns1:href>
            <ns1:id>8</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.User+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:creator>
        <ns1:created>2015-02-19T19:22:04-06:00</ns1:created>
        <ns1:lockType>0</ns1:lockType>
        <ns1:lastModified>2015-05-18T03:08:03-05:00</ns1:lastModified>
        <ns1:parent>
            <ns1:name>MWS2_CDCR2</ns1:name>
            <ns1:href>project/9</ns1:href>
            <ns1:id>9</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Project+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:parent>
        <ns1:version>-1</ns1:version>
        <ns1:latest>false</ns1:latest>
        <ns1:versionStatus>inprogress</ns1:versionStatus>
        <ns1:checkoutAllowed>false</ns1:checkoutAllowed>
        <ns1:headAllowed>false</ns1:headAllowed>
        <ns1:operatingSystem>Windows</ns1:operatingSystem>
        <ns1:enableExtensions>false</ns1:enableExtensions>
        <ns1:body>If ($CM_SECONDARY_NETBIOSNAME -eq $NULL) 	{Write-Host 'ERROR: $CM_SECONDARY_NETBIOSNAME not defined. Please set variable before running!'; EXIT 1}
If ($CM_SECONDARY_SITECODE -eq $NULL) 		{Write-Host 'ERROR: $CM_SECONDARY_SITECODE not defined. Please set variable before running!'; EXIT 1}
If ($CM_SECONDARY_DESCRIPTION -eq $NULL) 	{Write-Host 'ERROR: $CM_SECONDARY_DESCRIPTION not defined. Please set variable before running!'; EXIT 1}
If ($CM_SECONDARY_INSTALLDIR -eq $NULL) 	{Write-Host 'ERROR: $CM_SECONDARY_INSTALLDIR not defined. Please set variable before running!'; EXIT 1}


# Load Common functions
. .\GlobalRepository.ps1
# Copy Common scripts to local profile
Get-AppFiles &quot;Common&quot;

. .\Logging.ps1
. .\LaunchProcess.ps1
. .\FilesUtility.ps1
. .\PlatformUtils.ps1


# get current script location
$scriptPath = split-path -parent $MyInvocation.MyCommand.Definition
$scriptName = $MyInvocation.MyCommand.Name
 
ConfigureLogging $scriptPath $scriptName


#########################################################################
# Main
#########################################################################

#Use ArgList variable in Start-Process commands so embedded variables and env variables resolve

$DomainFQDN =			(get-globalvariable(&quot;Global\DomainFQDN&quot;)).value
$DomainNetBIOS = 		(get-globalvariable(&quot;Global\DomainNetBIOS&quot;)).value
$ServiceAccountName = 	&quot;$DomainNetBIOS\$env:CM_ServiceAccount&quot;
$ServiceAccountPwd = 	get-serviceAccountPassword -username $env:CM_ServiceAccount.ToLower()					# Covert to lowercase as get-serviceAccountPassword function is case sensitive

If ($DomainFQDN -eq $NULL) 			{Write-Host 'ERROR: $DomainFQDN cannot be determined'; EXIT 1}
If ($DomainNetBIOS -eq $NULL) 		{Write-Host 'ERROR: $DomainNetBIOS cannot be determined'; EXIT 1}
If ($ServiceAccountName -eq $NULL) 	{Write-Host 'ERROR: $ServiceAccountName not defined'; EXIT 1}
If ($ServiceAccountPwd -eq $NULL) 	{Write-Host 'ERROR: $ServiceAccountPwd cannot be determined'; EXIT 1}

Get-ScheduledTask | Where-Object {$_.TaskName -eq &quot;AgilityTask&quot;} | Unregister-ScheduledTask -Confirm:$False		# Cleanup existing tasks used by LaunchProcessAsUser function


Log &quot;**** Starting: Secondary Install... ****&quot;
Log &quot;`n&quot;


Log &quot;Customise PS1 template for Secondary install...&quot;
# Copy Template file
Get-AppFiles &quot;PC Devices\System Center\Server Provisioning\Secondary-DP&quot;
$PS1File = &quot;$env:windir\Debug\ConfigMgr2012\Unattend_$CM_SECONDARY_NETBIOSNAME.ps1&quot;
Move-Item &quot;$ScriptPath\Unattend_Template_SEC.ps_&quot; $PS1File -Force


# Update template
$CM_SECONDARY_NETBIOSNAME = $CM_SECONDARY_NETBIOSNAME.ToUpper()
(Get-Content $PS1File) | ForEach-Object { $_ -replace &quot;SecServer_Name =.*&quot; , 		&quot;SecServer_Name = `&quot;$CM_SECONDARY_NETBIOSNAME.$DomainFQDN`&quot;&quot; } 	| Set-Content $PS1File
(Get-Content $PS1File) | ForEach-Object { $_ -replace &quot;SecServer_Sitecode =.*&quot; , 	&quot;SecServer_Sitecode = `&quot;$CM_SECONDARY_SITECODE`&quot;&quot; } 			| Set-Content $PS1File
(Get-Content $PS1File) | ForEach-Object { $_ -replace &quot;SecServer_Sitename =.*&quot; , 	&quot;SecServer_Sitename = `&quot;$CM_SECONDARY_DESCRIPTION`&quot;&quot; } 			| Set-Content $PS1File
(Get-Content $PS1File) | ForEach-Object { $_ -replace &quot;SecServer_InstallDir =.*&quot; , 	&quot;SecServer_InstallDir = `&quot;$CM_SECONDARY_INSTALLDIR`&quot;&quot; }			| Set-Content $PS1File


Log &quot;Install ConfigMgr 2012 Secondary...&quot;
$ArgList = &quot;/c Powershell -file $PS1File&quot;
LaunchProcessAsUser &quot;$env:ComSpec&quot; $ArgList $ServiceAccountName $ServiceAccountPwd			# Needs to run %COMSPEC% as Powershell.exe was not found and is looking for absolute path
Log &quot;`n&quot;


Log &quot;Creating User Profile Cleanup Task...&quot;
$SchTasks_Date = (Get-Date).AddDays(5).ToString(&quot;MM/dd/yyyy&quot;)
$ProfPath = $env:UserProfile
# Create Agility User cleanup script
echo &quot;Get-CimInstance win32_userprofile -Verbose | Where {`$_.LocalPath -eq '$ProfPath'} | Remove-CimInstance -Verbose&quot; &gt; $env:windir\Debug\ConfigMgr2012\Agility-DelProf.ps1
SchTasks /Create /SC &quot;Once&quot; /SD $SchTasks_Date /ST 01:00 /F /RU &quot;SYSTEM&quot; /TN &quot;Agility-DelProf&quot; /TR &quot;Powershell.exe -File '$env:windir\Debug\ConfigMgr2012\Agility-DelProf.ps1'&quot;
Log &quot;`n&quot;


Log &quot;**** Finished: Secondary Install... ****&quot;</ns1:body>
        <ns1:type>Guest</ns1:type>
        <ns1:language>
            <ns1:name>powershell</ns1:name>
            <ns1:href>scriptlanguage/5</ns1:href>
            <ns1:id>5</ns1:id>
            <ns1:rel>down</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.ScriptLanguage+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:language>
        <ns1:runAsAdmin>false</ns1:runAsAdmin>
        <ns1:timeout>900</ns1:timeout>
        <ns1:retries>0</ns1:retries>
        <ns1:delay>300</ns1:delay>
        <ns1:errorAction>Abort</ns1:errorAction>
        <ns1:rebootRequired>true</ns1:rebootRequired>
        <ns1:variable>
            <ns1:name>CM_SECONDARY_NETBIOSNAME</ns1:name>
            <ns1:id>234</ns1:id>
            <ns1:description>NetBIOS name of Secondary Site Server</ns1:description>
            <ns1:uuid>24649615-dbee-44c2-9e4d-e66713248673</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath></ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:displayName>CM_SECONDARY_NETBIOSNAME</ns1:displayName>
            <ns1:readable>true</ns1:readable>
            <ns1:writable>true</ns1:writable>
            <ns1:minRequired>0</ns1:minRequired>
            <ns1:maxAllowed>1</ns1:maxAllowed>
            <ns1:validator/>
            <ns1:propertyType>
                <ns1:name>string-any</ns1:name>
                <ns1:href>propertytype/4</ns1:href>
                <ns1:id>4</ns1:id>
                <ns1:type>application/com.servicemesh.agility.api.PropertyType+xml</ns1:type>
            </ns1:propertyType>
            <ns1:assetPropertyLinkId>94db0a57-470b-40cb-a908-b6ae5713fcbc</ns1:assetPropertyLinkId>
        </ns1:variable>
        <ns1:variable>
            <ns1:name>CM_SECONDARY_SITECODE</ns1:name>
            <ns1:id>235</ns1:id>
            <ns1:description>Sitecode of Secondary Site Server</ns1:description>
            <ns1:uuid>6ae34fed-5cc7-4f5c-b07d-4dd871c68e3c</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath></ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:displayName>CM_SECONDARY_SITECODE</ns1:displayName>
            <ns1:readable>true</ns1:readable>
            <ns1:writable>true</ns1:writable>
            <ns1:minRequired>0</ns1:minRequired>
            <ns1:maxAllowed>1</ns1:maxAllowed>
            <ns1:validator/>
            <ns1:propertyType>
                <ns1:name>string-any</ns1:name>
                <ns1:href>propertytype/4</ns1:href>
                <ns1:id>4</ns1:id>
                <ns1:type>application/com.servicemesh.agility.api.PropertyType+xml</ns1:type>
            </ns1:propertyType>
            <ns1:assetPropertyLinkId>79840694-41b3-44ab-8915-86c75e254ee0</ns1:assetPropertyLinkId>
        </ns1:variable>
        <ns1:variable>
            <ns1:name>CM_SECONDARY_DESCRIPTION</ns1:name>
            <ns1:id>236</ns1:id>
            <ns1:description>Description of ConfigMgr server</ns1:description>
            <ns1:uuid>1de93103-9be3-46a7-b3e9-07098fd007a6</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath></ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:displayName>CM_SECONDARY_DESCRIPTION</ns1:displayName>
            <ns1:readable>true</ns1:readable>
            <ns1:writable>true</ns1:writable>
            <ns1:minRequired>0</ns1:minRequired>
            <ns1:maxAllowed>1</ns1:maxAllowed>
            <ns1:validator/>
            <ns1:propertyType>
                <ns1:name>string-any</ns1:name>
                <ns1:href>propertytype/4</ns1:href>
                <ns1:id>4</ns1:id>
                <ns1:type>application/com.servicemesh.agility.api.PropertyType+xml</ns1:type>
            </ns1:propertyType>
            <ns1:assetPropertyLinkId>4a638b25-4809-4ac8-97f2-a41745fb04a1</ns1:assetPropertyLinkId>
        </ns1:variable>
        <ns1:variable>
            <ns1:name>CM_SECONDARY_INSTALLDIR</ns1:name>
            <ns1:id>237</ns1:id>
            <ns1:description>Folder where ConfigMgr will be installed</ns1:description>
            <ns1:uuid>23a54461-f752-465e-8f6b-253663521d27</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath></ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:displayName>CM_SECONDARY_INSTALLDIR</ns1:displayName>
            <ns1:readable>true</ns1:readable>
            <ns1:writable>true</ns1:writable>
            <ns1:minRequired>0</ns1:minRequired>
            <ns1:maxAllowed>1</ns1:maxAllowed>
            <ns1:validator/>
            <ns1:defaultValue>
                <ns1:id>17540</ns1:id>
                <ns1:name></ns1:name>
                <ns1:encrypted>false</ns1:encrypted>
                <ns1:overridable>true</ns1:overridable>
                <ns1:propertyType>
                    <ns1:name>string-any</ns1:name>
                    <ns1:href>/propertytype/4</ns1:href>
                    <ns1:id>4</ns1:id>
                    <ns1:rel>up</ns1:rel>
                    <ns1:type>application/com.servicemesh.agility.api.PropertyType+xml</ns1:type>
                    <ns1:position>0</ns1:position>
                </ns1:propertyType>
                <ns1:stringValue>F:\SMS_ConfigMgr</ns1:stringValue>
            </ns1:defaultValue>
            <ns1:propertyType>
                <ns1:name>string-any</ns1:name>
                <ns1:href>propertytype/4</ns1:href>
                <ns1:id>4</ns1:id>
                <ns1:type>application/com.servicemesh.agility.api.PropertyType+xml</ns1:type>
            </ns1:propertyType>
            <ns1:assetPropertyLinkId>56299064-df57-4b78-a2b5-dbfc3bbb3074</ns1:assetPropertyLinkId>
        </ns1:variable>
        <ns1:runOnProvisionOnly>false</ns1:runOnProvisionOnly>
    </ns1:pendingAsset>
    <ns1:pendingAsset xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="ns1:Package">
        <ns1:name>MWS2R2 - ConfigMgr2012 - Primary Build</ns1:name>
        <ns1:id>44</ns1:id>
        <ns1:description></ns1:description>
        <ns1:uuid>18ae8b82-cdee-4a60-8088-8580e5386ff5</ns1:uuid>
        <ns1:assetType>
            <ns1:name>package</ns1:name>
            <ns1:href>assettype/3</ns1:href>
            <ns1:id>3</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.AssetType+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:assetType>
        <ns1:top>false</ns1:top>
        <ns1:assetPath>/Root/MWS2/MWS2_CDCR2</ns1:assetPath>
        <ns1:detailedAssetPath>/Root:#ID#1:#TYPE#VMContainer/MWS2:#ID#8:#TYPE#VMContainer/MWS2_CDCR2:#ID#9:#TYPE#VMProject</ns1:detailedAssetPath>
        <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
        <ns1:removable>true</ns1:removable>
        <ns1:domain>
            <ns1:name>domain1</ns1:name>
            <ns1:href>domain/1</ns1:href>
            <ns1:id>1</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Domain+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:domain>
        <ns1:creator>
            <ns1:name>dridley</ns1:name>
            <ns1:href>user/8</ns1:href>
            <ns1:id>8</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.User+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:creator>
        <ns1:created>2015-02-19T19:59:47-06:00</ns1:created>
        <ns1:lockType>0</ns1:lockType>
        <ns1:lastModified>2015-05-14T20:58:01-05:00</ns1:lastModified>
        <ns1:parent>
            <ns1:name>MWS2_CDCR2</ns1:name>
            <ns1:href>project/9</ns1:href>
            <ns1:id>9</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Project+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:parent>
        <ns1:version>-1</ns1:version>
        <ns1:latest>false</ns1:latest>
        <ns1:versionStatus>inprogress</ns1:versionStatus>
        <ns1:checkoutAllowed>false</ns1:checkoutAllowed>
        <ns1:headAllowed>false</ns1:headAllowed>
        <ns1:operatingSystem>Windows</ns1:operatingSystem>
        <ns1:install>
            <ns1:name>MWS2R2 - CM2012 - Static Vars Primary</ns1:name>
            <ns1:href>script/163</ns1:href>
            <ns1:id>163</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Script+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:install>
        <ns1:install>
            <ns1:name>MWS2R2 - CM2012 - Prereqs Common</ns1:name>
            <ns1:href>script/160</ns1:href>
            <ns1:id>160</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Script+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:install>
        <ns1:install>
            <ns1:name>MWS2R2 - CM2012 - Prereqs Primary</ns1:name>
            <ns1:href>script/161</ns1:href>
            <ns1:id>161</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Script+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:install>
        <ns1:install>
            <ns1:name>MWS2R2 - CM2012 - Install Primary</ns1:name>
            <ns1:href>script/156</ns1:href>
            <ns1:id>156</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Script+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:install>
        <ns1:install>
            <ns1:name>MWS2R2 - CM2012 - POST Config (PRI)</ns1:name>
            <ns1:href>script/158</ns1:href>
            <ns1:id>158</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Script+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:install>
        <ns1:operational>
            <ns1:name>MWS2R2 - AD Global Repository</ns1:name>
            <ns1:href>script/228</ns1:href>
            <ns1:id>268</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Script+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:operational>
        <ns1:operational>
            <ns1:name>MWS2R2 - CM2012 - Static Vars Primary</ns1:name>
            <ns1:href>script/163</ns1:href>
            <ns1:id>163</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Script+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:operational>
        <ns1:operational>
            <ns1:name>MWS2R2 - CM2012 - Prereqs Common</ns1:name>
            <ns1:href>script/160</ns1:href>
            <ns1:id>160</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Script+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:operational>
        <ns1:operational>
            <ns1:name>MWS2R2 - CM2012 - Prereqs Primary</ns1:name>
            <ns1:href>script/161</ns1:href>
            <ns1:id>161</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Script+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:operational>
        <ns1:operational>
            <ns1:name>MWS2R2 - CM2012 - Install Primary</ns1:name>
            <ns1:href>script/156</ns1:href>
            <ns1:id>156</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Script+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:operational>
        <ns1:operational>
            <ns1:name>MWS2R2 - CM2012 - POST Config (PRI)</ns1:name>
            <ns1:href>script/158</ns1:href>
            <ns1:id>158</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Script+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:operational>
        <ns1:operational>
            <ns1:name>MWS2R2 - CM2012 - Install Secondary</ns1:name>
            <ns1:href>script/157</ns1:href>
            <ns1:id>157</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Script+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:operational>
    </ns1:pendingAsset>
    <ns1:pendingAsset xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="ns1:Image">
        <ns1:name>CSCSOE611Agility v1.2</ns1:name>
        <ns1:id>144</ns1:id>
        <ns1:uuid>8f8cfee8-72e2-40ca-b56f-ad1303cdbe95</ns1:uuid>
        <ns1:assetType>
            <ns1:name>image</ns1:name>
            <ns1:href>assettype/19</ns1:href>
            <ns1:id>19</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.AssetType+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:assetType>
        <ns1:top>false</ns1:top>
        <ns1:assetPath></ns1:assetPath>
        <ns1:detailedAssetPath></ns1:detailedAssetPath>
        <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
        <ns1:removable>true</ns1:removable>
        <ns1:architecture>x86_64</ns1:architecture>
        <ns1:imageId>CSCSOE611Agility v1.2</ns1:imageId>
        <ns1:cloudType>
            <ns1:name>Microsoft Private Cloud</ns1:name>
            <ns1:href>cloudtype/8</ns1:href>
            <ns1:id>8</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.CloudType+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:cloudType>
        <ns1:cloud>
            <ns1:name>MWS2 CDC MS Private Cloud</ns1:name>
            <ns1:href>cloud/3</ns1:href>
            <ns1:id>3</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Cloud+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:cloud>
        <ns1:location>a21f5a7c-eb3d-43e4-87b2-dfc6245fcf57</ns1:location>
        <ns1:credentials>
            <ns1:name>smadmin</ns1:name>
            <ns1:id>1592</ns1:id>
            <ns1:uuid>6cc537ad-38b4-42d3-899b-080807f04cf5</ns1:uuid>
            <ns1:assetType>
                <ns1:name>credential</ns1:name>
                <ns1:href>assettype/26</ns1:href>
                <ns1:id>26</ns1:id>
                <ns1:rel>up</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.AssetType+xml</ns1:type>
                <ns1:position>0</ns1:position>
            </ns1:assetType>
            <ns1:top>false</ns1:top>
            <ns1:assetPath>/Root</ns1:assetPath>
            <ns1:detailedAssetPath>/Root:#ID#1:#TYPE#VMContainer</ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:domain>
                <ns1:name>domain1</ns1:name>
                <ns1:href>domain/1</ns1:href>
                <ns1:id>1</ns1:id>
                <ns1:rel>up</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Domain+xml</ns1:type>
                <ns1:position>0</ns1:position>
            </ns1:domain>
            <ns1:creator>
                <ns1:name>mfreeman</ns1:name>
                <ns1:href>user/12</ns1:href>
                <ns1:id>12</ns1:id>
                <ns1:rel>up</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.User+xml</ns1:type>
                <ns1:position>0</ns1:position>
            </ns1:creator>
            <ns1:created>2015-04-13T22:18:35-05:00</ns1:created>
            <ns1:lockType>0</ns1:lockType>
            <ns1:parent>
                <ns1:name>Root</ns1:name>
                <ns1:href>container/1</ns1:href>
                <ns1:id>1</ns1:id>
                <ns1:rel>up</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Container+xml</ns1:type>
                <ns1:position>0</ns1:position>
            </ns1:parent>
            <ns1:credentialType>Username/Password</ns1:credentialType>
            <ns1:publicKey>4370ad9a3e3eec88f75a08e449eaf430</ns1:publicKey>
            <ns1:privateKey>daa6ebc71ed1683d6dedde6ad64cbc6d</ns1:privateKey>
            <ns1:encrypted>true</ns1:encrypted>
        </ns1:credentials>
        <ns1:resources>
            <ns1:name>Base Partition</ns1:name>
            <ns1:id>9439</ns1:id>
            <ns1:uuid>4c483864-d8e8-4975-8661-9fe93099958f</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath></ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:applicationType>application/com.servicemesh.agility.api.Resource+xml</ns1:applicationType>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:resourceType>Disk Drive</ns1:resourceType>
            <ns1:units>GB</ns1:units>
            <ns1:quantity>10.0</ns1:quantity>
        </ns1:resources>
        <ns1:resources>
            <ns1:name>Processor</ns1:name>
            <ns1:id>9440</ns1:id>
            <ns1:uuid>68a5c108-306b-4aac-b5ac-a971f8991ba0</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath></ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:applicationType>application/com.servicemesh.agility.api.Resource+xml</ns1:applicationType>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:resourceType>Processor</ns1:resourceType>
            <ns1:units>Cores</ns1:units>
            <ns1:quantity>2.0</ns1:quantity>
        </ns1:resources>
        <ns1:resources>
            <ns1:name>Memory</ns1:name>
            <ns1:id>9441</ns1:id>
            <ns1:uuid>d872deeb-1cbd-494a-9c1e-f87cb31988dd</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath></ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:applicationType>application/com.servicemesh.agility.api.Resource+xml</ns1:applicationType>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:resourceType>Memory</ns1:resourceType>
            <ns1:units>MB</ns1:units>
            <ns1:quantity>2048.0</ns1:quantity>
        </ns1:resources>
        <ns1:resources xsi:type="ns1:NetworkInterface">
            <ns1:name>Network Adapter</ns1:name>
            <ns1:id>9442</ns1:id>
            <ns1:uuid>cfaf8eb5-ca2f-423d-ac7a-2b285256cd03</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath></ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:resourceType>Ethernet Adapter</ns1:resourceType>
            <ns1:quantity>1.0</ns1:quantity>
        </ns1:resources>
        <ns1:mgmtProtocol>winrm-https</ns1:mgmtProtocol>
        <ns1:mgmtPort>5986</ns1:mgmtPort>
        <ns1:properties>
            <ns1:name>StampId</ns1:name>
            <ns1:id>1559</ns1:id>
            <ns1:uuid>c950c04b-a4f8-4350-b924-6bb6e7435e18</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath></ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:value>24e5f175-dd8d-4f4c-924a-06655aff49f2</ns1:value>
            <ns1:overridable>false</ns1:overridable>
            <ns1:encrypted>false</ns1:encrypted>
            <ns1:dataEncrypted>false</ns1:dataEncrypted>
        </ns1:properties>
        <ns1:properties>
            <ns1:name>OSName</ns1:name>
            <ns1:id>1560</ns1:id>
            <ns1:uuid>20f3e099-f727-42d0-8d2d-7306d47de1b4</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath></ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:value>Windows Server 2012 R2 Standard</ns1:value>
            <ns1:overridable>false</ns1:overridable>
            <ns1:encrypted>false</ns1:encrypted>
            <ns1:dataEncrypted>false</ns1:dataEncrypted>
        </ns1:properties>
        <ns1:locations>
            <ns1:name>MWS AGL Pool CDC Cloud</ns1:name>
            <ns1:href>location/1</ns1:href>
            <ns1:id>1</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Location+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:locations>
        <ns1:memoryAddSupported>false</ns1:memoryAddSupported>
        <ns1:memoryRemoveSupported>false</ns1:memoryRemoveSupported>
        <ns1:cpuAddSupported>false</ns1:cpuAddSupported>
        <ns1:cpuRemoveSupported>false</ns1:cpuRemoveSupported>
        <ns1:flagsSynced>true</ns1:flagsSynced>
    </ns1:pendingAsset>
    <ns1:pendingAsset xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="ns1:Stack">
        <ns1:name>CSC SOE 6.1.1 Agility</ns1:name>
        <ns1:id>74</ns1:id>
        <ns1:description></ns1:description>
        <ns1:uuid>e0357a53-3bea-4adb-abfe-b67438aa81b9</ns1:uuid>
        <ns1:assetType>
            <ns1:name>stack</ns1:name>
            <ns1:href>assettype/18</ns1:href>
            <ns1:id>18</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.AssetType+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:assetType>
        <ns1:top>false</ns1:top>
        <ns1:Asset xsi:type="ns1:Image">
            <ns1:name>CSCSOE611Agility v1.2</ns1:name>
            <ns1:id>144</ns1:id>
            <ns1:uuid>8f8cfee8-72e2-40ca-b56f-ad1303cdbe95</ns1:uuid>
            <ns1:assetType>
                <ns1:name>image</ns1:name>
                <ns1:href>assettype/19</ns1:href>
                <ns1:id>19</ns1:id>
                <ns1:rel>up</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.AssetType+xml</ns1:type>
                <ns1:position>0</ns1:position>
            </ns1:assetType>
            <ns1:top>false</ns1:top>
            <ns1:assetPath></ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:architecture>x86_64</ns1:architecture>
            <ns1:imageId>CSCSOE611Agility v1.2</ns1:imageId>
            <ns1:cloudType>
                <ns1:name>Microsoft Private Cloud</ns1:name>
                <ns1:href>cloudtype/8</ns1:href>
                <ns1:id>8</ns1:id>
                <ns1:rel>up</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.CloudType+xml</ns1:type>
                <ns1:position>0</ns1:position>
            </ns1:cloudType>
            <ns1:cloud>
                <ns1:name>MWS2 CDC MS Private Cloud</ns1:name>
                <ns1:href>cloud/3</ns1:href>
                <ns1:id>3</ns1:id>
                <ns1:rel>up</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Cloud+xml</ns1:type>
                <ns1:position>0</ns1:position>
            </ns1:cloud>
            <ns1:location>a21f5a7c-eb3d-43e4-87b2-dfc6245fcf57</ns1:location>
            <ns1:credentials>
                <ns1:name>smadmin</ns1:name>
                <ns1:id>1592</ns1:id>
                <ns1:uuid>6cc537ad-38b4-42d3-899b-080807f04cf5</ns1:uuid>
                <ns1:assetType>
                    <ns1:name>credential</ns1:name>
                    <ns1:href>assettype/26</ns1:href>
                    <ns1:id>26</ns1:id>
                    <ns1:rel>up</ns1:rel>
                    <ns1:type>application/com.servicemesh.agility.api.AssetType+xml</ns1:type>
                    <ns1:position>0</ns1:position>
                </ns1:assetType>
                <ns1:top>false</ns1:top>
                <ns1:assetPath>/Root</ns1:assetPath>
                <ns1:detailedAssetPath>/Root:#ID#1:#TYPE#VMContainer</ns1:detailedAssetPath>
                <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
                <ns1:removable>true</ns1:removable>
                <ns1:domain>
                    <ns1:name>domain1</ns1:name>
                    <ns1:href>domain/1</ns1:href>
                    <ns1:id>1</ns1:id>
                    <ns1:rel>up</ns1:rel>
                    <ns1:type>application/com.servicemesh.agility.api.Domain+xml</ns1:type>
                    <ns1:position>0</ns1:position>
                </ns1:domain>
                <ns1:creator>
                    <ns1:name>mfreeman</ns1:name>
                    <ns1:href>user/12</ns1:href>
                    <ns1:id>12</ns1:id>
                    <ns1:rel>up</ns1:rel>
                    <ns1:type>application/com.servicemesh.agility.api.User+xml</ns1:type>
                    <ns1:position>0</ns1:position>
                </ns1:creator>
                <ns1:created>2015-04-13T22:18:35-05:00</ns1:created>
                <ns1:lockType>0</ns1:lockType>
                <ns1:parent>
                    <ns1:name>Root</ns1:name>
                    <ns1:href>container/1</ns1:href>
                    <ns1:id>1</ns1:id>
                    <ns1:rel>up</ns1:rel>
                    <ns1:type>application/com.servicemesh.agility.api.Container+xml</ns1:type>
                    <ns1:position>0</ns1:position>
                </ns1:parent>
                <ns1:credentialType>Username/Password</ns1:credentialType>
                <ns1:publicKey>4370ad9a3e3eec88f75a08e449eaf430</ns1:publicKey>
                <ns1:privateKey>daa6ebc71ed1683d6dedde6ad64cbc6d</ns1:privateKey>
                <ns1:encrypted>true</ns1:encrypted>
            </ns1:credentials>
            <ns1:resources>
                <ns1:name>Base Partition</ns1:name>
                <ns1:id>9439</ns1:id>
                <ns1:uuid>4c483864-d8e8-4975-8661-9fe93099958f</ns1:uuid>
                <ns1:top>false</ns1:top>
                <ns1:assetPath></ns1:assetPath>
                <ns1:detailedAssetPath></ns1:detailedAssetPath>
                <ns1:applicationType>application/com.servicemesh.agility.api.Resource+xml</ns1:applicationType>
                <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
                <ns1:removable>true</ns1:removable>
                <ns1:resourceType>Disk Drive</ns1:resourceType>
                <ns1:units>GB</ns1:units>
                <ns1:quantity>10.0</ns1:quantity>
            </ns1:resources>
            <ns1:resources>
                <ns1:name>Processor</ns1:name>
                <ns1:id>9440</ns1:id>
                <ns1:uuid>68a5c108-306b-4aac-b5ac-a971f8991ba0</ns1:uuid>
                <ns1:top>false</ns1:top>
                <ns1:assetPath></ns1:assetPath>
                <ns1:detailedAssetPath></ns1:detailedAssetPath>
                <ns1:applicationType>application/com.servicemesh.agility.api.Resource+xml</ns1:applicationType>
                <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
                <ns1:removable>true</ns1:removable>
                <ns1:resourceType>Processor</ns1:resourceType>
                <ns1:units>Cores</ns1:units>
                <ns1:quantity>2.0</ns1:quantity>
            </ns1:resources>
            <ns1:resources>
                <ns1:name>Memory</ns1:name>
                <ns1:id>9441</ns1:id>
                <ns1:uuid>d872deeb-1cbd-494a-9c1e-f87cb31988dd</ns1:uuid>
                <ns1:top>false</ns1:top>
                <ns1:assetPath></ns1:assetPath>
                <ns1:detailedAssetPath></ns1:detailedAssetPath>
                <ns1:applicationType>application/com.servicemesh.agility.api.Resource+xml</ns1:applicationType>
                <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
                <ns1:removable>true</ns1:removable>
                <ns1:resourceType>Memory</ns1:resourceType>
                <ns1:units>MB</ns1:units>
                <ns1:quantity>2048.0</ns1:quantity>
            </ns1:resources>
            <ns1:resources xsi:type="ns1:NetworkInterface">
                <ns1:name>Network Adapter</ns1:name>
                <ns1:id>9442</ns1:id>
                <ns1:uuid>cfaf8eb5-ca2f-423d-ac7a-2b285256cd03</ns1:uuid>
                <ns1:top>false</ns1:top>
                <ns1:assetPath></ns1:assetPath>
                <ns1:detailedAssetPath></ns1:detailedAssetPath>
                <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
                <ns1:removable>true</ns1:removable>
                <ns1:resourceType>Ethernet Adapter</ns1:resourceType>
                <ns1:quantity>1.0</ns1:quantity>
            </ns1:resources>
            <ns1:mgmtProtocol>winrm-https</ns1:mgmtProtocol>
            <ns1:mgmtPort>5986</ns1:mgmtPort>
            <ns1:properties>
                <ns1:name>StampId</ns1:name>
                <ns1:id>1559</ns1:id>
                <ns1:uuid>c950c04b-a4f8-4350-b924-6bb6e7435e18</ns1:uuid>
                <ns1:top>false</ns1:top>
                <ns1:assetPath></ns1:assetPath>
                <ns1:detailedAssetPath></ns1:detailedAssetPath>
                <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
                <ns1:removable>true</ns1:removable>
                <ns1:value>24e5f175-dd8d-4f4c-924a-06655aff49f2</ns1:value>
                <ns1:overridable>false</ns1:overridable>
                <ns1:encrypted>false</ns1:encrypted>
                <ns1:dataEncrypted>false</ns1:dataEncrypted>
            </ns1:properties>
            <ns1:properties>
                <ns1:name>OSName</ns1:name>
                <ns1:id>1560</ns1:id>
                <ns1:uuid>20f3e099-f727-42d0-8d2d-7306d47de1b4</ns1:uuid>
                <ns1:top>false</ns1:top>
                <ns1:assetPath></ns1:assetPath>
                <ns1:detailedAssetPath></ns1:detailedAssetPath>
                <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
                <ns1:removable>true</ns1:removable>
                <ns1:value>Windows Server 2012 R2 Standard</ns1:value>
                <ns1:overridable>false</ns1:overridable>
                <ns1:encrypted>false</ns1:encrypted>
                <ns1:dataEncrypted>false</ns1:dataEncrypted>
            </ns1:properties>
            <ns1:locations>
                <ns1:name>MWS AGL Pool CDC Cloud</ns1:name>
                <ns1:href>location/1</ns1:href>
                <ns1:id>1</ns1:id>
                <ns1:rel>up</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Location+xml</ns1:type>
                <ns1:position>0</ns1:position>
            </ns1:locations>
            <ns1:memoryAddSupported>false</ns1:memoryAddSupported>
            <ns1:memoryRemoveSupported>false</ns1:memoryRemoveSupported>
            <ns1:cpuAddSupported>false</ns1:cpuAddSupported>
            <ns1:cpuRemoveSupported>false</ns1:cpuRemoveSupported>
            <ns1:flagsSynced>true</ns1:flagsSynced>
        </ns1:Asset>
        <ns1:Asset xsi:type="ns1:Template">
            <ns1:name>CSC SOE 6.1.1 Agility</ns1:name>
            <ns1:id>572</ns1:id>
            <ns1:description></ns1:description>
            <ns1:uuid>5914d698-ddf2-489a-93cc-8e2e0d8e668f</ns1:uuid>
            <ns1:assetType>
                <ns1:name>template</ns1:name>
                <ns1:href>assettype/20</ns1:href>
                <ns1:id>20</ns1:id>
                <ns1:rel>up</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.AssetType+xml</ns1:type>
                <ns1:position>0</ns1:position>
            </ns1:assetType>
            <ns1:top>false</ns1:top>
            <ns1:assetPath>/Root/MWS2/MWS2_CDCR2</ns1:assetPath>
            <ns1:detailedAssetPath>/Root:#ID#1:#TYPE#VMContainer/MWS2:#ID#8:#TYPE#VMContainer/MWS2_CDCR2:#ID#9:#TYPE#VMProject</ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:domain>
                <ns1:name>domain1</ns1:name>
                <ns1:href>domain/1</ns1:href>
                <ns1:id>1</ns1:id>
                <ns1:rel>up</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Domain+xml</ns1:type>
                <ns1:position>0</ns1:position>
            </ns1:domain>
            <ns1:creator>
                <ns1:name>mfreeman</ns1:name>
                <ns1:href>user/12</ns1:href>
                <ns1:id>12</ns1:id>
                <ns1:rel>up</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.User+xml</ns1:type>
                <ns1:position>0</ns1:position>
            </ns1:creator>
            <ns1:created>2015-04-13T22:18:06-05:00</ns1:created>
            <ns1:lockType>0</ns1:lockType>
            <ns1:parent>
                <ns1:name>MWS2_CDCR2</ns1:name>
                <ns1:href>project/9</ns1:href>
                <ns1:id>9</ns1:id>
                <ns1:rel>up</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Project+xml</ns1:type>
                <ns1:position>0</ns1:position>
            </ns1:parent>
            <ns1:numInstances>0</ns1:numInstances>
            <ns1:topology>
                <ns1:name>MWS2_CDCR2</ns1:name>
                <ns1:href>topology/9</ns1:href>
                <ns1:id>9</ns1:id>
                <ns1:rel>up</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Topology+xml</ns1:type>
                <ns1:position>0</ns1:position>
            </ns1:topology>
            <ns1:factory>true</ns1:factory>
            <ns1:stack>
                <ns1:name>CSC SOE 6.1.1 Agility</ns1:name>
                <ns1:href>stack/74</ns1:href>
                <ns1:id>74</ns1:id>
                <ns1:rel>up</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Stack+xml</ns1:type>
                <ns1:position>0</ns1:position>
            </ns1:stack>
            <ns1:onboarded>false</ns1:onboarded>
            <ns1:project>
                <ns1:name>MWS2_CDCR2</ns1:name>
                <ns1:href>project/9</ns1:href>
                <ns1:id>9</ns1:id>
                <ns1:rel>up</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Project+xml</ns1:type>
                <ns1:position>0</ns1:position>
            </ns1:project>
            <ns1:releaseDisks>false</ns1:releaseDisks>
            <ns1:stats>
                <ns1:templateId>572</ns1:templateId>
                <ns1:numUnknown>0</ns1:numUnknown>
                <ns1:numStarting>0</ns1:numStarting>
                <ns1:numRunning>0</ns1:numRunning>
                <ns1:numPaused>0</ns1:numPaused>
                <ns1:numStopping>0</ns1:numStopping>
                <ns1:numStopped>0</ns1:numStopped>
                <ns1:numDestroyed>0</ns1:numDestroyed>
                <ns1:numFailed>0</ns1:numFailed>
                <ns1:numDegraded>0</ns1:numDegraded>
                <ns1:numInstances>0</ns1:numInstances>
                <ns1:minCount>0</ns1:minCount>
                <ns1:maxCount>0</ns1:maxCount>
                <ns1:status>Unknown</ns1:status>
            </ns1:stats>
        </ns1:Asset>
        <ns1:Asset xsi:type="ns1:TargetCloud">
            <ns1:name>CSC SOE 6.1.1 Agility-MWS2 CDC MS Private Cloud</ns1:name>
            <ns1:id>21</ns1:id>
            <ns1:description>CSC SOE 6.1.1 Agility-MWS2 CDC MS Private Cloud: </ns1:description>
            <ns1:uuid>0f2fe80a-e513-428b-82eb-f7695aaac457</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:Asset xsi:type="ns1:Template">
                <ns1:name>CSC SOE 6.1.1 Agility-MWS2 CDC MS Private Cloud</ns1:name>
                <ns1:id>573</ns1:id>
                <ns1:description>CSC SOE 6.1.1 Agility-MWS2 CDC MS Private Cloud: </ns1:description>
                <ns1:uuid>ab63dec5-7c5d-4b8f-acea-100f7f588281</ns1:uuid>
                <ns1:assetType>
                    <ns1:name>template</ns1:name>
                    <ns1:href>assettype/20</ns1:href>
                    <ns1:id>20</ns1:id>
                    <ns1:rel>up</ns1:rel>
                    <ns1:type>application/com.servicemesh.agility.api.AssetType+xml</ns1:type>
                    <ns1:position>0</ns1:position>
                </ns1:assetType>
                <ns1:top>false</ns1:top>
                <ns1:assetPath>/Root/MWS2/MWS2_CDCR2</ns1:assetPath>
                <ns1:detailedAssetPath>/Root:#ID#1:#TYPE#VMContainer/MWS2:#ID#8:#TYPE#VMContainer/MWS2_CDCR2:#ID#9:#TYPE#VMProject</ns1:detailedAssetPath>
                <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
                <ns1:removable>true</ns1:removable>
                <ns1:domain>
                    <ns1:name>domain1</ns1:name>
                    <ns1:href>domain/1</ns1:href>
                    <ns1:id>1</ns1:id>
                    <ns1:rel>up</ns1:rel>
                    <ns1:type>application/com.servicemesh.agility.api.Domain+xml</ns1:type>
                    <ns1:position>0</ns1:position>
                </ns1:domain>
                <ns1:creator>
                    <ns1:name>mfreeman</ns1:name>
                    <ns1:href>user/12</ns1:href>
                    <ns1:id>12</ns1:id>
                    <ns1:rel>up</ns1:rel>
                    <ns1:type>application/com.servicemesh.agility.api.User+xml</ns1:type>
                    <ns1:position>0</ns1:position>
                </ns1:creator>
                <ns1:created>2015-04-13T22:18:06-05:00</ns1:created>
                <ns1:lockType>0</ns1:lockType>
                <ns1:parent>
                    <ns1:name>MWS2_CDCR2</ns1:name>
                    <ns1:href>project/9</ns1:href>
                    <ns1:id>9</ns1:id>
                    <ns1:rel>up</ns1:rel>
                    <ns1:type>application/com.servicemesh.agility.api.Project+xml</ns1:type>
                    <ns1:position>0</ns1:position>
                </ns1:parent>
                <ns1:numInstances>1</ns1:numInstances>
                <ns1:topology>
                    <ns1:name>MWS2_CDCR2</ns1:name>
                    <ns1:href>topology/9</ns1:href>
                    <ns1:id>9</ns1:id>
                    <ns1:rel>up</ns1:rel>
                    <ns1:type>application/com.servicemesh.agility.api.Topology+xml</ns1:type>
                    <ns1:position>0</ns1:position>
                </ns1:topology>
                <ns1:cloud>
                    <ns1:name>MWS2 CDC MS Private Cloud</ns1:name>
                    <ns1:href>cloud/3</ns1:href>
                    <ns1:id>3</ns1:id>
                    <ns1:rel>up</ns1:rel>
                    <ns1:type>application/com.servicemesh.agility.api.Cloud+xml</ns1:type>
                    <ns1:position>0</ns1:position>
                </ns1:cloud>
                <ns1:factory>true</ns1:factory>
                <ns1:stack>
                    <ns1:name>CSC SOE 6.1.1 Agility</ns1:name>
                    <ns1:href>stack/74</ns1:href>
                    <ns1:id>74</ns1:id>
                    <ns1:rel>up</ns1:rel>
                    <ns1:type>application/com.servicemesh.agility.api.Stack+xml</ns1:type>
                    <ns1:position>0</ns1:position>
                </ns1:stack>
                <ns1:image>
                    <ns1:name>CSCSOE611Agility v1.2</ns1:name>
                    <ns1:href>image/144</ns1:href>
                    <ns1:id>144</ns1:id>
                    <ns1:rel>up</ns1:rel>
                    <ns1:type>application/com.servicemesh.agility.api.Image+xml</ns1:type>
                    <ns1:position>0</ns1:position>
                </ns1:image>
                <ns1:model>2CPU 2GB HA</ns1:model>
                <ns1:location>MWS AGL Pool CDC Cloud</ns1:location>
                <ns1:credential>
                    <ns1:name>admin-default</ns1:name>
                    <ns1:id>80</ns1:id>
                    <ns1:uuid>ac6ef924-258d-47af-8028-8ac133ed5222</ns1:uuid>
                    <ns1:assetType>
                        <ns1:name>credential</ns1:name>
                        <ns1:href>assettype/26</ns1:href>
                        <ns1:id>26</ns1:id>
                        <ns1:rel>up</ns1:rel>
                        <ns1:type>application/com.servicemesh.agility.api.AssetType+xml</ns1:type>
                        <ns1:position>0</ns1:position>
                    </ns1:assetType>
                    <ns1:top>false</ns1:top>
                    <ns1:assetPath>/Root/MWS2</ns1:assetPath>
                    <ns1:detailedAssetPath>/Root:#ID#1:#TYPE#VMContainer/MWS2:#ID#8:#TYPE#VMContainer</ns1:detailedAssetPath>
                    <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
                    <ns1:removable>true</ns1:removable>
                    <ns1:lockType>0</ns1:lockType>
                    <ns1:parent>
                        <ns1:name>MWS2</ns1:name>
                        <ns1:href>container/8</ns1:href>
                        <ns1:id>8</ns1:id>
                        <ns1:rel>up</ns1:rel>
                        <ns1:type>application/com.servicemesh.agility.api.Container+xml</ns1:type>
                        <ns1:position>0</ns1:position>
                    </ns1:parent>
                    <ns1:credentialType>SSH</ns1:credentialType>
                    <ns1:publicKey>3a307f2660ba16e026a2acc9a7bcdd5bf8304b8cfc4fb301827cdddd52a87daacf0b7dd79b4e965dc4eccab1de83ee581381105c22c274fad69b5e43823d917d55a97195abce21eec5fe87d8d07143cd100094a1a8d45373e5b988ad555b31efb661ec9c140d44c297b207d0d2dc0147f1de611941b1e19413aa93e7db111dd773e26c9c116f446050de650baaef03283ffc641407409ddc44ad918ae40138c3d6871e2d4a31360448e84254144e63f2ea616c0330190a523f869b2c5ab37f95a230b9104246e2f91dbe53f034eefe08470968c4cde23ec5c74696f5ea1cc83b37e0ae1ba78e2293ea0d111114d78be3c5a5460fd9c9b536daa5034a06042d1db360c9253d69a257762a85608b6135ca2bcb2f9e879a6cb8a2b15de03086545e9f54422d366188040e8345026c98ab186b7e1851f4efd4c0a587bd0805326966c96d9532a981c1dd34b62ca4fb9ebbfa20415955c4ed33cd0b0851f8ca9df4b099a75f92ee3bfead563579c725327bf9ce6e9c8ccf91b59a317da52ea9948801494df2c60e05ffd60372903dd7371b89</ns1:publicKey>
                    <ns1:privateKey>1a421c2020f5be41f08092ae923b48f230817b66d53c1c5a4beaf763275e846753d9ac822059893b912c346cb735abf78b646e5edc9c7963125b8f83a6cdef0b3f8a96b2ed94ef34e99fa1ce887a1ee1d60bf894de8c9f95aa77195c1900cc02e6ee1e797761426072c30cfcf5f6289080ef79ed90e746c56e00bf0991e41581c289bc31e8f1382787d9584f35ec90d94bce72b3306e519d7252b32bc90c4782ba918f7ddf676fedf2692bfb5b9aa9dacdc4681a86c6dd42030e48ea24ba4c9c561670e94bf0634262e589d90852930ca70da4e44f9722e158d2835fa1ed77c08119b04687c238e5d57f6aed0757be1ee829b45bb38acde01889aa5636d9a37366d76a35587fede5a4d9a666bd7c9807fe379b9b5e8ef523b8312f67a27cdaddf1649a27bd9afe2f5e60908b87b71416b8e1729ef83d0d9c7d75090b6346cff1b05aad2fbf2cad25041e5ef2110bc3d07b936970542773904b48ab212425dbbbb5d01623cd6c78a728650b876c39c5863114e24a67de13d43e63eb71471623fd3ad458ab24b79cc87365239a2bbda177c9538dd06e9ae7f0edef8af568dd18a988965f96ebd6fc9584d088159139eca2eac2a27c08557560c07ef9f5f110b30795ae203a4d06a35c4805084d4c96efbe51fc35d00ec775c30ff0d2ffe258eade0a55826893fb01983bf687f251d099ed7d6432482b262b399c342e5fd5d3960ce5e036616af4ab0d044ca90bbac0a7bf79170d9a9ad8b30f4cac85d3311f694770dd08636f73519127366f89abbfa31dc04c9e871e0dac11e3e4c474accc8e77db5581b1d48248f8561e48aa29696fd7b303f08f9d5fb335995ffb41db35055e0d80338c669a15ff53188fbef1b52a79b970c0267410b993f99f2e9cffd0fb69607186b3fd450d4519e69cfa194d2582fed8070e2dafb119bac9f4caf7d3ff82f553ed0dbf43fa80a268e97d9142eb0303599b6b4ccccaf1eb23e6e3cdd2ebddd1b0ccc21078058acdfe5b59f88a9e1b3c5273c9053e585c48879c653be70f511e8fb413f84958f0bd21d55d430ef0267df15727719c61e35dfe80b57a15bfaca206399ea080b9f4849613789a925cc6f58940290303db44b69f088ee1779d2b975b8946ca9c48fc23b0f3cf02ceca5820f5deadf7cce586b05db4e9b91983d05d28beceadbccae43456b63ddcec888ccb308e8f850c771c3833b87e8b066d4e80fbe21247527885c9af647db08cde1ecfe95231d3e120f2788e5432ac5befb382188283c7de57dd0144447ad6989690b3711f24ffc04df6da4f8595205ceb83f95c3408f16d2ef5e520a02785a1be03adf181a181607bce42562abcbc4d01f44c3e6937ac032586600933413122ba2b17b78da64dd953a622fd1fa73527f8223ba888b4eb4963e96411daed3c26e9b002e952ebdf4f63d0c4e328dacccaac8fe94af1300604d4330f7774ed0b9d47fc5c18c886bd7c8522969e78e392d18295e338b3c5cafe2ea953188c321e9804ff0346f1931f9f254ce34dd9babd8f933a3ab32e936536eb34c341a091c5df40d635c69b94b683268a27ce000b3e6e1b78d08cb9bb70792c601ebac2e2e61e9552830f69c5bb5b41326c6423b15b8e17829d4b5805c68860b786509feb6c1d2c7d41e5462f3b416fe80aebbf24a26bb6ff27b0f555e2dfe4d21e46ab77748b44ca5bad44ae52510d4048ccce948ea3977cca7ca8120bd6259fe8db42b15b1538b47c51cf6c9349bced597d443f989be3155db5a4a9bc017a145c71b47477df9c726a9a42482b84de76b597427398c54232eb209f67d88daea9b1ba8c8d4708f7e54594137ebfe2ab3dbb124b753ff65def4caefc9922b33f83f9ae7d5e8612d73f0e990632bf41eff277c2043232a8fde9b567fa04b898b34067127acaa9e0ebab05f1ef61f771bda7bdcd95ffa2334c9d2f8345606ce8f1acbd9da948186b895bb5e0b4354d2779c4abc1c49b39e9227a3245ca611e86bd1117b80c254d16f084f14686cca3308178ec0f0201dc421a1a344974b6f50e4e3d953d266c4ec9232293482cd258154b32d159bf6b1a7bfd7b47eb87aa64a284dbac6750a3e6ab18f000e28f3234a421e8d8de484a9f627e8684ef19355eb40698447d9fb3d2da70abc6a54ef4f387fc1f970416e37b91c1c073540d44944f8acf7577e19e572e763a6d66120f32a71618215b048982b0ed6ba0bcf930a6bc56a5c575ecb4900dd04d6372d597c0b74966d91a57378471625eb8b04c33488e8bcb7867cb6c96c5c386099a7ac1a1c72462ce136b6a2a0644ba33df8bdb185590598278cf0535e59d60d9da58073f6593e9a6d946188b4404623e52b960dc99604fb5a035a6086f807a</ns1:privateKey>
                    <ns1:encrypted>true</ns1:encrypted>
                    <ns1:cloud>
                        <ns1:name>MWS2 CDC MS Private Cloud</ns1:name>
                        <ns1:id>3</ns1:id>
                        <ns1:description>MWS2 CDC MS Private Cloud</ns1:description>
                        <ns1:uuid>e4e62da0-f74f-4cb1-b6c3-2655fc2b37d4</ns1:uuid>
                        <ns1:top>false</ns1:top>
                        <ns1:cloudType>
                            <ns1:name>Microsoft Private Cloud</ns1:name>
                            <ns1:href>cloudtype/8</ns1:href>
                            <ns1:id>8</ns1:id>
                            <ns1:rel>up</ns1:rel>
                            <ns1:type>application/com.servicemesh.agility.api.CloudType+xml</ns1:type>
                            <ns1:position>0</ns1:position>
                        </ns1:cloudType>
                    </ns1:cloud>
                </ns1:credential>
                <ns1:resources>
                    <ns1:name>40 GB</ns1:name>
                    <ns1:id>9492</ns1:id>
                    <ns1:uuid>35ae569b-0520-47bd-a2c0-8433072a0ebd</ns1:uuid>
                    <ns1:top>false</ns1:top>
                    <ns1:assetPath></ns1:assetPath>
                    <ns1:detailedAssetPath></ns1:detailedAssetPath>
                    <ns1:applicationType>application/com.servicemesh.agility.api.Resource+xml</ns1:applicationType>
                    <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
                    <ns1:removable>true</ns1:removable>
                    <ns1:resourceType>Disk Drive</ns1:resourceType>
                    <ns1:units>GB</ns1:units>
                    <ns1:quantity>40.0</ns1:quantity>
                </ns1:resources>
                <ns1:resources xsi:type="ns1:NetworkInterface">
                    <ns1:name>Network Adapter</ns1:name>
                    <ns1:id>9493</ns1:id>
                    <ns1:uuid>fec1b340-bc77-4299-9830-797a927453c1</ns1:uuid>
                    <ns1:top>false</ns1:top>
                    <ns1:assetPath></ns1:assetPath>
                    <ns1:detailedAssetPath></ns1:detailedAssetPath>
                    <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
                    <ns1:removable>true</ns1:removable>
                    <ns1:resourceType>Ethernet Adapter</ns1:resourceType>
                    <ns1:quantity>1.0</ns1:quantity>
                    <ns1:hostResource>RSE_Tenant_1103</ns1:hostResource>
                    <ns1:network>
                        <ns1:name>RSE_Tenant_1103</ns1:name>
                        <ns1:href>network/1</ns1:href>
                        <ns1:id>1</ns1:id>
                        <ns1:rel>up</ns1:rel>
                        <ns1:type>application/com.servicemesh.agility.api.Network+xml</ns1:type>
                        <ns1:position>0</ns1:position>
                    </ns1:network>
                </ns1:resources>
                <ns1:resources>
                    <ns1:name>2 VCPU</ns1:name>
                    <ns1:id>5711</ns1:id>
                    <ns1:uuid>85c917a6-703c-40bb-98b2-375c3c15a73d</ns1:uuid>
                    <ns1:top>false</ns1:top>
                    <ns1:assetPath></ns1:assetPath>
                    <ns1:detailedAssetPath></ns1:detailedAssetPath>
                    <ns1:applicationType>application/com.servicemesh.agility.api.Resource+xml</ns1:applicationType>
                    <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
                    <ns1:removable>true</ns1:removable>
                    <ns1:resourceType>Processor</ns1:resourceType>
                    <ns1:units>VCPU</ns1:units>
                    <ns1:quantity>2.0</ns1:quantity>
                </ns1:resources>
                <ns1:resources>
                    <ns1:name>Base Partition</ns1:name>
                    <ns1:id>9495</ns1:id>
                    <ns1:uuid>eefa1f58-a64b-4145-8672-0a818d9013a2</ns1:uuid>
                    <ns1:top>false</ns1:top>
                    <ns1:assetPath></ns1:assetPath>
                    <ns1:detailedAssetPath></ns1:detailedAssetPath>
                    <ns1:applicationType>application/com.servicemesh.agility.api.Resource+xml</ns1:applicationType>
                    <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
                    <ns1:removable>true</ns1:removable>
                    <ns1:resourceType>Disk Drive</ns1:resourceType>
                    <ns1:units>GB</ns1:units>
                    <ns1:quantity>10.0</ns1:quantity>
                </ns1:resources>
                <ns1:resources>
                    <ns1:name>2048 MB</ns1:name>
                    <ns1:id>5712</ns1:id>
                    <ns1:uuid>68637ecd-16e2-4946-8f25-1e8416622f13</ns1:uuid>
                    <ns1:top>false</ns1:top>
                    <ns1:assetPath></ns1:assetPath>
                    <ns1:detailedAssetPath></ns1:detailedAssetPath>
                    <ns1:applicationType>application/com.servicemesh.agility.api.Resource+xml</ns1:applicationType>
                    <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
                    <ns1:removable>true</ns1:removable>
                    <ns1:resourceType>Memory</ns1:resourceType>
                    <ns1:units>MB</ns1:units>
                    <ns1:quantity>2048.0</ns1:quantity>
                </ns1:resources>
                <ns1:onboarded>false</ns1:onboarded>
                <ns1:project>
                    <ns1:name>MWS2_CDCR2</ns1:name>
                    <ns1:href>project/9</ns1:href>
                    <ns1:id>9</ns1:id>
                    <ns1:rel>up</ns1:rel>
                    <ns1:type>application/com.servicemesh.agility.api.Project+xml</ns1:type>
                    <ns1:position>0</ns1:position>
                </ns1:project>
                <ns1:releaseDisks>false</ns1:releaseDisks>
                <ns1:stats>
                    <ns1:templateId>573</ns1:templateId>
                    <ns1:numUnknown>0</ns1:numUnknown>
                    <ns1:numStarting>0</ns1:numStarting>
                    <ns1:numRunning>0</ns1:numRunning>
                    <ns1:numPaused>0</ns1:numPaused>
                    <ns1:numStopping>0</ns1:numStopping>
                    <ns1:numStopped>0</ns1:numStopped>
                    <ns1:numDestroyed>0</ns1:numDestroyed>
                    <ns1:numFailed>0</ns1:numFailed>
                    <ns1:numDegraded>0</ns1:numDegraded>
                    <ns1:numInstances>0</ns1:numInstances>
                    <ns1:minCount>1</ns1:minCount>
                    <ns1:maxCount>1</ns1:maxCount>
                    <ns1:status>Unknown</ns1:status>
                </ns1:stats>
            </ns1:Asset>
            <ns1:assetPath></ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:cloud>
                <ns1:name>MWS2 CDC MS Private Cloud</ns1:name>
                <ns1:href>cloud/3</ns1:href>
                <ns1:id>3</ns1:id>
                <ns1:rel>up</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Cloud+xml</ns1:type>
                <ns1:position>0</ns1:position>
            </ns1:cloud>
            <ns1:stack>
                <ns1:name>CSC SOE 6.1.1 Agility</ns1:name>
                <ns1:href>stack/74</ns1:href>
                <ns1:id>74</ns1:id>
                <ns1:rel>up</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Stack+xml</ns1:type>
                <ns1:position>0</ns1:position>
            </ns1:stack>
            <ns1:template>
                <ns1:name>CSC SOE 6.1.1 Agility-MWS2 CDC MS Private Cloud</ns1:name>
                <ns1:href>template/573</ns1:href>
                <ns1:id>573</ns1:id>
                <ns1:rel>up</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Template+xml</ns1:type>
                <ns1:position>0</ns1:position>
            </ns1:template>
            <ns1:models>
                <ns1:name>2CPU 2GB HA</ns1:name>
                <ns1:href>model/85</ns1:href>
                <ns1:id>85</ns1:id>
                <ns1:rel>up</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Model+xml</ns1:type>
                <ns1:position>0</ns1:position>
            </ns1:models>
            <ns1:models>
                <ns1:name>8CPU 32GB HA</ns1:name>
                <ns1:href>model/86</ns1:href>
                <ns1:id>86</ns1:id>
                <ns1:rel>up</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Model+xml</ns1:type>
                <ns1:position>0</ns1:position>
            </ns1:models>
            <ns1:models>
                <ns1:name>2CPU 4GB HA</ns1:name>
                <ns1:href>model/87</ns1:href>
                <ns1:id>87</ns1:id>
                <ns1:rel>up</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Model+xml</ns1:type>
                <ns1:position>0</ns1:position>
            </ns1:models>
            <ns1:models>
                <ns1:name>4CPU 8GB HA</ns1:name>
                <ns1:href>model/88</ns1:href>
                <ns1:id>88</ns1:id>
                <ns1:rel>up</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Model+xml</ns1:type>
                <ns1:position>0</ns1:position>
            </ns1:models>
            <ns1:models>
                <ns1:name>1CPU 2GB HA</ns1:name>
                <ns1:href>model/89</ns1:href>
                <ns1:id>89</ns1:id>
                <ns1:rel>up</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Model+xml</ns1:type>
                <ns1:position>0</ns1:position>
            </ns1:models>
            <ns1:models>
                <ns1:name>4CPU 4GB HA</ns1:name>
                <ns1:href>model/90</ns1:href>
                <ns1:id>90</ns1:id>
                <ns1:rel>up</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Model+xml</ns1:type>
                <ns1:position>0</ns1:position>
            </ns1:models>
            <ns1:models>
                <ns1:name>8CPU 16GB HA</ns1:name>
                <ns1:href>model/91</ns1:href>
                <ns1:id>91</ns1:id>
                <ns1:rel>up</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Model+xml</ns1:type>
                <ns1:position>0</ns1:position>
            </ns1:models>
            <ns1:models>
                <ns1:name>4CPU 16GB HA</ns1:name>
                <ns1:href>model/92</ns1:href>
                <ns1:id>92</ns1:id>
                <ns1:rel>up</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Model+xml</ns1:type>
                <ns1:position>0</ns1:position>
            </ns1:models>
            <ns1:models>
                <ns1:name>Minimal Hardware Profile</ns1:name>
                <ns1:href>model/73</ns1:href>
                <ns1:id>73</ns1:id>
                <ns1:rel>up</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Model+xml</ns1:type>
                <ns1:position>0</ns1:position>
            </ns1:models>
            <ns1:maxInstances>1</ns1:maxInstances>
        </ns1:Asset>
        <ns1:assetPath>/Root/MWS2/MWS2_CDCR2</ns1:assetPath>
        <ns1:detailedAssetPath>/Root:#ID#1:#TYPE#VMContainer/MWS2:#ID#8:#TYPE#VMContainer/MWS2_CDCR2:#ID#9:#TYPE#VMProject</ns1:detailedAssetPath>
        <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
        <ns1:removable>true</ns1:removable>
        <ns1:domain>
            <ns1:name>domain1</ns1:name>
            <ns1:href>domain/1</ns1:href>
            <ns1:id>1</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Domain+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:domain>
        <ns1:creator>
            <ns1:name>mfreeman</ns1:name>
            <ns1:href>user/12</ns1:href>
            <ns1:id>12</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.User+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:creator>
        <ns1:created>2015-04-13T22:18:06-05:00</ns1:created>
        <ns1:lockType>0</ns1:lockType>
        <ns1:lastModified>2015-04-13T22:19:41-05:00</ns1:lastModified>
        <ns1:policyAssignment>
            <ns1:name>Instance Provision</ns1:name>
            <ns1:id>1</ns1:id>
            <ns1:uuid>756c1984-8259-11e4-96fc-005056952d4b</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath>/Root</ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:applyToSelf>false</ns1:applyToSelf>
            <ns1:applyChildrenDepth>0</ns1:applyChildrenDepth>
            <ns1:allowChildrenOverride>false</ns1:allowChildrenOverride>
            <ns1:policy xsi:type="ns1:VersionedItemLink">
                <ns1:name>Instance Provision</ns1:name>
                <ns1:href>policy/44</ns1:href>
                <ns1:id>44</ns1:id>
                <ns1:rel>down</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Policy+xml</ns1:type>
                <ns1:position>0</ns1:position>
                <ns1:slot>#INSTANCE-PROVISION#</ns1:slot>
                <ns1:version>1</ns1:version>
                <ns1:latest>true</ns1:latest>
                <ns1:slotId>92</ns1:slotId>
                <ns1:versionStatus>active</ns1:versionStatus>
                <ns1:lockType>0</ns1:lockType>
            </ns1:policy>
            <ns1:policyTypeName>Workflow</ns1:policyTypeName>
            <ns1:itemClass>VMContainer</ns1:itemClass>
            <ns1:itemId>1</ns1:itemId>
            <ns1:itemName>Root</ns1:itemName>
        </ns1:policyAssignment>
        <ns1:policyAssignment>
            <ns1:name>Instance Start</ns1:name>
            <ns1:id>2</ns1:id>
            <ns1:uuid>756c76c2-8259-11e4-96fc-005056952d4b</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath>/Root</ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:applyToSelf>false</ns1:applyToSelf>
            <ns1:applyChildrenDepth>0</ns1:applyChildrenDepth>
            <ns1:allowChildrenOverride>false</ns1:allowChildrenOverride>
            <ns1:policy xsi:type="ns1:VersionedItemLink">
                <ns1:name>Instance Start</ns1:name>
                <ns1:href>policy/45</ns1:href>
                <ns1:id>45</ns1:id>
                <ns1:rel>down</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Policy+xml</ns1:type>
                <ns1:position>0</ns1:position>
                <ns1:slot>#INSTANCE-START#</ns1:slot>
                <ns1:version>1</ns1:version>
                <ns1:latest>true</ns1:latest>
                <ns1:slotId>93</ns1:slotId>
                <ns1:versionStatus>active</ns1:versionStatus>
                <ns1:lockType>0</ns1:lockType>
            </ns1:policy>
            <ns1:policyTypeName>Workflow</ns1:policyTypeName>
            <ns1:itemClass>VMContainer</ns1:itemClass>
            <ns1:itemId>1</ns1:itemId>
            <ns1:itemName>Root</ns1:itemName>
        </ns1:policyAssignment>
        <ns1:policyAssignment>
            <ns1:name>Instance Stop</ns1:name>
            <ns1:id>3</ns1:id>
            <ns1:uuid>756ccc30-8259-11e4-96fc-005056952d4b</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath>/Root</ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:applyToSelf>false</ns1:applyToSelf>
            <ns1:applyChildrenDepth>0</ns1:applyChildrenDepth>
            <ns1:allowChildrenOverride>false</ns1:allowChildrenOverride>
            <ns1:policy xsi:type="ns1:VersionedItemLink">
                <ns1:name>Instance Stop</ns1:name>
                <ns1:href>policy/46</ns1:href>
                <ns1:id>46</ns1:id>
                <ns1:rel>down</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Policy+xml</ns1:type>
                <ns1:position>0</ns1:position>
                <ns1:slot>#INSTANCE-STOP#</ns1:slot>
                <ns1:version>1</ns1:version>
                <ns1:latest>true</ns1:latest>
                <ns1:slotId>94</ns1:slotId>
                <ns1:versionStatus>active</ns1:versionStatus>
                <ns1:lockType>0</ns1:lockType>
            </ns1:policy>
            <ns1:policyTypeName>Workflow</ns1:policyTypeName>
            <ns1:itemClass>VMContainer</ns1:itemClass>
            <ns1:itemId>1</ns1:itemId>
            <ns1:itemName>Root</ns1:itemName>
        </ns1:policyAssignment>
        <ns1:policyAssignment>
            <ns1:name>Topology Start</ns1:name>
            <ns1:id>4</ns1:id>
            <ns1:uuid>756d25a4-8259-11e4-96fc-005056952d4b</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath>/Root</ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:applyToSelf>false</ns1:applyToSelf>
            <ns1:applyChildrenDepth>0</ns1:applyChildrenDepth>
            <ns1:allowChildrenOverride>false</ns1:allowChildrenOverride>
            <ns1:policy xsi:type="ns1:VersionedItemLink">
                <ns1:name>Topology Start</ns1:name>
                <ns1:href>policy/47</ns1:href>
                <ns1:id>47</ns1:id>
                <ns1:rel>down</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Policy+xml</ns1:type>
                <ns1:position>0</ns1:position>
                <ns1:slot>#TOPOLOGY-START#</ns1:slot>
                <ns1:version>1</ns1:version>
                <ns1:latest>true</ns1:latest>
                <ns1:slotId>95</ns1:slotId>
                <ns1:versionStatus>active</ns1:versionStatus>
                <ns1:lockType>0</ns1:lockType>
            </ns1:policy>
            <ns1:policyTypeName>Workflow</ns1:policyTypeName>
            <ns1:itemClass>VMContainer</ns1:itemClass>
            <ns1:itemId>1</ns1:itemId>
            <ns1:itemName>Root</ns1:itemName>
        </ns1:policyAssignment>
        <ns1:policyAssignment>
            <ns1:name>Blueprint Checkin</ns1:name>
            <ns1:id>5</ns1:id>
            <ns1:uuid>756d847c-8259-11e4-96fc-005056952d4b</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath>/Root</ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:applyToSelf>false</ns1:applyToSelf>
            <ns1:applyChildrenDepth>0</ns1:applyChildrenDepth>
            <ns1:allowChildrenOverride>false</ns1:allowChildrenOverride>
            <ns1:policy xsi:type="ns1:VersionedItemLink">
                <ns1:name>Blueprint Checkin</ns1:name>
                <ns1:href>policy/48</ns1:href>
                <ns1:id>48</ns1:id>
                <ns1:rel>down</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Policy+xml</ns1:type>
                <ns1:position>0</ns1:position>
                <ns1:slot>#BLUEPRINT-PUBLISH#</ns1:slot>
                <ns1:version>1</ns1:version>
                <ns1:latest>true</ns1:latest>
                <ns1:slotId>96</ns1:slotId>
                <ns1:versionStatus>active</ns1:versionStatus>
                <ns1:lockType>0</ns1:lockType>
            </ns1:policy>
            <ns1:policyTypeName>Workflow</ns1:policyTypeName>
            <ns1:itemClass>VMContainer</ns1:itemClass>
            <ns1:itemId>1</ns1:itemId>
            <ns1:itemName>Root</ns1:itemName>
        </ns1:policyAssignment>
        <ns1:policyAssignment>
            <ns1:name>Package Checkin</ns1:name>
            <ns1:id>6</ns1:id>
            <ns1:uuid>756dd97c-8259-11e4-96fc-005056952d4b</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath>/Root</ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:applyToSelf>false</ns1:applyToSelf>
            <ns1:applyChildrenDepth>0</ns1:applyChildrenDepth>
            <ns1:allowChildrenOverride>false</ns1:allowChildrenOverride>
            <ns1:policy xsi:type="ns1:VersionedItemLink">
                <ns1:name>Package Checkin</ns1:name>
                <ns1:href>policy/49</ns1:href>
                <ns1:id>49</ns1:id>
                <ns1:rel>down</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Policy+xml</ns1:type>
                <ns1:position>0</ns1:position>
                <ns1:slot>#PACKAGE-PUBLISH#</ns1:slot>
                <ns1:version>1</ns1:version>
                <ns1:latest>true</ns1:latest>
                <ns1:slotId>97</ns1:slotId>
                <ns1:versionStatus>active</ns1:versionStatus>
                <ns1:lockType>0</ns1:lockType>
            </ns1:policy>
            <ns1:policyTypeName>Workflow</ns1:policyTypeName>
            <ns1:itemClass>VMContainer</ns1:itemClass>
            <ns1:itemId>1</ns1:itemId>
            <ns1:itemName>Root</ns1:itemName>
        </ns1:policyAssignment>
        <ns1:policyAssignment>
            <ns1:name>Script Checkin</ns1:name>
            <ns1:id>7</ns1:id>
            <ns1:uuid>756e2e22-8259-11e4-96fc-005056952d4b</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath>/Root</ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:applyToSelf>false</ns1:applyToSelf>
            <ns1:applyChildrenDepth>0</ns1:applyChildrenDepth>
            <ns1:allowChildrenOverride>false</ns1:allowChildrenOverride>
            <ns1:policy xsi:type="ns1:VersionedItemLink">
                <ns1:name>Script Checkin</ns1:name>
                <ns1:href>policy/50</ns1:href>
                <ns1:id>50</ns1:id>
                <ns1:rel>down</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Policy+xml</ns1:type>
                <ns1:position>0</ns1:position>
                <ns1:slot>#SCRIPT-PUBLISH#</ns1:slot>
                <ns1:version>1</ns1:version>
                <ns1:latest>true</ns1:latest>
                <ns1:slotId>98</ns1:slotId>
                <ns1:versionStatus>active</ns1:versionStatus>
                <ns1:lockType>0</ns1:lockType>
            </ns1:policy>
            <ns1:policyTypeName>Workflow</ns1:policyTypeName>
            <ns1:itemClass>VMContainer</ns1:itemClass>
            <ns1:itemId>1</ns1:itemId>
            <ns1:itemName>Root</ns1:itemName>
        </ns1:policyAssignment>
        <ns1:policyAssignment>
            <ns1:name>Stack Checkin</ns1:name>
            <ns1:id>8</ns1:id>
            <ns1:uuid>756e85a2-8259-11e4-96fc-005056952d4b</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath>/Root</ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:applyToSelf>false</ns1:applyToSelf>
            <ns1:applyChildrenDepth>0</ns1:applyChildrenDepth>
            <ns1:allowChildrenOverride>false</ns1:allowChildrenOverride>
            <ns1:policy xsi:type="ns1:VersionedItemLink">
                <ns1:name>Stack Checkin</ns1:name>
                <ns1:href>policy/51</ns1:href>
                <ns1:id>51</ns1:id>
                <ns1:rel>down</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Policy+xml</ns1:type>
                <ns1:position>0</ns1:position>
                <ns1:slot>#STACK-PUBLISH#</ns1:slot>
                <ns1:version>1</ns1:version>
                <ns1:latest>true</ns1:latest>
                <ns1:slotId>99</ns1:slotId>
                <ns1:versionStatus>active</ns1:versionStatus>
                <ns1:lockType>0</ns1:lockType>
            </ns1:policy>
            <ns1:policyTypeName>Workflow</ns1:policyTypeName>
            <ns1:itemClass>VMContainer</ns1:itemClass>
            <ns1:itemId>1</ns1:itemId>
            <ns1:itemName>Root</ns1:itemName>
        </ns1:policyAssignment>
        <ns1:policyAssignment>
            <ns1:name>Product Order</ns1:name>
            <ns1:id>9</ns1:id>
            <ns1:uuid>756ee5b0-8259-11e4-96fc-005056952d4b</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath>/Root</ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:applyToSelf>false</ns1:applyToSelf>
            <ns1:applyChildrenDepth>0</ns1:applyChildrenDepth>
            <ns1:allowChildrenOverride>false</ns1:allowChildrenOverride>
            <ns1:policy xsi:type="ns1:VersionedItemLink">
                <ns1:name>Product Order</ns1:name>
                <ns1:href>policy/54</ns1:href>
                <ns1:id>54</ns1:id>
                <ns1:rel>down</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Policy+xml</ns1:type>
                <ns1:position>0</ns1:position>
                <ns1:slot>#PRODUCT-ORDER#</ns1:slot>
                <ns1:version>1</ns1:version>
                <ns1:latest>true</ns1:latest>
                <ns1:slotId>102</ns1:slotId>
                <ns1:versionStatus>active</ns1:versionStatus>
                <ns1:lockType>0</ns1:lockType>
            </ns1:policy>
            <ns1:policyTypeName>Workflow</ns1:policyTypeName>
            <ns1:itemClass>VMContainer</ns1:itemClass>
            <ns1:itemId>1</ns1:itemId>
            <ns1:itemName>Root</ns1:itemName>
        </ns1:policyAssignment>
        <ns1:policyAssignment>
            <ns1:name>Product Deploy</ns1:name>
            <ns1:id>10</ns1:id>
            <ns1:uuid>756f4a3c-8259-11e4-96fc-005056952d4b</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath>/Root</ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:applyToSelf>false</ns1:applyToSelf>
            <ns1:applyChildrenDepth>0</ns1:applyChildrenDepth>
            <ns1:allowChildrenOverride>false</ns1:allowChildrenOverride>
            <ns1:policy xsi:type="ns1:VersionedItemLink">
                <ns1:name>Product Deploy</ns1:name>
                <ns1:href>policy/55</ns1:href>
                <ns1:id>55</ns1:id>
                <ns1:rel>down</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Policy+xml</ns1:type>
                <ns1:position>0</ns1:position>
                <ns1:slot>#PRODUCT-DEPLOY#</ns1:slot>
                <ns1:version>1</ns1:version>
                <ns1:latest>true</ns1:latest>
                <ns1:slotId>103</ns1:slotId>
                <ns1:versionStatus>active</ns1:versionStatus>
                <ns1:lockType>0</ns1:lockType>
            </ns1:policy>
            <ns1:policyTypeName>Workflow</ns1:policyTypeName>
            <ns1:itemClass>VMContainer</ns1:itemClass>
            <ns1:itemId>1</ns1:itemId>
            <ns1:itemName>Root</ns1:itemName>
        </ns1:policyAssignment>
        <ns1:policyAssignment>
            <ns1:name>Solution Deploy</ns1:name>
            <ns1:id>11</ns1:id>
            <ns1:uuid>756fac3e-8259-11e4-96fc-005056952d4b</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath>/Root</ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:applyToSelf>false</ns1:applyToSelf>
            <ns1:applyChildrenDepth>0</ns1:applyChildrenDepth>
            <ns1:allowChildrenOverride>false</ns1:allowChildrenOverride>
            <ns1:policy xsi:type="ns1:VersionedItemLink">
                <ns1:name>Solution Deploy</ns1:name>
                <ns1:href>policy/56</ns1:href>
                <ns1:id>56</ns1:id>
                <ns1:rel>down</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Policy+xml</ns1:type>
                <ns1:position>0</ns1:position>
                <ns1:slot>#DEPLOYMENT-SUBMIT#</ns1:slot>
                <ns1:version>1</ns1:version>
                <ns1:latest>true</ns1:latest>
                <ns1:slotId>104</ns1:slotId>
                <ns1:versionStatus>active</ns1:versionStatus>
                <ns1:lockType>0</ns1:lockType>
            </ns1:policy>
            <ns1:policyTypeName>Workflow</ns1:policyTypeName>
            <ns1:itemClass>VMContainer</ns1:itemClass>
            <ns1:itemId>1</ns1:itemId>
            <ns1:itemName>Root</ns1:itemName>
        </ns1:policyAssignment>
        <ns1:policyAssignment>
            <ns1:name>Configuration Artifact Change</ns1:name>
            <ns1:id>12</ns1:id>
            <ns1:uuid>756fff2c-8259-11e4-96fc-005056952d4b</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath>/Root</ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:applyToSelf>false</ns1:applyToSelf>
            <ns1:applyChildrenDepth>0</ns1:applyChildrenDepth>
            <ns1:allowChildrenOverride>false</ns1:allowChildrenOverride>
            <ns1:policy xsi:type="ns1:VersionedItemLink">
                <ns1:name>Configuration Artifact Change</ns1:name>
                <ns1:href>policy/57</ns1:href>
                <ns1:id>57</ns1:id>
                <ns1:rel>down</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Policy+xml</ns1:type>
                <ns1:position>0</ns1:position>
                <ns1:slot>#ARTIFACT-SYNC#</ns1:slot>
                <ns1:version>1</ns1:version>
                <ns1:latest>true</ns1:latest>
                <ns1:slotId>105</ns1:slotId>
                <ns1:versionStatus>active</ns1:versionStatus>
                <ns1:lockType>0</ns1:lockType>
            </ns1:policy>
            <ns1:policyTypeName>Workflow</ns1:policyTypeName>
            <ns1:itemClass>VMContainer</ns1:itemClass>
            <ns1:itemId>1</ns1:itemId>
            <ns1:itemName>Root</ns1:itemName>
        </ns1:policyAssignment>
        <ns1:policyAssignment>
            <ns1:name>Instance Release</ns1:name>
            <ns1:id>13</ns1:id>
            <ns1:uuid>75706200-8259-11e4-96fc-005056952d4b</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath>/Root</ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:applyToSelf>false</ns1:applyToSelf>
            <ns1:applyChildrenDepth>0</ns1:applyChildrenDepth>
            <ns1:allowChildrenOverride>false</ns1:allowChildrenOverride>
            <ns1:policy xsi:type="ns1:VersionedItemLink">
                <ns1:name>Instance Release</ns1:name>
                <ns1:href>policy/58</ns1:href>
                <ns1:id>58</ns1:id>
                <ns1:rel>down</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Policy+xml</ns1:type>
                <ns1:position>0</ns1:position>
                <ns1:slot>#INSTANCE-RELEASE#</ns1:slot>
                <ns1:version>1</ns1:version>
                <ns1:latest>true</ns1:latest>
                <ns1:slotId>106</ns1:slotId>
                <ns1:versionStatus>active</ns1:versionStatus>
                <ns1:lockType>0</ns1:lockType>
            </ns1:policy>
            <ns1:policyTypeName>Workflow</ns1:policyTypeName>
            <ns1:itemClass>VMContainer</ns1:itemClass>
            <ns1:itemId>1</ns1:itemId>
            <ns1:itemName>Root</ns1:itemName>
        </ns1:policyAssignment>
        <ns1:policyAssignment>
            <ns1:name>Instance Restart</ns1:name>
            <ns1:id>14</ns1:id>
            <ns1:uuid>7570b912-8259-11e4-96fc-005056952d4b</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath>/Root</ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:applyToSelf>false</ns1:applyToSelf>
            <ns1:applyChildrenDepth>0</ns1:applyChildrenDepth>
            <ns1:allowChildrenOverride>false</ns1:allowChildrenOverride>
            <ns1:policy xsi:type="ns1:VersionedItemLink">
                <ns1:name>Instance Restart</ns1:name>
                <ns1:href>policy/59</ns1:href>
                <ns1:id>59</ns1:id>
                <ns1:rel>down</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Policy+xml</ns1:type>
                <ns1:position>0</ns1:position>
                <ns1:slot>#INSTANCE-RESTART#</ns1:slot>
                <ns1:version>1</ns1:version>
                <ns1:latest>true</ns1:latest>
                <ns1:slotId>107</ns1:slotId>
                <ns1:versionStatus>active</ns1:versionStatus>
                <ns1:lockType>0</ns1:lockType>
            </ns1:policy>
            <ns1:policyTypeName>Workflow</ns1:policyTypeName>
            <ns1:itemClass>VMContainer</ns1:itemClass>
            <ns1:itemId>1</ns1:itemId>
            <ns1:itemName>Root</ns1:itemName>
        </ns1:policyAssignment>
        <ns1:policyAssignment>
            <ns1:name>Template Start</ns1:name>
            <ns1:id>15</ns1:id>
            <ns1:uuid>75710caa-8259-11e4-96fc-005056952d4b</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath>/Root</ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:applyToSelf>false</ns1:applyToSelf>
            <ns1:applyChildrenDepth>0</ns1:applyChildrenDepth>
            <ns1:allowChildrenOverride>false</ns1:allowChildrenOverride>
            <ns1:policy xsi:type="ns1:VersionedItemLink">
                <ns1:name>Template Start</ns1:name>
                <ns1:href>policy/60</ns1:href>
                <ns1:id>60</ns1:id>
                <ns1:rel>down</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Policy+xml</ns1:type>
                <ns1:position>0</ns1:position>
                <ns1:slot>#TEMPLATE-START#</ns1:slot>
                <ns1:version>1</ns1:version>
                <ns1:latest>true</ns1:latest>
                <ns1:slotId>108</ns1:slotId>
                <ns1:versionStatus>active</ns1:versionStatus>
                <ns1:lockType>0</ns1:lockType>
            </ns1:policy>
            <ns1:policyTypeName>Workflow</ns1:policyTypeName>
            <ns1:itemClass>VMContainer</ns1:itemClass>
            <ns1:itemId>1</ns1:itemId>
            <ns1:itemName>Root</ns1:itemName>
        </ns1:policyAssignment>
        <ns1:policyAssignment>
            <ns1:name>Template Restart</ns1:name>
            <ns1:id>16</ns1:id>
            <ns1:uuid>75715fde-8259-11e4-96fc-005056952d4b</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath>/Root</ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:applyToSelf>false</ns1:applyToSelf>
            <ns1:applyChildrenDepth>0</ns1:applyChildrenDepth>
            <ns1:allowChildrenOverride>false</ns1:allowChildrenOverride>
            <ns1:policy xsi:type="ns1:VersionedItemLink">
                <ns1:name>Template Restart</ns1:name>
                <ns1:href>policy/61</ns1:href>
                <ns1:id>61</ns1:id>
                <ns1:rel>down</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Policy+xml</ns1:type>
                <ns1:position>0</ns1:position>
                <ns1:slot>#TEMPLATE-RESTART#</ns1:slot>
                <ns1:version>1</ns1:version>
                <ns1:latest>true</ns1:latest>
                <ns1:slotId>109</ns1:slotId>
                <ns1:versionStatus>active</ns1:versionStatus>
                <ns1:lockType>0</ns1:lockType>
            </ns1:policy>
            <ns1:policyTypeName>Workflow</ns1:policyTypeName>
            <ns1:itemClass>VMContainer</ns1:itemClass>
            <ns1:itemId>1</ns1:itemId>
            <ns1:itemName>Root</ns1:itemName>
        </ns1:policyAssignment>
        <ns1:policyAssignment>
            <ns1:name>Template Stop</ns1:name>
            <ns1:id>17</ns1:id>
            <ns1:uuid>7571b5d8-8259-11e4-96fc-005056952d4b</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath>/Root</ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:applyToSelf>false</ns1:applyToSelf>
            <ns1:applyChildrenDepth>0</ns1:applyChildrenDepth>
            <ns1:allowChildrenOverride>false</ns1:allowChildrenOverride>
            <ns1:policy xsi:type="ns1:VersionedItemLink">
                <ns1:name>Template Stop</ns1:name>
                <ns1:href>policy/62</ns1:href>
                <ns1:id>62</ns1:id>
                <ns1:rel>down</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Policy+xml</ns1:type>
                <ns1:position>0</ns1:position>
                <ns1:slot>#TEMPLATE-STOP#</ns1:slot>
                <ns1:version>1</ns1:version>
                <ns1:latest>true</ns1:latest>
                <ns1:slotId>110</ns1:slotId>
                <ns1:versionStatus>active</ns1:versionStatus>
                <ns1:lockType>0</ns1:lockType>
            </ns1:policy>
            <ns1:policyTypeName>Workflow</ns1:policyTypeName>
            <ns1:itemClass>VMContainer</ns1:itemClass>
            <ns1:itemId>1</ns1:itemId>
            <ns1:itemName>Root</ns1:itemName>
        </ns1:policyAssignment>
        <ns1:policyAssignment>
            <ns1:name>Template Release</ns1:name>
            <ns1:id>18</ns1:id>
            <ns1:uuid>75720ca4-8259-11e4-96fc-005056952d4b</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath>/Root</ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:applyToSelf>false</ns1:applyToSelf>
            <ns1:applyChildrenDepth>0</ns1:applyChildrenDepth>
            <ns1:allowChildrenOverride>false</ns1:allowChildrenOverride>
            <ns1:policy xsi:type="ns1:VersionedItemLink">
                <ns1:name>Template Release</ns1:name>
                <ns1:href>policy/63</ns1:href>
                <ns1:id>63</ns1:id>
                <ns1:rel>down</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Policy+xml</ns1:type>
                <ns1:position>0</ns1:position>
                <ns1:slot>#TEMPLATE-RELEASE#</ns1:slot>
                <ns1:version>1</ns1:version>
                <ns1:latest>true</ns1:latest>
                <ns1:slotId>111</ns1:slotId>
                <ns1:versionStatus>active</ns1:versionStatus>
                <ns1:lockType>0</ns1:lockType>
            </ns1:policy>
            <ns1:policyTypeName>Workflow</ns1:policyTypeName>
            <ns1:itemClass>VMContainer</ns1:itemClass>
            <ns1:itemId>1</ns1:itemId>
            <ns1:itemName>Root</ns1:itemName>
        </ns1:policyAssignment>
        <ns1:policyAssignment>
            <ns1:name>Topology Stop</ns1:name>
            <ns1:id>19</ns1:id>
            <ns1:uuid>75725e3e-8259-11e4-96fc-005056952d4b</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath>/Root</ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:applyToSelf>false</ns1:applyToSelf>
            <ns1:applyChildrenDepth>0</ns1:applyChildrenDepth>
            <ns1:allowChildrenOverride>false</ns1:allowChildrenOverride>
            <ns1:policy xsi:type="ns1:VersionedItemLink">
                <ns1:name>Topology Stop</ns1:name>
                <ns1:href>policy/64</ns1:href>
                <ns1:id>64</ns1:id>
                <ns1:rel>down</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Policy+xml</ns1:type>
                <ns1:position>0</ns1:position>
                <ns1:slot>#TOPOLOGY-STOP#</ns1:slot>
                <ns1:version>1</ns1:version>
                <ns1:latest>true</ns1:latest>
                <ns1:slotId>112</ns1:slotId>
                <ns1:versionStatus>active</ns1:versionStatus>
                <ns1:lockType>0</ns1:lockType>
            </ns1:policy>
            <ns1:policyTypeName>Workflow</ns1:policyTypeName>
            <ns1:itemClass>VMContainer</ns1:itemClass>
            <ns1:itemId>1</ns1:itemId>
            <ns1:itemName>Root</ns1:itemName>
        </ns1:policyAssignment>
        <ns1:policyAssignment>
            <ns1:name>Topology Restart</ns1:name>
            <ns1:id>20</ns1:id>
            <ns1:uuid>7572b87a-8259-11e4-96fc-005056952d4b</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath>/Root</ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:applyToSelf>false</ns1:applyToSelf>
            <ns1:applyChildrenDepth>0</ns1:applyChildrenDepth>
            <ns1:allowChildrenOverride>false</ns1:allowChildrenOverride>
            <ns1:policy xsi:type="ns1:VersionedItemLink">
                <ns1:name>Topology Restart</ns1:name>
                <ns1:href>policy/65</ns1:href>
                <ns1:id>65</ns1:id>
                <ns1:rel>down</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Policy+xml</ns1:type>
                <ns1:position>0</ns1:position>
                <ns1:slot>#TOPOLOGY-RESTART#</ns1:slot>
                <ns1:version>1</ns1:version>
                <ns1:latest>true</ns1:latest>
                <ns1:slotId>113</ns1:slotId>
                <ns1:versionStatus>active</ns1:versionStatus>
                <ns1:lockType>0</ns1:lockType>
            </ns1:policy>
            <ns1:policyTypeName>Workflow</ns1:policyTypeName>
            <ns1:itemClass>VMContainer</ns1:itemClass>
            <ns1:itemId>1</ns1:itemId>
            <ns1:itemName>Root</ns1:itemName>
        </ns1:policyAssignment>
        <ns1:policyAssignment>
            <ns1:name>Topology Release</ns1:name>
            <ns1:id>21</ns1:id>
            <ns1:uuid>75730bcc-8259-11e4-96fc-005056952d4b</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath>/Root</ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:applyToSelf>false</ns1:applyToSelf>
            <ns1:applyChildrenDepth>0</ns1:applyChildrenDepth>
            <ns1:allowChildrenOverride>false</ns1:allowChildrenOverride>
            <ns1:policy xsi:type="ns1:VersionedItemLink">
                <ns1:name>Topology Release</ns1:name>
                <ns1:href>policy/66</ns1:href>
                <ns1:id>66</ns1:id>
                <ns1:rel>down</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Policy+xml</ns1:type>
                <ns1:position>0</ns1:position>
                <ns1:slot>#TOPOLOGY-RELEASE#</ns1:slot>
                <ns1:version>1</ns1:version>
                <ns1:latest>true</ns1:latest>
                <ns1:slotId>114</ns1:slotId>
                <ns1:versionStatus>active</ns1:versionStatus>
                <ns1:lockType>0</ns1:lockType>
            </ns1:policy>
            <ns1:policyTypeName>Workflow</ns1:policyTypeName>
            <ns1:itemClass>VMContainer</ns1:itemClass>
            <ns1:itemId>1</ns1:itemId>
            <ns1:itemName>Root</ns1:itemName>
        </ns1:policyAssignment>
        <ns1:policyAssignment>
            <ns1:name>Topology Checkin</ns1:name>
            <ns1:id>22</ns1:id>
            <ns1:uuid>75735d16-8259-11e4-96fc-005056952d4b</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath>/Root</ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:applyToSelf>false</ns1:applyToSelf>
            <ns1:applyChildrenDepth>0</ns1:applyChildrenDepth>
            <ns1:allowChildrenOverride>false</ns1:allowChildrenOverride>
            <ns1:policy xsi:type="ns1:VersionedItemLink">
                <ns1:name>Topology Checkin</ns1:name>
                <ns1:href>policy/52</ns1:href>
                <ns1:id>52</ns1:id>
                <ns1:rel>down</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Policy+xml</ns1:type>
                <ns1:position>0</ns1:position>
                <ns1:slot>#TOPOLOGY-PUBLISH#</ns1:slot>
                <ns1:version>1</ns1:version>
                <ns1:latest>true</ns1:latest>
                <ns1:slotId>100</ns1:slotId>
                <ns1:versionStatus>active</ns1:versionStatus>
                <ns1:lockType>0</ns1:lockType>
            </ns1:policy>
            <ns1:policyTypeName>Workflow</ns1:policyTypeName>
            <ns1:itemClass>VMContainer</ns1:itemClass>
            <ns1:itemId>1</ns1:itemId>
            <ns1:itemName>Root</ns1:itemName>
        </ns1:policyAssignment>
        <ns1:policyAssignment>
            <ns1:name>Template Delete</ns1:name>
            <ns1:id>23</ns1:id>
            <ns1:uuid>7573af96-8259-11e4-96fc-005056952d4b</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath>/Root</ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:applyToSelf>false</ns1:applyToSelf>
            <ns1:applyChildrenDepth>0</ns1:applyChildrenDepth>
            <ns1:allowChildrenOverride>false</ns1:allowChildrenOverride>
            <ns1:policy xsi:type="ns1:VersionedItemLink">
                <ns1:name>Template Delete</ns1:name>
                <ns1:href>policy/67</ns1:href>
                <ns1:id>67</ns1:id>
                <ns1:rel>down</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Policy+xml</ns1:type>
                <ns1:position>0</ns1:position>
                <ns1:slot>#TEMPLATE-DELETE#</ns1:slot>
                <ns1:version>1</ns1:version>
                <ns1:latest>true</ns1:latest>
                <ns1:slotId>115</ns1:slotId>
                <ns1:versionStatus>active</ns1:versionStatus>
                <ns1:lockType>0</ns1:lockType>
            </ns1:policy>
            <ns1:policyTypeName>Workflow</ns1:policyTypeName>
            <ns1:itemClass>VMContainer</ns1:itemClass>
            <ns1:itemId>1</ns1:itemId>
            <ns1:itemName>Root</ns1:itemName>
        </ns1:policyAssignment>
        <ns1:parent>
            <ns1:name>MWS2_CDCR2</ns1:name>
            <ns1:href>project/9</ns1:href>
            <ns1:id>9</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Project+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:parent>
        <ns1:slot>3414f543-8310-47f1-ae2f-bc0ee84645ee</ns1:slot>
        <ns1:version>5</ns1:version>
        <ns1:latest>false</ns1:latest>
        <ns1:publishComment></ns1:publishComment>
        <ns1:slotId>151</ns1:slotId>
        <ns1:publisher>
            <ns1:name>mfreeman</ns1:name>
            <ns1:href>user/12</ns1:href>
            <ns1:id>12</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.User+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:publisher>
        <ns1:versionStatus>active</ns1:versionStatus>
        <ns1:checkoutAllowed>false</ns1:checkoutAllowed>
        <ns1:headAllowed>false</ns1:headAllowed>
        <ns1:operatingSystem>Windows|2012R2</ns1:operatingSystem>
        <ns1:targets>
            <ns1:name>CSC SOE 6.1.1 Agility-MWS2 CDC MS Private Cloud</ns1:name>
            <ns1:href>targetcloud/21</ns1:href>
            <ns1:id>21</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.TargetCloud+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:targets>
        <ns1:status>Built</ns1:status>
        <ns1:images>
            <ns1:name>CSCSOE611Agility v1.2</ns1:name>
            <ns1:href>image/144</ns1:href>
            <ns1:id>144</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Image+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:images>
        <ns1:template>
            <ns1:name>CSC SOE 6.1.1 Agility</ns1:name>
            <ns1:href>template/572</ns1:href>
            <ns1:id>572</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Template+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:template>
    </ns1:pendingAsset>
    <ns1:Asset xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="ns1:CloudType">
        <ns1:name>Microsoft Private Cloud</ns1:name>
        <ns1:id>8</ns1:id>
        <ns1:description>AzurePack/SPF Beta</ns1:description>
        <ns1:uuid>6ad8624a-90e7-445c-b62d-8a6933631fab</ns1:uuid>
        <ns1:importMode>Lookup</ns1:importMode>
        <ns1:importDirectives>
            <ns1:onNotFound>Continue</ns1:onNotFound>
        </ns1:importDirectives>
        <ns1:top>false</ns1:top>
    </ns1:Asset>
    <ns1:Asset xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="ns1:Cloud">
        <ns1:name>MWS2 CDC MS Private Cloud</ns1:name>
        <ns1:id>3</ns1:id>
        <ns1:description>MWS2 CDC MS Private Cloud</ns1:description>
        <ns1:uuid>e4e62da0-f74f-4cb1-b6c3-2655fc2b37d4</ns1:uuid>
        <ns1:importMode>Lookup</ns1:importMode>
        <ns1:importDirectives>
            <ns1:onNotFound>Continue</ns1:onNotFound>
        </ns1:importDirectives>
        <ns1:top>false</ns1:top>
        <ns1:cloudType>
            <ns1:name>Microsoft Private Cloud</ns1:name>
            <ns1:href>cloudtype/8</ns1:href>
            <ns1:id>8</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.CloudType+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:cloudType>
    </ns1:Asset>
    <ns1:Asset xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="ns1:Blueprint">
        <ns1:name>MWS2R2 - ConfigMgr2012_Primary (Class A)</ns1:name>
        <ns1:id>275</ns1:id>
        <ns1:description></ns1:description>
        <ns1:uuid>ca7f2d40-f3a9-431c-8a38-2a21a34e332f</ns1:uuid>
        <ns1:assetType>
            <ns1:name>blueprint</ns1:name>
            <ns1:href>assettype/6</ns1:href>
            <ns1:id>6</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.AssetType+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:assetType>
        <ns1:top>true</ns1:top>
        <ns1:assetPath>/Root/MWS2/MWS2_CDCR2</ns1:assetPath>
        <ns1:detailedAssetPath>/Root:#ID#1:#TYPE#VMContainer/MWS2:#ID#8:#TYPE#VMContainer/MWS2_CDCR2:#ID#9:#TYPE#VMProject</ns1:detailedAssetPath>
        <ns1:applicationType>application/com.servicemesh.agility.api.Blueprint+xml</ns1:applicationType>
        <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
        <ns1:removable>true</ns1:removable>
        <ns1:domain>
            <ns1:name>domain1</ns1:name>
            <ns1:href>domain/1</ns1:href>
            <ns1:id>1</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Domain+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:domain>
        <ns1:creator>
            <ns1:name>dridley</ns1:name>
            <ns1:href>user/8</ns1:href>
            <ns1:id>8</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.User+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:creator>
        <ns1:created>2015-02-19T20:03:17-06:00</ns1:created>
        <ns1:lockType>0</ns1:lockType>
        <ns1:lastModified>2015-05-21T08:42:28-05:00</ns1:lastModified>
        <ns1:parent>
            <ns1:name>MWS2_CDCR2</ns1:name>
            <ns1:href>project/9</ns1:href>
            <ns1:id>9</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Project+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:parent>
        <ns1:version>-1</ns1:version>
        <ns1:latest>false</ns1:latest>
        <ns1:publisher>
            <ns1:name>dridley</ns1:name>
            <ns1:href>user/8</ns1:href>
            <ns1:id>8</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.User+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:publisher>
        <ns1:versionStatus>inprogress</ns1:versionStatus>
        <ns1:checkoutAllowed>false</ns1:checkoutAllowed>
        <ns1:headAllowed>false</ns1:headAllowed>
        <ns1:path>/Root/MWS2/MWS2_CDCR2</ns1:path>
        <ns1:dirty>false</ns1:dirty>
        <ns1:layout>1.0676923076923077,0,0</ns1:layout>
        <ns1:resourceAffinity>None</ns1:resourceAffinity>
        <ns1:mandatoryAffinity>false</ns1:mandatoryAffinity>
        <ns1:antiAffinity>false</ns1:antiAffinity>
        <ns1:anyOrderItem xsi:type="ns1:Workload">
            <ns1:name>ConfigMgr2012 - Primary</ns1:name>
            <ns1:description></ns1:description>
            <ns1:uuid>3677fa74-94cc-4473-a650-7a70ff4f1165</ns1:uuid>
            <ns1:assetType>
                <ns1:name>designworkload</ns1:name>
                <ns1:href>assettype/8</ns1:href>
                <ns1:id>8</ns1:id>
                <ns1:rel>up</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.AssetType+xml</ns1:type>
                <ns1:position>0</ns1:position>
            </ns1:assetType>
            <ns1:top>false</ns1:top>
            <ns1:assetPath>/Root/MWS2/MWS2_CDCR2</ns1:assetPath>
            <ns1:detailedAssetPath>/Root:#ID#1:#TYPE#VMContainer/MWS2:#ID#8:#TYPE#VMContainer/MWS2_CDCR2:#ID#9:#TYPE#VMProject</ns1:detailedAssetPath>
            <ns1:applicationType>application/com.servicemesh.agility.api.Workload+xml</ns1:applicationType>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:domain>
                <ns1:name>domain1</ns1:name>
                <ns1:href>domain/1</ns1:href>
                <ns1:id>1</ns1:id>
                <ns1:rel>up</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Domain+xml</ns1:type>
                <ns1:position>0</ns1:position>
            </ns1:domain>
            <ns1:creator>
                <ns1:name>dridley</ns1:name>
                <ns1:href>user/8</ns1:href>
                <ns1:id>8</ns1:id>
                <ns1:rel>up</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.User+xml</ns1:type>
                <ns1:position>0</ns1:position>
            </ns1:creator>
            <ns1:created>2015-02-23T21:23:18-06:00</ns1:created>
            <ns1:lockType>0</ns1:lockType>
            <ns1:lastModified>2015-05-21T08:42:28-05:00</ns1:lastModified>
            <ns1:parent>
                <ns1:name>MWS2_CDCR2</ns1:name>
                <ns1:href>project/9</ns1:href>
                <ns1:id>9</ns1:id>
                <ns1:rel>up</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Project+xml</ns1:type>
                <ns1:position>0</ns1:position>
            </ns1:parent>
            <ns1:anyOrderPosition>0</ns1:anyOrderPosition>
            <ns1:variable>
                <ns1:id>17992</ns1:id>
                <ns1:name>COMPONENTID</ns1:name>
                <ns1:encrypted>false</ns1:encrypted>
                <ns1:overridable>true</ns1:overridable>
                <ns1:propertyType>
                    <ns1:name>string-any</ns1:name>
                    <ns1:href>/propertytype/4</ns1:href>
                    <ns1:id>4</ns1:id>
                    <ns1:rel>up</ns1:rel>
                    <ns1:type>application/com.servicemesh.agility.api.PropertyType+xml</ns1:type>
                    <ns1:position>0</ns1:position>
                </ns1:propertyType>
                <ns1:stringValue>SCC</ns1:stringValue>
                <ns1:floatValue>0.00</ns1:floatValue>
                <ns1:intValue>0</ns1:intValue>
                <ns1:booleanValue>false</ns1:booleanValue>
            </ns1:variable>
            <ns1:path>/Root/MWS2/MWS2_CDCR2</ns1:path>
            <ns1:dirty>false</ns1:dirty>
            <ns1:layout>220,80,300,325,false</ns1:layout>
            <ns1:logicalId>f06cd7e7-817f-40a8-8eae-003e29bc09e4</ns1:logicalId>
            <ns1:numInstances>1</ns1:numInstances>
            <ns1:hostnamePrefix></ns1:hostnamePrefix>
            <ns1:packages xsi:type="ns1:VersionedItemLink">
                <ns1:name>MWS2R2 - AD Rename and Add to Domain</ns1:name>
                <ns1:href>package/67</ns1:href>
                <ns1:id>72</ns1:id>
                <ns1:rel>down</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Package+xml</ns1:type>
                <ns1:position>0</ns1:position>
                <ns1:slot>4f2a9e8d-2a66-41b9-adfc-f19e59a3f24b</ns1:slot>
                <ns1:version>0</ns1:version>
                <ns1:latest>false</ns1:latest>
                <ns1:slotId>185</ns1:slotId>
                <ns1:versionStatus>active</ns1:versionStatus>
                <ns1:lockType>0</ns1:lockType>
            </ns1:packages>
            <ns1:packages xsi:type="ns1:VersionedItemLink">
                <ns1:name>MWS2R2 - ConfigMgr2012 - Primary Build</ns1:name>
                <ns1:href>package/44</ns1:href>
                <ns1:id>44</ns1:id>
                <ns1:rel>down</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Package+xml</ns1:type>
                <ns1:position>1</ns1:position>
                <ns1:version>-1</ns1:version>
                <ns1:latest>false</ns1:latest>
                <ns1:versionStatus>inprogress</ns1:versionStatus>
                <ns1:lockType>0</ns1:lockType>
            </ns1:packages>
            <ns1:resources>
                <ns1:name>Min GB RAM</ns1:name>
                <ns1:uuid>7593d5f6-a61e-4763-832d-0fc7e7abf401</ns1:uuid>
                <ns1:top>false</ns1:top>
                <ns1:assetPath></ns1:assetPath>
                <ns1:detailedAssetPath></ns1:detailedAssetPath>
                <ns1:applicationType>application/com.servicemesh.agility.api.Resource+xml</ns1:applicationType>
                <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
                <ns1:removable>true</ns1:removable>
                <ns1:resourceType>Memory</ns1:resourceType>
                <ns1:quantity>4.0</ns1:quantity>
            </ns1:resources>
            <ns1:resources>
                <ns1:name>Min CPU</ns1:name>
                <ns1:uuid>1ccdf2c3-55da-4887-bdd7-2e4a9ab1c7a8</ns1:uuid>
                <ns1:top>false</ns1:top>
                <ns1:assetPath></ns1:assetPath>
                <ns1:detailedAssetPath></ns1:detailedAssetPath>
                <ns1:applicationType>application/com.servicemesh.agility.api.Resource+xml</ns1:applicationType>
                <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
                <ns1:removable>true</ns1:removable>
                <ns1:resourceType>Processor</ns1:resourceType>
                <ns1:quantity>2.0</ns1:quantity>
            </ns1:resources>
            <ns1:volumes>
                <ns1:name>F</ns1:name>
                <ns1:description>CM2012</ns1:description>
                <ns1:uuid>5c5f8a93-3c9d-4dbe-a924-7c5bba93fe4e</ns1:uuid>
                <ns1:assetType>
                    <ns1:name>volume</ns1:name>
                    <ns1:href>assettype/10</ns1:href>
                    <ns1:id>10</ns1:id>
                    <ns1:rel>up</ns1:rel>
                    <ns1:type>application/com.servicemesh.agility.api.AssetType+xml</ns1:type>
                    <ns1:position>0</ns1:position>
                </ns1:assetType>
                <ns1:assetProperties>
                    <ns1:id>19172</ns1:id>
                    <ns1:name>thinProvision</ns1:name>
                    <ns1:description>Determines if disks are provisioned thin or thick</ns1:description>
                    <ns1:encrypted>false</ns1:encrypted>
                    <ns1:overridable>true</ns1:overridable>
                    <ns1:propertyType>
                        <ns1:name>boolean</ns1:name>
                        <ns1:href>/propertytype/9</ns1:href>
                        <ns1:id>9</ns1:id>
                        <ns1:rel>up</ns1:rel>
                        <ns1:type>application/com.servicemesh.agility.api.PropertyType+xml</ns1:type>
                        <ns1:position>0</ns1:position>
                    </ns1:propertyType>
                    <ns1:propertyDefinition xsi:type="ns1:Link">
                        <ns1:name>thinProvision</ns1:name>
                        <ns1:href>/propertydefinition/5</ns1:href>
                        <ns1:id>5</ns1:id>
                        <ns1:rel>up</ns1:rel>
                        <ns1:type>application/com.servicemesh.agility.api.PropertyDefinition+xml</ns1:type>
                        <ns1:position>0</ns1:position>
                    </ns1:propertyDefinition>
                    <ns1:booleanValue>false</ns1:booleanValue>
                </ns1:assetProperties>
                <ns1:assetProperties>
                    <ns1:id>19173</ns1:id>
                    <ns1:name>detachable</ns1:name>
                    <ns1:description>Determines if the disk can be detached</ns1:description>
                    <ns1:encrypted>false</ns1:encrypted>
                    <ns1:overridable>true</ns1:overridable>
                    <ns1:propertyType>
                        <ns1:name>boolean</ns1:name>
                        <ns1:href>/propertytype/9</ns1:href>
                        <ns1:id>9</ns1:id>
                        <ns1:rel>up</ns1:rel>
                        <ns1:type>application/com.servicemesh.agility.api.PropertyType+xml</ns1:type>
                        <ns1:position>0</ns1:position>
                    </ns1:propertyType>
                    <ns1:propertyDefinition xsi:type="ns1:Link">
                        <ns1:name>detachable</ns1:name>
                        <ns1:href>/propertydefinition/6</ns1:href>
                        <ns1:id>6</ns1:id>
                        <ns1:rel>up</ns1:rel>
                        <ns1:type>application/com.servicemesh.agility.api.PropertyDefinition+xml</ns1:type>
                        <ns1:position>0</ns1:position>
                    </ns1:propertyDefinition>
                    <ns1:booleanValue>true</ns1:booleanValue>
                </ns1:assetProperties>
                <ns1:top>false</ns1:top>
                <ns1:assetPath>/Root/MWS2/MWS2_CDCR2</ns1:assetPath>
                <ns1:detailedAssetPath>/Root:#ID#1:#TYPE#VMContainer/MWS2:#ID#8:#TYPE#VMContainer/MWS2_CDCR2:#ID#9:#TYPE#VMProject</ns1:detailedAssetPath>
                <ns1:applicationType>application/com.servicemesh.agility.api.Volume+xml</ns1:applicationType>
                <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
                <ns1:removable>true</ns1:removable>
                <ns1:fileSystem>ntfs</ns1:fileSystem>
                <ns1:volumeSize>35</ns1:volumeSize>
                <ns1:diskSize>35</ns1:diskSize>
                <ns1:numDisks>1</ns1:numDisks>
                <ns1:encrypted>false</ns1:encrypted>
            </ns1:volumes>
            <ns1:baseStack xsi:type="ns1:VersionedItemLink">
                <ns1:name>CSC SOE 6.1.1 Agility</ns1:name>
                <ns1:href>stack/49</ns1:href>
                <ns1:id>74</ns1:id>
                <ns1:rel>down</ns1:rel>
                <ns1:type>application/com.servicemesh.agility.api.Stack+xml</ns1:type>
                <ns1:position>0</ns1:position>
                <ns1:slot>3414f543-8310-47f1-ae2f-bc0ee84645ee</ns1:slot>
                <ns1:version>0</ns1:version>
                <ns1:latest>false</ns1:latest>
                <ns1:slotId>151</ns1:slotId>
                <ns1:versionStatus>active</ns1:versionStatus>
                <ns1:lockType>0</ns1:lockType>
            </ns1:baseStack>
            <ns1:operatingSystem>Windows|2012R2</ns1:operatingSystem>
            <ns1:releaseDisks>false</ns1:releaseDisks>
        </ns1:anyOrderItem>
        <ns1:deep>true</ns1:deep>
        <ns1:topology>
            <ns1:name>_DELETE1</ns1:name>
            <ns1:href>topology/244</ns1:href>
            <ns1:id>244</ns1:id>
            <ns1:rel>down</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Topology+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:topology>
        <ns1:topology>
            <ns1:name>MWS2R2 - ConfigMgr2012_Primary (Class A)</ns1:name>
            <ns1:href>topology/331</ns1:href>
            <ns1:id>331</ns1:id>
            <ns1:rel>down</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Topology+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:topology>
    </ns1:Asset>
</ns1:Envelope>
