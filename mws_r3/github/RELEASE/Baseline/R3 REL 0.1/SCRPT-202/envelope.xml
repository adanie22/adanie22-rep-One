<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<ns1:Envelope xmlns:ns1="http://servicemesh.com/agility/api" xmlns:ns2="http://servicemesh.com/core/messaging" ns1:version="3.0" ns1:productVersion="9.2.4">
    <ns1:Asset xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="ns1:Script">
        <ns1:name>MWS2R2 - Configure Windows Cluster</ns1:name>
        <ns1:id>202</ns1:id>
        <ns1:description>Configure a 2 node Windows Cluster</ns1:description>
        <ns1:uuid>e204f776-7ac9-4010-a567-f14953860bf7</ns1:uuid>
        <ns1:assetType>
            <ns1:name>script</ns1:name>
            <ns1:href>assettype/2</ns1:href>
            <ns1:id>2</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.AssetType+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:assetType>
        <ns1:top>true</ns1:top>
        <ns1:assetPath>/Root/MWS2/MWS2_CDCR2</ns1:assetPath>
        <ns1:detailedAssetPath>/Root:#ID#1:#TYPE#VMContainer/MWS2:#ID#8:#TYPE#VMContainer/MWS2_CDCR2:#ID#9:#TYPE#VMProject</ns1:detailedAssetPath>
        <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
        <ns1:removable>true</ns1:removable>
        <ns1:domain>
            <ns1:name>domain1</ns1:name>
            <ns1:href>domain/1</ns1:href>
            <ns1:id>1</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Domain+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:domain>
        <ns1:creator>
            <ns1:name>skoklevski</ns1:name>
            <ns1:href>user/11</ns1:href>
            <ns1:id>11</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.User+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:creator>
        <ns1:created>2015-02-26T02:33:39-06:00</ns1:created>
        <ns1:lockType>0</ns1:lockType>
        <ns1:lastModified>2015-03-23T22:23:07-05:00</ns1:lastModified>
        <ns1:parent>
            <ns1:name>MWS2_CDCR2</ns1:name>
            <ns1:href>project/9</ns1:href>
            <ns1:id>9</ns1:id>
            <ns1:rel>up</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.Project+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:parent>
        <ns1:version>-1</ns1:version>
        <ns1:latest>false</ns1:latest>
        <ns1:versionStatus>inprogress</ns1:versionStatus>
        <ns1:checkoutAllowed>false</ns1:checkoutAllowed>
        <ns1:headAllowed>false</ns1:headAllowed>
        <ns1:operatingSystem>Windows</ns1:operatingSystem>
        <ns1:enableExtensions>false</ns1:enableExtensions>
        <ns1:body>try
{
    $scriptPath = $env:USERPROFILE
    . .\LoggingV2.ps1 $true $scriptPath &quot;ExecuteWindowsCluster.ps1&quot;
    . .\ExecuteWindowsCluster.ps1

    exit 0
}
catch
{
    $ex = $_.Exception | format-list | Out-String
    log &quot;ERROR: Exception occurred `nException Message: $ex&quot;

    exit 1
}      </ns1:body>
        <ns1:type>Guest</ns1:type>
        <ns1:language>
            <ns1:name>powershell</ns1:name>
            <ns1:href>scriptlanguage/5</ns1:href>
            <ns1:id>5</ns1:id>
            <ns1:rel>down</ns1:rel>
            <ns1:type>application/com.servicemesh.agility.api.ScriptLanguage+xml</ns1:type>
            <ns1:position>0</ns1:position>
        </ns1:language>
        <ns1:runAsAdmin>false</ns1:runAsAdmin>
        <ns1:timeout>3600</ns1:timeout>
        <ns1:retries>0</ns1:retries>
        <ns1:delay>0</ns1:delay>
        <ns1:errorAction>Continue</ns1:errorAction>
        <ns1:rebootRequired>false</ns1:rebootRequired>
        <ns1:variable>
            <ns1:name>SHAREDWINDOWSCLUSTERXMLFILENAME</ns1:name>
            <ns1:id>283</ns1:id>
            <ns1:description>Windows cluster xml file name</ns1:description>
            <ns1:uuid>9168b444-035a-4514-9daa-33e813e6a852</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath></ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:displayName>SHAREDWINDOWSCLUSTERXMLFILENAME</ns1:displayName>
            <ns1:readable>true</ns1:readable>
            <ns1:writable>true</ns1:writable>
            <ns1:minRequired>0</ns1:minRequired>
            <ns1:maxAllowed>1</ns1:maxAllowed>
            <ns1:validator/>
            <ns1:propertyType>
                <ns1:name>SHAREDWINDOWSCLUSTERXMLFILENAME_localValue</ns1:name>
                <ns1:href>propertytype/52</ns1:href>
                <ns1:id>52</ns1:id>
                <ns1:type>application/com.servicemesh.agility.api.PropertyType+xml</ns1:type>
            </ns1:propertyType>
            <ns1:propertyTypeValue>
                <ns1:name>SHAREDWINDOWSCLUSTERXMLFILENAME_localValue</ns1:name>
                <ns1:id>52</ns1:id>
                <ns1:uuid>ce2faa34-ee52-4af8-8d97-fae22bee89bd</ns1:uuid>
                <ns1:assetType>
                    <ns1:name>propertytype</ns1:name>
                    <ns1:href>assettype/48</ns1:href>
                    <ns1:id>48</ns1:id>
                    <ns1:rel>up</ns1:rel>
                    <ns1:type>application/com.servicemesh.agility.api.AssetType+xml</ns1:type>
                    <ns1:position>0</ns1:position>
                </ns1:assetType>
                <ns1:top>false</ns1:top>
                <ns1:assetPath></ns1:assetPath>
                <ns1:detailedAssetPath></ns1:detailedAssetPath>
                <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
                <ns1:removable>true</ns1:removable>
                <ns1:displayName>SHAREDWINDOWSCLUSTERXMLFILENAME</ns1:displayName>
                <ns1:type>string</ns1:type>
                <ns1:open>true</ns1:open>
                <ns1:valueConstraint>list</ns1:valueConstraint>
                <ns1:rootValue>
                    <ns1:name>Install\Cluster\WindowsClusterSharedDB.xml</ns1:name>
                    <ns1:id>819</ns1:id>
                    <ns1:uuid>53a9e033-7053-4a70-a6dc-40299aed599f</ns1:uuid>
                    <ns1:top>false</ns1:top>
                    <ns1:assetPath></ns1:assetPath>
                    <ns1:detailedAssetPath></ns1:detailedAssetPath>
                    <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
                    <ns1:removable>true</ns1:removable>
                    <ns1:displayName>Install\Cluster\WindowsClusterSharedDB.xml</ns1:displayName>
                    <ns1:value>Install\Cluster\WindowsClusterSharedDB.xml</ns1:value>
                </ns1:rootValue>
                <ns1:rootValue>
                    <ns1:name>Install\Cluster\WindowsClusterShptDB.xml</ns1:name>
                    <ns1:id>820</ns1:id>
                    <ns1:uuid>3cebeb5f-1b83-4438-a985-0cecd1fe7f58</ns1:uuid>
                    <ns1:top>false</ns1:top>
                    <ns1:assetPath></ns1:assetPath>
                    <ns1:detailedAssetPath></ns1:detailedAssetPath>
                    <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
                    <ns1:removable>true</ns1:removable>
                    <ns1:displayName>Install\Cluster\WindowsClusterShptDB.xml</ns1:displayName>
                    <ns1:value>Install\Cluster\WindowsClusterShptDB.xml</ns1:value>
                </ns1:rootValue>
                <ns1:rootValue>
                    <ns1:name>Install\Cluster\WindowsClusterLyncDB.xml</ns1:name>
                    <ns1:id>821</ns1:id>
                    <ns1:uuid>f92dc3c2-685f-401e-98b3-bc596ee4253d</ns1:uuid>
                    <ns1:top>false</ns1:top>
                    <ns1:assetPath></ns1:assetPath>
                    <ns1:detailedAssetPath></ns1:detailedAssetPath>
                    <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
                    <ns1:removable>true</ns1:removable>
                    <ns1:displayName>Install\Cluster\WindowsClusterLyncDB.xml</ns1:displayName>
                    <ns1:value>Install\Cluster\WindowsClusterLyncDB.xml</ns1:value>
                </ns1:rootValue>
                <ns1:owned>true</ns1:owned>
            </ns1:propertyTypeValue>
            <ns1:assetPropertyLinkId>f9b87ec6-8fdf-4561-b20e-e6413fe094d1</ns1:assetPropertyLinkId>
        </ns1:variable>
        <ns1:variable>
            <ns1:name>MWSREGISTRYXMLFILENAME</ns1:name>
            <ns1:id>293</ns1:id>
            <ns1:description>XML file for MWS registry</ns1:description>
            <ns1:uuid>36ee710b-1fd7-433d-8c74-b48290a40bd1</ns1:uuid>
            <ns1:top>false</ns1:top>
            <ns1:assetPath></ns1:assetPath>
            <ns1:detailedAssetPath></ns1:detailedAssetPath>
            <ns1:lifecycleVersion>-1</ns1:lifecycleVersion>
            <ns1:removable>true</ns1:removable>
            <ns1:displayName>MWSREGISTRYXMLFILENAME</ns1:displayName>
            <ns1:readable>true</ns1:readable>
            <ns1:writable>true</ns1:writable>
            <ns1:minRequired>0</ns1:minRequired>
            <ns1:maxAllowed>1</ns1:maxAllowed>
            <ns1:validator/>
            <ns1:defaultValue>
                <ns1:id>6775</ns1:id>
                <ns1:name></ns1:name>
                <ns1:encrypted>false</ns1:encrypted>
                <ns1:overridable>true</ns1:overridable>
                <ns1:stringValue>Install\MWSRegistry.xml</ns1:stringValue>
            </ns1:defaultValue>
            <ns1:propertyType>
                <ns1:name>string-any</ns1:name>
                <ns1:href>propertytype/4</ns1:href>
                <ns1:id>4</ns1:id>
                <ns1:type>application/com.servicemesh.agility.api.PropertyType+xml</ns1:type>
            </ns1:propertyType>
            <ns1:assetPropertyLinkId>f5bf84cf-374c-4c51-946f-2acc5f93238b</ns1:assetPropertyLinkId>
        </ns1:variable>
        <ns1:runOnProvisionOnly>false</ns1:runOnProvisionOnly>
    </ns1:Asset>
</ns1:Envelope>
